<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Building a Fully Automated WFH Employee Health Reporting System with Slack" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Enhancing work efficiency by playing with Slack Workflow combined with Google Sheet with App Script" /><meta property="og:description" content="Enhancing work efficiency by playing with Slack Workflow combined with Google Sheet with App Script" /><link rel="canonical" href="https://en.zhgchg.li/posts/d61062833c1a/" /><meta property="og:url" content="https://en.zhgchg.li/posts/d61062833c1a/" /><meta property="og:site_name" content="ZhgChgLi" /><meta property="og:image" content="https://en.zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-14T00:58:21+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://en.zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.jpeg" /><meta property="twitter:title" content="Building a Fully Automated WFH Employee Health Reporting System with Slack" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@ZhgChgLi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi"},"dateModified":"2024-04-14T00:43:33+08:00","datePublished":"2021-06-14T00:58:21+08:00","description":"Enhancing work efficiency by playing with Slack Workflow combined with Google Sheet with App Script","headline":"Building a Fully Automated WFH Employee Health Reporting System with Slack","image":"https://en.zhgchg.li/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://en.zhgchg.li/posts/d61062833c1a/"},"url":"https://en.zhgchg.li/posts/d61062833c1a/"}</script><title>Building a Fully Automated WFH Employee Health Reporting System with Slack | ZhgChgLi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi"><meta name="application-name" content="ZhgChgLi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">ZhgChgLi</a></div><div class="site-subtitle fst-italic">Live a life you will remember.</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/real/" class="nav-link"> <i class="fa-fw fa fa-camera-retro"></i> <span>REAL LIFE</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Building a Fully Automated WFH Employee Health Reporting System with Slack</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Building a Fully Automated WFH Employee Health Reporting System with Slack</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1623603501" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 14, 2021 </em> </span> <span> Updated <em class="" data-ts="1713026613" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </em> </span><div class="mt-3 mb-3"> <a href="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.jpeg" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.jpeg" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4378 words" > <em>24 min</em> read</span></div></div></div><div class="post-content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><h3 id="building-a-fully-automated-wfh-employee-health-reporting-system-with-slack"><span class="me-2">Building a Fully Automated WFH Employee Health Reporting System with Slack</span><a href="#building-a-fully-automated-wfh-employee-health-reporting-system-with-slack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Enhancing work efficiency by playing with Slack Workflow combined with Google Sheet with App Script</p><p><a href="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*KTyHirY-qlH1kNTT4a_XjQ.jpeg" alt="Photo by [Stephen Phillips — Hostreviews.co.uk](https://unsplash.com/@hostreviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" class="lazyload" data-proofer-ignore></a></p><p>Photo by <a href="https://unsplash.com/@hostreviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Stephen Phillips — Hostreviews.co.uk</a></p><h3 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In response to full remote work, the company cares about the health of all members. Every day, employees need to report their health status, which is recorded and managed by People Operations.</p><h4 id="our-pre-optimization-flow"><span class="me-2">Our Pre-Optimization Flow</span><a href="#our-pre-optimization-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d61062833c1a/1*brnD44gjwyWEyK14dQYfxQ.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*brnD44gjwyWEyK14dQYfxQ.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>[Automation] Slack Channel sends a reminder message about the health form at 10 AM every day (the only automated part before optimization)<li>Employees click the link to open the Google Form and fill out health questions<li>Data is stored back in Google Sheet response records<li>[Manual] People Operations compare the list near the end of the day to filter out employees who forgot to fill it out<li>[Manual] Send reminder messages in the Slack Channel &amp; tag those who forgot to fill it out one by one</ol><blockquote><p><em>The above is our company’s health reporting tracking process. Each company may have different processes based on their scale and operation methods. This article uses it as an optimization example to learn Slack Workflow usage and basic App Script writing. Actual implementation should be case by case.</em></p></blockquote><h4 id="issues"><span class="me-2">Issues</span><a href="#issues" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Need to jump out of Slack context to use a browser to open the Google Form webpage to fill it out, which is especially inconvenient on mobile<li>Google Form can only automatically include email information, not the name of the person filling it out or department information<li>Daily manual comparison and manual tagging are very time-consuming</ul><h4 id="solution"><span class="me-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Having done quite a few small automation projects, this process has fixed data sources (employee list), simple conditions, and routine actions; it seemed very suitable for automation. Initially, it wasn’t done because I couldn’t find a good way to fill it out (actually, I couldn’t find an interesting research point); so it was left alone until I saw <a href="https://www.facebook.com/tzangms/posts/10157880898787657" target="_blank">this post by Hai Zongli</a> and realized that Slack Workflow not only can send scheduled messages but also has a form function:</p><p><a href="/assets/d61062833c1a/1*yKBpGlHEVMj4QbjGuB7aHQ.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*yKBpGlHEVMj4QbjGuB7aHQ.jpeg" alt="Image from: [Hai Zongli](https://www.facebook.com/tzangms/posts/10157880898787657){:target=&quot;_blank&quot;}" class="lazyload" data-proofer-ignore></a></p><p>Image from: <a href="https://www.facebook.com/tzangms/posts/10157880898787657" target="_blank">Hai Zongli</a></p><p>This got me excited!!</p><p>If Slack Workflow Form combined with message automation can solve all the pain points mentioned above, the principle is feasible! So I started implementing it.</p><h4 id="post-optimization-flow"><span class="me-2">Post-Optimization Flow</span><a href="#post-optimization-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, let’s look at the optimized process and results.</p><p><a href="/assets/d61062833c1a/1*jT5dAICg85lyCF0sJwk8bQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*jT5dAICg85lyCF0sJwk8bQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>[Automation] Slack Channel sends a daily reminder at 10 AM for everyone to fill out the health form.<li>Fill out health questions via Google Form or Slack Workflow Form.<li>Data is stored back in Google Sheet response records.<li>People Operations clicks the “Generate Unfilled List” button near the end of each workday.<li>[Automation] Use App Script to compare the employee list and the filled list to filter out the unfilled list.<li>[Automation] Click “Generate &amp; Send Message” to automatically send unfilled reminders &amp; automatically tag the individuals.<li>Done!</ol><h4 id="effectiveness"><span class="me-2">Effectiveness</span><a href="#effectiveness" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>(Personal Estimate)</p><ul><li>Each employee can save about 30 seconds daily on filling out the form.<li>People Operations can save about 20 ~ 30 minutes daily on handling this task.</ul><h3 id="operating-principle"><span class="me-2">Operating Principle</span><a href="#operating-principle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/d61062833c1a/1*xbZD2kkoYvWifQv8qyV_MQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*xbZD2kkoYvWifQv8qyV_MQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Manage the Sheet by writing App Script.</p><ol><li>Store all external input data in the Responses Sheet.<li>Write an App Script Function to distribute the data from Responses to each date’s Sheet according to the filling date. If not, create a new date Sheet. The Sheet name directly uses the date for easy identification and access.<li>Compare the current date’s Sheet with the employee list to generate the unfilled list Sheet data.<li>Read the unfilled list Sheet, compose the message, and send it to the specified Slack Channel.</ol><ul><li>Integrate with Slack APP API to automatically read the specified Channel and import the employee list.<li>Use Slack UID Tag <code class="language-plaintext highlighter-rouge">&lt;@UID&gt;</code> in the message content to tag the unfilled members.</ul><h4 id="identity-verification"><span class="me-2">Identity Verification</span><a href="#identity-verification" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The identity verification information connecting Google Form and Slack is Email, so please ensure that all company colleagues use the company Email to fill out the Google Form, and also fill in the company Email in the Slack personal information section.</p><h3 id="getting-started"><span class="me-2">Getting Started</span><a href="#getting-started" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After discussing the issues, optimization methods, and results, let’s move on to the implementation phase; let’s complete this automation case step by step together.</p><blockquote><p><em>The content is a bit lengthy, you can skip the sections you already understand, or directly create a copy from the completed result, and learn while modifying.</em></p></blockquote><p>Completed result form: <a href="https://forms.gle/aqGDCELpAiMFFoyDA" target="_blank">https://forms.gle/aqGDCELpAiMFFoyDA</a></p><p>Completed result Google Sheet:</p><p><a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=953539493" target="_blank" class="img-link shimmer" ><img data-src="https://lh7-us.googleusercontent.com/docs/AHkbwyKJ8y2kuh7i_WJkBhTMJbRr_5PIA16kICjaOEqa3NE_heuS-ZC1zxuavRe86YKxMWfYr8BMuyNiXuyy6DGqyISVdb-xzA7YwuqYwtCnPXLoOCxWaAU=w1200-h630-p" alt="" class="lazyload" data-proofer-ignore></a></p><h4 id="create-a-health-report-google-form--link-responses-to-google-sheet"><span class="me-2">Create a Health Report Google Form &amp; Link Responses to Google Sheet</span><a href="#create-a-health-report-google-form--link-responses-to-google-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Steps omitted, please Google if you have any questions. Here, we assume you have already created &amp; linked the health report form.</p><p><strong>Remember to check “Collect emails” on the form:</strong></p><p><a href="/assets/d61062833c1a/1*DKVg1oWvx0p2K_aYslK5ZQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*DKVg1oWvx0p2K_aYslK5ZQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Collect the email addresses of the respondents for future list comparison.</p><p><strong>How to link responses to Google Sheet?</strong></p><p><a href="/assets/d61062833c1a/1*Ie0WvV5zWNubaYq_hBbeNw.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*Ie0WvV5zWNubaYq_hBbeNw.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Switch to “Responses” at the top of the form and click the “Google Sheet Icon”.</p><p><strong>Change the linked Sheet name:</strong></p><p><a href="/assets/d61062833c1a/1*1A3m2zx1hI039TgWt3iU5A.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*1A3m2zx1hI039TgWt3iU5A.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>It is recommended to change the linked Sheet name from Form Responses 1 to Responses for easier use.</p><h4 id="create-a-slack-workflow-form-entry"><span class="me-2">Create a Slack Workflow Form Entry</span><a href="#create-a-slack-workflow-form-entry" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>After having the traditional Google Form entry, let’s add the Slack filling method.</p><p><a href="/assets/d61062833c1a/1*pkCpzbA6YLORazNfQS2ntA.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*pkCpzbA6YLORazNfQS2ntA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>In any Slack conversation window, find the “ <strong>below the input box</strong> “ “blue lightning ⚡️” and click on it.</p><p><a href="/assets/d61062833c1a/1*GpUOoQ2b_W7bMeeOlkosoA.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*GpUOoQ2b_W7bMeeOlkosoA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>In the menu under “Search shortcuts,” type “workflow” and select “Open Workflow Builder.”</p><p><a href="/assets/d61062833c1a/1*qgt-WjyrG_5OtaUjjt6r9Q.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*qgt-WjyrG_5OtaUjjt6r9Q.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Here, it will list the Workflows you have created or participated in. Click “Create” in the upper right corner to create a new Workflow.</p><p><a href="/assets/d61062833c1a/1*3qUC2S7sskImnDmXcnqMtg.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*3qUC2S7sskImnDmXcnqMtg.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Step one, enter the workflow name (for display in the Workflow Builder interface).</p><p><a href="/assets/d61062833c1a/1*q94eI0z8ljhBrjrPEGWa8w.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*q94eI0z8ljhBrjrPEGWa8w.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Workflow trigger method, select “Shortcut.”</p><p>Currently, there are 5 types of Slack workflow trigger points:</p><ul><li>Shortcut: Manually trigger the “blue lightning ⚡️” option, which will appear in the workflow menu. Click to start the workflow.<li>New channel member: When a new member joins the Target Channel… (EX: Welcome message)<li>Emoji reactions: When someone reacts to a message in the Target Channel with a specified emoji… (Maybe used for marking important messages as read by pressing XXX Emoji, to know who has read it?)<li>Scheduled date &amp; time: Schedule, at a specified time… (EX: Regular reminder messages)<li>Webhook: External Webhook trigger, advanced feature, can integrate internal workflows with third-party or self-hosted APIs.</ul><p>Here we choose “Shortcut” to create a manual trigger option.</p><p><a href="/assets/d61062833c1a/1*2NEcjJtkDwuQtF-DmnhgOg.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*2NEcjJtkDwuQtF-DmnhgOg.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Select which “Channel input box” this Workflow Shortcut should be added to and enter the “display name.”</p><blockquote><p>*A workflow shortcut can only be added to one channel.</p></blockquote><p><a href="/assets/d61062833c1a/1*Qq-nJr66qoGsXxhPEsUhWw.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*Qq-nJr66qoGsXxhPEsUhWw.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Shortcut created! Start creating workflow steps by clicking “Add Step.”</p><p><a href="/assets/d61062833c1a/1*aUerPfBPlOhkNGoeiougGA.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*aUerPfBPlOhkNGoeiougGA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Select the “Send a form” Step.</p><p><a href="/assets/d61062833c1a/1*DBPCTHNyKBuJIvEJCyexyg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*DBPCTHNyKBuJIvEJCyexyg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Title</strong>: Enter the form title.</p><p><strong>Add a question</strong>: Enter the first question’s title (you can label the question number in the title, e.g., 1., 2., 3…).</p><p><strong>Choose a question type</strong>:</p><ul><li>Short answer: Single-line input box.<li>Long answer: Multi-line input box.<li>Select from a list: Single-choice list.<li>Select a person: Choose a member from the same Workspace.<li>Select a channel or DM: Choose a member from the same Workspace, Group DM, or Channel.</ul><p><a href="/assets/d61062833c1a/1*pYIUTLaHVzHzFkAypN2_sw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*pYIUTLaHVzHzFkAypN2_sw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>For “Select from a list”:</p><ol><li>Add list item: Add an option.<li>Default selection: Choose the default option.<li>Make this required: Set this question as mandatory.</ol><p><a href="/assets/d61062833c1a/1*hb1l9_E8EmHgUqIvHuBqhw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*hb1l9_E8EmHgUqIvHuBqhw.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>Add Question: Add more questions.<li>The right “↓” and “⬆” can adjust the order, “✎” can expand for editing.<li>You can choose whether to send the form responses back to the Channel or to someone.</ol><p><a href="/assets/d61062833c1a/1*WsHqG3hxgivNfFXakMgVrQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*WsHqG3hxgivNfFXakMgVrQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>You can also choose to send the response to…:</p><ul><li>Person who clicked…: The person who clicked this form (same as the person filling it out).<li>Channel where workflow started: The Channel where this workflow was added.</ul><p><a href="/assets/d61062833c1a/1*xyrdyrx9ACpWTcjAtG-rTQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*xyrdyrx9ACpWTcjAtG-rTQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>After completing the form, click “Save” to save the step.</p><blockquote><p>*Here we uncheck the option to return the form content because we want to customize the message content in later steps.</p></blockquote><h4 id="integrate-slack-workflow-with-google-sheet"><span class="me-2">Integrate Slack workflow with Google Sheet</span><a href="#integrate-slack-workflow-with-google-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>If you haven’t added the Google Sheet App to Slack yet, you can <a href="https://slack.com/apps/A01AWGA48G6-google-sheets-for-workflow-builder" target="_blank">click here to install the APP</a>.</p><p><a href="/assets/d61062833c1a/1*da6ofGd-N0NsBs4LNDsllQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*da6ofGd-N0NsBs4LNDsllQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Following the previous step, click “Add Step” to add a new step. We choose the “Add a spreadsheet row” step from Google Sheets for Workflow Builder.</p><p><a href="/assets/d61062833c1a/1*6h_t9tPiam735pth-n0AOw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*6h_t9tPiam735pth-n0AOw.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>First, complete the authorization of your Google account by clicking “Connect account”.<li>Select a spreadsheet: Choose the target response Google Sheet, please select the Google Sheet created by the initial Google Form.<li>Sheet: Same as above.<li>Column name: The first column to fill in the value, here we select Question 1.</ol><p><a href="/assets/d61062833c1a/1*XPwkmIHRj8WKEM27kH3YQg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*XPwkmIHRj8WKEM27kH3YQg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click “Insert Variable” in the lower right corner and select “Response to Question 1…”. After inserting, you can add other columns by clicking “Add Column” in the lower left corner. Repeat this process for Question 2, Question 3, etc.</p><p><a href="/assets/d61062833c1a/1*wX7vJDvdneYrid0nECUIeg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*wX7vJDvdneYrid0nECUIeg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>For the email of the person filling out the form, you can select “Person who submitted form”.</p><p><a href="/assets/d61062833c1a/1*lQqJ0x7CeVK9u7g2R2VktQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*lQqJ0x7CeVK9u7g2R2VktQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click on the inserted variable and select “Email” to automatically fill in the email of the person who filled out the form.</p><ul><li>Mention (default): Tag the user, raw data is <code class="language-plaintext highlighter-rouge">&lt;@User ID&gt;</code><li>Name: User name<li>Email: User email</ul><p><a href="/assets/d61062833c1a/1*CYKDEtnuCKuSgSbAbunB4A.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*CYKDEtnuCKuSgSbAbunB4A.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>The Timestamp column is a bit tricky; we will supplement the setting method later. First, click “Save” to save, then go back to the top right corner of the page and click “Publish” to publish the Shortcut.</p><p><a href="/assets/d61062833c1a/1*k4rJidYWiVHgco3NYxmA3w.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*k4rJidYWiVHgco3NYxmA3w.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>After seeing the success message, you can go back to the Slack Channel and give it a try.</p><p><a href="/assets/d61062833c1a/1*XaQ75kM9BnKgcmAEl63fPg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*XaQ75kM9BnKgcmAEl63fPg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>At this point, clicking the lightning bolt will show the Workflow form you just created, which you can click to fill out and play with.</p><p><a href="/assets/d61062833c1a/1*W5v-uUjhVTik05TLDwM-uQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*W5v-uUjhVTik05TLDwM-uQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/d61062833c1a/1*63CaYi-HlPWRqxExL-GseQ.jpeg" class="popup img-link "><img data-src="/assets/d61062833c1a/1*63CaYi-HlPWRqxExL-GseQ.jpeg" alt="Left: Desktop Right: Mobile" class="lazyload" data-proofer-ignore></a></p><p>Left: Desktop / Right: Mobile</p><p>We can fill in the information and “Submit” to test if it works properly.</p><p><a href="/assets/d61062833c1a/1*xt7JeHRojIWgJCYrw8sKdw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*xt7JeHRojIWgJCYrw8sKdw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Success! But you can see that the Timestamp column is empty. Next, we will solve this problem.</p><h4 id="get-submission-time-from-slack-workflow"><span class="me-2">Get submission time from Slack workflow</span><a href="#get-submission-time-from-slack-workflow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Slack workflow does not have a global variable for the current timestamp, at least not yet. I only found a <a href="https://www.reddit.com/r/Slack/comments/l1gzhf/is_there_a_global_timestamp_variable_for_the/" target="_blank">wish post on Reddit</a>.</p><p>Initially, I whimsically entered <code class="language-plaintext highlighter-rouge">=NOW()</code> in the Column Value, but this way the time for all records is always the current time, which is completely wrong.</p><p>Thanks to the <a href="https://www.reddit.com/r/Slack/comments/l1gzhf/is_there_a_global_timestamp_variable_for_the/" target="_blank">Reddit post</a> and the tricky method provided by a great netizen, you can create a clean Timestamp Sheet with one row of data and a column <code class="language-plaintext highlighter-rouge">=NOW()</code>. First, use Update to force the column to be the latest, then use Select to get the current Timestamp.</p><p><a href="/assets/d61062833c1a/1*54QcEy5QPBt3VXuRSe7-Vw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*54QcEy5QPBt3VXuRSe7-Vw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>As shown in the structure above, click here <a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=1106265498" target="_blank">to view the example</a>.</p><ul><li>Row: Similar to the use of ID, set it directly to “1”. It will be used later when setting Select &amp; Update to inform the data row.<li>Timestamp: Set the value <code class="language-plaintext highlighter-rouge">=NOW()</code> to always display the current time.<li>Value: Used to trigger the update time of the Timestamp field. The content is arbitrary; here, the email of the person filling it in is inserted. As long as it can trigger the update, it is fine.</ul><blockquote><p><em>You can right-click on the Sheet and select “Hide Sheet” to hide this Sheet, as it is not intended for external use.</em></p></blockquote><p>Go back to Slack Workflow Builder to edit the workflow form you just created.</p><p>Click “Add Step” to add a new step:</p><p><a href="/assets/d61062833c1a/1*5lIcdnMQnmglNxaiY8fNUQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*5lIcdnMQnmglNxaiY8fNUQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Scroll down and select “Update a spreadsheet row”:</p><p><a href="/assets/d61062833c1a/1*kRBL8iptGYd2Gsy7Lv6gGA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*kRBL8iptGYd2Gsy7Lv6gGA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>“Select a spreadsheet” to choose the Sheet you just created, and “Sheet” to select the newly created “Timestamp” Sheet.</p><p>“Choose a column to search” and select “Row”. Define a cell value to find and enter “1”.</p><p><a href="/assets/d61062833c1a/1*H8pb9TKvazhqiKKSCKcwCQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*H8pb9TKvazhqiKKSCKcwCQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>“Update these columns” and “Column name” select “Value”. Click “Insert variable” -&gt; “Person who submitted” -&gt; select “Email”.</p><p>Click “Save” to complete! Now the timestamp update in the Sheet has been triggered. Next, we will read it out for use.</p><p><a href="/assets/d61062833c1a/1*avXovKvXz9mlHOq2NWaf3A.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*avXovKvXz9mlHOq2NWaf3A.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Go back to the editing page and click “Add Step” again to add a new step. This time, select “Select a spreadsheet row” to read the Timestamp.</p><p><a href="/assets/d61062833c1a/1*xEbDUkWd3utQ9QpllqSNHg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*xEbDUkWd3utQ9QpllqSNHg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>The search part is the same as “Update a spreadsheet row”. Click “Save”.</p><p><a href="/assets/d61062833c1a/1*VO3lfeTe1bxlL3xN3_wtwQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*VO3lfeTe1bxlL3xN3_wtwQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>After saving, go back to the step list page. You can drag and drop to change the order by moving the mouse over the steps.</p><p>Change the order to “Update a spreadsheet row” -&gt; “Select a spreadsheet” -&gt; “Add a spreadsheet row”.</p><p>This means: Update to trigger the timestamp update -&gt; Read the Timestamp -&gt; Use it when adding a new Row.</p><p>Click “Edit” to edit “Add a spreadsheet row”:</p><p><a href="/assets/d61062833c1a/1*8IH_AJZn0YHFk5obccmUYg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*8IH_AJZn0YHFk5obccmUYg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Scroll to the bottom and click “Add Column” in the lower left corner, then click “Insert a variable” in the lower right corner. Find the “Timestamp” variable in the “Select a spreadsheet” section and inject it.</p><p><a href="/assets/d61062833c1a/1*-4vk8fjRwkIVSY4Pu-C6VA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*-4vk8fjRwkIVSY4Pu-C6VA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click “Save” to save the step and return to the list page. Click “Publish Change” in the upper right corner to publish the changes.</p><p>Now, test the workflow shortcut again to see if the timestamp is written correctly.</p><p><a href="/assets/d61062833c1a/1*GyJ-55XxVEcZ6Cb1Q_H-WQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*GyJ-55XxVEcZ6Cb1Q_H-WQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Success!</p><h4 id="adding-a-submission-receipt-to-the-slack-workflow-form"><span class="me-2">Adding a submission receipt to the Slack workflow form</span><a href="#adding-a-submission-receipt-to-the-slack-workflow-form" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Similar to the submission receipt in Google Form, the Slack workflow form can also have one.</p><p>On the step editing page, we can add another step by clicking “Add Step”.</p><p><a href="/assets/d61062833c1a/1*16JMg7a_YzUHnnY6JtBrGw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*16JMg7a_YzUHnnY6JtBrGw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>This time, choose “Send a message”</p><p><a href="/assets/d61062833c1a/1*2CJuPDtuaTM9P5wIKwPspQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*2CJuPDtuaTM9P5wIKwPspQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Select “Send this message to” and choose “Person who submitted form”</p><p><a href="/assets/d61062833c1a/1*xKh_l7A-z31B6rQPboFTAA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*xKh_l7A-z31B6rQPboFTAA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Enter the message content in order, the question title, “Insert a variable” and select “Response to question XXX”. You can also insert “Timestamp” at the end. After saving the steps by clicking “Save”, click “Publish Changes”!</p><blockquote><p><em>Additionally, you can use “Send a message” to send the filled results to a specific Channel or DM.</em></p></blockquote><p><a href="/assets/d61062833c1a/1*gfTjTnaNmu-aPj0MuF6M_Q.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*gfTjTnaNmu-aPj0MuF6M_Q.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Success!</p><p>The setup of the Slack workflow form is roughly complete. You can freely combine and play with other features.</p><h3 id="google-sheet-with-app-script"><span class="me-2">Google Sheet with App Script!</span><a href="#google-sheet-with-app-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Next, we need to write an App Script to handle the filled data.</p><p><a href="/assets/d61062833c1a/1*04KBQF7e4lCjQm5XeHgVrA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*04KBQF7e4lCjQm5XeHgVrA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>First, select “Tools” -&gt; “Script editor” from the toolbar at the top of Google Sheet.</p><p><a href="/assets/d61062833c1a/1*wlg8D_1DHONj__M1dSBCxw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*wlg8D_1DHONj__M1dSBCxw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>You can click the top left corner to give the project a name.</p><p>Now we can start writing App Script! App Script is designed based on Javascript, so you can directly use Javascript code with Google Sheet’s library.</p><h4 id="distribute-the-data-of-responses-to-each-dates-sheet-according-to-the-filling-date"><span class="me-2">Distribute the data of Responses to each date’s Sheet according to the filling date</span><a href="#distribute-the-data-of-responses-to-each-dates-sheet-according-to-the-filling-date" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d61062833c1a/1*T5ExI_5aSf7QY5Zj_gJ3eg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*T5ExI_5aSf7QY5Zj_gJ3eg.png" alt="" class="lazyload" data-proofer-ignore></a></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">formatData</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">bufferSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Responses</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// Name of the Sheet storing responses</span>
  
  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">bufferSheet</span><span class="p">.</span><span class="nx">getDataRange</span><span class="p">().</span><span class="nx">getValues</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">fields</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="kd">var</span> <span class="nx">startDeleteIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">deleteLength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fields</span> <span class="o">=</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">sheetName</span> <span class="o">=</span> <span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="nx">toLocaleDateString</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// Convert Date to String, using US date format MM/DD/YYYY</span>
    <span class="kd">var</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">);</span> <span class="c1">// Get MM/DD/YYYY Sheet</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">sheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// If not exist, create new</span>
      <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">insertSheet</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">,</span> <span class="nx">bufferSheet</span><span class="p">.</span><span class="nx">getIndex</span><span class="p">());</span>
      <span class="nx">sheet</span><span class="p">.</span><span class="nx">appendRow</span><span class="p">(</span><span class="nx">fields</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">sheet</span><span class="p">.</span><span class="nx">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span> <span class="c1">// Add data to date Sheet</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">startDeleteIndex</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">startDeleteIndex</span> <span class="o">=</span> <span class="o">+</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">deleteLength</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">deleteLength</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">bufferSheet</span><span class="p">.</span><span class="nx">deleteRows</span><span class="p">(</span><span class="nx">startDeleteIndex</span><span class="p">,</span> <span class="nx">deleteLength</span><span class="p">);</span> <span class="c1">// After moving to the specified Sheet, remove data from Responses</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Paste the above code into the Code block and press “control” + “s” to save.</p><p>Next, we need to add a trigger button in the Sheet (<strong>can only be triggered manually, cannot be automatically triggered when data is written</strong>)</p><p><a href="/assets/d61062833c1a/1*XvugOM6drupik0wejbBnnA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*XvugOM6drupik0wejbBnnA.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>First, create a new Sheet and name it “Unfilled List”.<li>From the top toolbar, select “Insert” -&gt; “Drawing”.</ol><p><a href="/assets/d61062833c1a/1*BG70QTiE-8QNvlp31jDBMA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*BG70QTiE-8QNvlp31jDBMA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Use this interface to draw a button.</p><p><a href="/assets/d61062833c1a/1*BXXmUWkal7XjluhLcDaSIQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*BXXmUWkal7XjluhLcDaSIQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>After “Save and Close”, you can adjust and move the button; click the top right “…” and select “Assign script”.</p><p><a href="/assets/d61062833c1a/1*nx2qjDTUKeyorO0W9nOxKA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*nx2qjDTUKeyorO0W9nOxKA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Enter the function name “formatData”.</p><p>You can click the added button to test the function.</p><p><a href="/assets/d61062833c1a/1*eZpg-qejhpuPgUY7KDg00Q.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*eZpg-qejhpuPgUY7KDg00Q.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>If “Authorization Required” appears, click “Continue” to complete the verification.</p><p><a href="/assets/d61062833c1a/1*hIgRtqKEFs0tsXDxfNTaOg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*hIgRtqKEFs0tsXDxfNTaOg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>During the authentication process, “Google hasn’t verified this app” will appear. This is normal because the App Script we wrote is not verified by Google, but that’s okay since it’s for personal use.</p><p>Click “Advanced” at the bottom left -&gt; “Go to Health Report (Responses) (unsafe)”.</p><p><a href="/assets/d61062833c1a/1*QUkmTD1WlEzw7cqW97ll6Q.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*QUkmTD1WlEzw7cqW97ll6Q.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click “Allow”.</p><p><a href="/assets/d61062833c1a/1*0ZPVBwOR2bB4QPsTGX_yCA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*0ZPVBwOR2bB4QPsTGX_yCA.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>While the App Script is running and shows “Running Script”, please do not press again to avoid repeated execution.</em></p></blockquote><p><a href="/assets/d61062833c1a/1*i12l4Q5Y2N9bM9CzTo6XDg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*i12l4Q5Y2N9bM9CzTo6XDg.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>Only after the execution is successful can you run it again.</em></p></blockquote><p><a href="/assets/d61062833c1a/1*NbOfqAwIYSUAtJ32hSEOCQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*NbOfqAwIYSUAtJ32hSEOCQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Success! The data is grouped by date.</p><h4 id="compare-the-current-dates-sheet-with-the-employee-list-to-generate-data-for-the-unfilled-list-sheet"><span class="me-2">Compare the current date’s Sheet with the employee list to generate data for the Unfilled List Sheet</span><a href="#compare-the-current-dates-sheet-with-the-employee-list-to-generate-data-for-the-unfilled-list-sheet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Let’s add a piece of code:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="c1">// Compare the employee list Sheet &amp; today's filled Sheet to generate the unfilled list</span>
<span class="kd">function</span> <span class="nx">generateUnfilledList</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">listSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Employee List</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// Employee list Sheet name</span>
  <span class="kd">var</span> <span class="nx">unfilledListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Unfilled List</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// Unfilled list Sheet name</span>
  <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">todayName</span> <span class="o">=</span> <span class="nx">today</span><span class="p">.</span><span class="nx">toLocaleDateString</span><span class="p">(</span><span class="dl">"</span><span class="s2">en-US</span><span class="dl">"</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">todayListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="nx">todayName</span><span class="p">)</span> <span class="c1">// Get today's MM/DD/YYYY Sheet</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">todayListSheet</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getUi</span><span class="p">().</span><span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">Cannot find today</span><span class="se">\'</span><span class="s1">s Sheet </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">todayName</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> or please run "Organize Filled Data" first</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">todayEmails</span> <span class="o">=</span> <span class="nx">todayListSheet</span><span class="p">.</span><span class="nx">getDataRange</span><span class="p">().</span><span class="nx">getValues</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span> <span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="c1">// Get today's Sheet Email Address column data list (1 = Column B)</span>
  <span class="c1">// index start from 0, so 1 = Column B</span>
  <span class="c1">// output: Email Address,zhgchgli@gmail.com,alan@gamil.com,b@gmail.com...</span>
  <span class="nx">todayEmails</span><span class="p">.</span><span class="nx">shift</span><span class="p">()</span> <span class="c1">// Remove the first data, the first is the column name "Email Address" which is meaningless</span>
  <span class="c1">// output: zhgchgli@gmail.com,alan@gamil.com,b@gmail.com...</span>

  <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nx">clear</span><span class="p">()</span> <span class="c1">// Clear the unfilled list... prepare to refill data</span>
  <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nx">appendRow</span><span class="p">([</span><span class="nx">todayName</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> Unfilled List</span><span class="dl">"</span><span class="p">])</span> <span class="c1">// The first row shows the Sheet title</span>

  <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">listSheet</span><span class="p">.</span><span class="nx">getDataRange</span><span class="p">().</span><span class="nx">getValues</span><span class="p">();</span> <span class="c1">// Read the employee list Sheet</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// The first row is the header row, save it, so that the subsequent generated data can also add the first row header</span>
      <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nx">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">todayEmails</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span> <span class="p">{</span> <span class="c1">// If today's Sheet Email Address contains this employee's Email, it means it has been filled, continue to skip... (3 = Column D)</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nx">appendRow</span><span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span> <span class="c1">// Write a row of data to the unfilled list Sheet</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>After saving, follow the previous method to add code, then add a button and assign the script — “generateUnfilledList”.</p><p>Once completed, you can click to test:</p><p><a href="/assets/d61062833c1a/1*LCvfyjnvk3yCaoFnsvVhHg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*LCvfyjnvk3yCaoFnsvVhHg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Unfilled list generated successfully! If no content appears, please ensure:</p><ul><li>The employee list is filled in, or you can enter test data first.<li>Complete the “Organize Filled Data” action first.</ul><h4 id="read-the-unfilled-list-sheet-compile-the-message-and-send-it-to-the-specified-slack-channel"><span class="me-2">Read the Unfilled List Sheet, compile the message, and send it to the specified Slack Channel</span><a href="#read-the-unfilled-list-sheet-compile-the-message-and-send-it-to-the-specified-slack-channel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, we need to add the Incoming WebHooks App to the Slack Channel. We will use this medium to send messages.</p><p><a href="/assets/d61062833c1a/1*AgGLiLsyvenK-LRWI9rlKg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*AgGLiLsyvenK-LRWI9rlKg.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>Slack bottom left “Apps” -&gt; “Add apps”<li>Search “incoming” in the search box on the right<li>Click “Incoming WebHooks” -&gt; “Add”</ol><p><a href="/assets/d61062833c1a/1*DUcwdLTKt33Fa-jNlW8MkA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*DUcwdLTKt33Fa-jNlW8MkA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/d61062833c1a/1*v8Z-5vEM043F82TMiZk2lw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*v8Z-5vEM043F82TMiZk2lw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Select the Channel where you want to send the unfilled message.</p><p><a href="/assets/d61062833c1a/1*SRciom_ygU0JDKK9ATY1FQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*SRciom_ygU0JDKK9ATY1FQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Note down the “Webhook URL” at the top.</p><p><a href="/assets/d61062833c1a/1*kp1QDIEwzQtmfzUwZIDTSg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*kp1QDIEwzQtmfzUwZIDTSg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Scroll down to set the name and avatar of the Bot when sending messages; remember to click “Save Settings” after making changes.</p><p>Back to our Google Sheet Script</p><p>Add another piece of code:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">postSlack</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">ui</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getUi</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span>
     <span class="dl">'</span><span class="s1">Are you sure you want to send the message?</span><span class="dl">'</span><span class="p">,</span>
     <span class="dl">'</span><span class="s1">Send unfilled reminder message to Slack Channel</span><span class="dl">'</span><span class="p">,</span>
      <span class="nx">ui</span><span class="p">.</span><span class="nx">ButtonSet</span><span class="p">.</span><span class="nx">YES_NO</span><span class="p">);</span>
  <span class="c1">// To avoid accidental touches, ask for confirmation first</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">==</span> <span class="nx">ui</span><span class="p">.</span><span class="nx">Button</span><span class="p">.</span><span class="nx">YES</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">unfilledListSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Unfilled List</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// Unfilled List Sheet name</span>
    <span class="kd">var</span> <span class="nx">rows</span> <span class="o">=</span> <span class="nx">unfilledListSheet</span><span class="p">.</span><span class="nx">getDataRange</span><span class="p">().</span><span class="nx">getValues</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">persons</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">rows</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Skip the title and column header rows</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      
      <span class="kd">var</span> <span class="nx">person</span> <span class="o">=</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="dl">""</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="p">:</span> <span class="p">(</span><span class="dl">"</span><span class="s2">&lt;@</span><span class="dl">"</span><span class="o">+</span><span class="nx">rows</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="dl">"</span><span class="s2">&gt;</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// Mark the target, use slack uid if available, otherwise just display the nickname; 2 = Column B / 4 = Column E</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">person</span> <span class="o">==</span> <span class="dl">""</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Consider it as abnormal data if both are empty, ignore</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">persons</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">"</span><span class="s2">• </span><span class="dl">"</span><span class="o">+</span><span class="nx">person</span><span class="o">+</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// Store the target in the array</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">persons</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// If no target needs to be notified, everyone has filled in, cancel the message sending</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">preText</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">*[Health Report Announcement:loudspeaker:]*</span><span class="se">\n</span><span class="s2">The company cares about everyone's health, please remember to fill in the daily health status report, thank you:wink:</span><span class="se">\n\n</span><span class="s2">Today's unfilled health status report list</span><span class="se">\n\n</span><span class="dl">"</span> <span class="c1">// Message opening content...</span>
    <span class="kd">var</span> <span class="nx">postText</span> <span class="o">=</span> <span class="dl">"</span><span class="se">\n\n</span><span class="s2">Filling in the health status report allows the company to understand the health status of teammates, please make sure to fill it in every day&gt;&lt; Thank you everyone:woman-bowing::skin-tone-2:</span><span class="dl">"</span> <span class="c1">// Message closing content...</span>
    <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="nx">preText</span><span class="o">+</span><span class="nx">persons</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">)</span><span class="o">+</span><span class="nx">postText</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">attachments</span><span class="dl">"</span><span class="p">:</span> <span class="p">[{</span>
          <span class="dl">"</span><span class="s2">fallback</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">You can put the Google Form filling link here</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">actions</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">form_link</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Go to Health Status Report</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">button</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">style</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">primary</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">You can put the Google Form filling link here</span><span class="dl">"</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="dl">"</span><span class="s2">footer</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">:rocket:Tip: Click the </span><span class="se">\"</span><span class="s2">:zap:️lightning</span><span class="se">\"</span><span class="s2"> below the input box -&gt; </span><span class="se">\"</span><span class="s2">Shortcut Name</span><span class="se">\"</span><span class="s2"> to fill in directly.</span><span class="dl">"</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">Enter your slack incoming app Webhook URL here</span><span class="dl">'</span><span class="p">,{</span>
      <span class="na">method</span>             <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">contentType</span>        <span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">payload</span>            <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>After saving, follow the previous method to add code, then add a button and assign the script — “postSlack”.</p><p>Once completed, you can click to test:</p><p><a href="/assets/d61062833c1a/1*6vD5h6VQhYMRTpiT5ncfMQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*6vD5h6VQhYMRTpiT5ncfMQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/d61062833c1a/1*gwgJNkj3D4itq-xTGNctDw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*gwgJNkj3D4itq-xTGNctDw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Success!!! (The display @U123456 did not successfully tag the person because the ID was randomly typed by me)</p><p>At this point, the main functions are all completed!</p><blockquote><p><strong><em>Note</em></strong></p></blockquote><blockquote><p><em>Please note that the official recommendation is to use the new Slack APP API’s <a href="https://api.slack.com/methods/chat.postMessage" target="_blank">chat.postMessage</a> to send messages. The simpler method of Incoming Webhook will be deprecated. I did not use it here for convenience. You can adjust to the new method along with the next chapter “Import Employee List,” which will require the Slack App API.</em></p></blockquote><p><a href="/assets/d61062833c1a/1*QfgJL_Xb9JhgQnPGjU2CXg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*QfgJL_Xb9JhgQnPGjU2CXg.png" alt="" class="lazyload" data-proofer-ignore></a></p><h4 id="import-employee-list"><span class="me-2">Import Employee List</span><a href="#import-employee-list" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here we need to create a Slack APP.</p><ol><li><p>Go to <a href="https://api.slack.com/apps" target="_blank">https://api.slack.com/apps</a></p><li><p>Click “Create New App” in the upper right corner</p></ol><p><a href="/assets/d61062833c1a/1*38It1hdMGq-Lr6hlPIcsWQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*38It1hdMGq-Lr6hlPIcsWQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>Choose “ <strong>From scratch</strong> “</ol><p><a href="/assets/d61062833c1a/1*-6FB9vEkju_NszxRrb9LKA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*-6FB9vEkju_NszxRrb9LKA.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>Enter “ <strong>App Name</strong> “ and the Workspace you want to add</ol><p><a href="/assets/d61062833c1a/1*8OPXRdVPW5xHpe1blQDh6w.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*8OPXRdVPW5xHpe1blQDh6w.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>After successful creation, select “OAuth &amp; Permissions” settings page from the left menu</ol><p><a href="/assets/d61062833c1a/1*ougV73wzEMnCZ1C3rtx8xg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*ougV73wzEMnCZ1C3rtx8xg.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>Scroll down to the Scopes section</ol><p><a href="/assets/d61062833c1a/1*SprZwCDHq0gtdlN7O2sc-A.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*SprZwCDHq0gtdlN7O2sc-A.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Add the following items in “Add an OAuth Scope”:</p><ul><li><a href="https://api.slack.com/scopes/channels:read" target="_blank"><strong>channels:read</strong></a><li><a href="https://api.slack.com/scopes/users:read" target="_blank"><strong>users:read</strong></a><li><a href="https://api.slack.com/scopes/users:read.email" target="_blank"><strong>users:read.email</strong></a><li>If you want to use the APP to send messages, you can add <a href="https://api.slack.com/methods/chat.postMessage" target="_blank"><strong>chat.postMessage</strong></a></ul><ol><li>Go back to the top and click “Install to workspace” or “Reinstall to workspace”</ol><p><a href="/assets/d61062833c1a/1*iCmyMNlLwjhR9qsk-aTfxA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*iCmyMNlLwjhR9qsk-aTfxA.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>*If Scopes are added, you need to come back and reinstall.</em></p></blockquote><ol><li><p>After installation, get and copy the <code class="language-plaintext highlighter-rouge">Bot User OAuth Token</code></p><li><p>Use the web version of Slack to open the Channel where you want to import the list</p></ol><p><a href="/assets/d61062833c1a/1*JK0omZIhk1fmP1TOkE2dpg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*JK0omZIhk1fmP1TOkE2dpg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Get the URL from the browser:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://app.slack.com/client/TXXXX/CXXXX
</pre></table></code></div></div><p>Where <code class="language-plaintext highlighter-rouge">CXXXX</code> is the Channel ID of this Channel, note this information.</p><p>10.</p><p>Go back to our Google Sheet Script</p><p>Add the following code:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">loadEmployeeList</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bot User OAuth Token</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">channel</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Channel ID</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">limit</span><span class="dl">'</span><span class="p">:</span> <span class="mi">500</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">method</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">payload</span><span class="dl">'</span> <span class="p">:</span> <span class="nx">formData</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://slack.com/api/conversations.members</span><span class="dl">'</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">getContentText</span><span class="p">());</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">index</span> <span class="k">in</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">])</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">uid</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="dl">"</span><span class="s2">members</span><span class="dl">"</span><span class="p">][</span><span class="nx">index</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">formData</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bot User OAuth Token</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">:</span> <span class="nx">uid</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">method</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">payload</span><span class="dl">'</span> <span class="p">:</span> <span class="nx">formData</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://slack.com/api/users.info</span><span class="dl">'</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">getContentText</span><span class="p">());</span>

    <span class="kd">var</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">email</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">real_name</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">real_name_normalized</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">user</span><span class="p">[</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">][</span><span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="p">[</span><span class="nx">title</span><span class="p">,</span> <span class="nx">real_name</span><span class="p">,</span> <span class="nx">real_name</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">uid</span><span class="p">];</span> <span class="c1">// Fill in according to Column</span>

    <span class="kd">var</span> <span class="nx">listSheet</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSpreadsheet</span><span class="p">().</span><span class="nx">getSheetByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">Employee List</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// Employee list Sheet name</span>
    <span class="nx">listSheet</span><span class="p">.</span><span class="nx">appendRow</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>But this time we don’t need to add the button again, because the import is only needed the first time; so just save and run directly.</p><p><a href="/assets/d61062833c1a/1*rkw-79xbgd3Nn99fDnLWDQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*rkw-79xbgd3Nn99fDnLWDQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>First, press “control” + “s” to save, change the top dropdown menu to “loadEmployeeList”, and click “Run” to start importing the list into the Employee List Sheet.</p><h4 id="manually-add-new-employee-data"><span class="me-2">Manually Add New Employee Data</span><a href="#manually-add-new-employee-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>If new employees join later, you can directly add a row in the Employee List Sheet and fill in the information. The Slack UID can be directly queried on Slack:</p><p><a href="/assets/d61062833c1a/1*7EF6ghe032Pp832_61Ui0w.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*7EF6ghe032Pp832_61Ui0w.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click on the person whose UID you want to view, and click “View full profile”</p><p><a href="/assets/d61062833c1a/1*uKOp7Xe7AQ4ODKR2t8iDMw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*uKOp7Xe7AQ4ODKR2t8iDMw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click “More” and select “Copy member ID” to get the UID. <code class="language-plaintext highlighter-rouge">UXXXXX</code></p><h3 id="done"><span class="me-2">DONE!</span><a href="#done" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>All the above steps are completed, and you can start automating the tracking of employees’ health status.</p><p>The completed file can be copied and modified from the following Google Sheet:</p><p><a href="https://docs.google.com/spreadsheets/d/1PTk7G7r4P1sGk46sYjomUbfRO9ouPRF0wbmc84ZXA4c/edit?resourcekey#gid=922128927" target="_blank" class="img-link shimmer" ><img data-src="https://lh7-us.googleusercontent.com/docs/AHkbwyKJ8y2kuh7i_WJkBhTMJbRr_5PIA16kICjaOEqa3NE_heuS-ZC1zxuavRe86YKxMWfYr8BMuyNiXuyy6DGqyISVdb-xzA7YwuqYwtCnPXLoOCxWaAU=w1200-h630-p" alt="" class="lazyload" data-proofer-ignore></a></p><h3 id="supplement"><span class="me-2">Supplement</span><a href="#supplement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>If you want to use Scheduled date &amp; time to send form messages regularly, note that in this case, the form can only be filled out once, so it is not suitable for use here… (at least in the current version), so Scheduled reminder messages can still only use plain text + Google Form link.</ul><p><a href="/assets/d61062833c1a/1*iECjTdwjrRgMswu9MQOMFA.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*iECjTdwjrRgMswu9MQOMFA.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Currently, there is no way to link to Shortcut to open the Form<li>Google Sheet App Script to prevent duplicate execution:</ul><p>If you want to prevent accidental re-execution during execution, you can add at the beginning of the function:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="p">(</span><span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">)</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getUi</span><span class="p">().</span><span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">Busy... Please try again later</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p>Add at the end of the function execution:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">FUNCTIONNAME</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">true</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p>Replace FUNCTIONNAME with the target function name.</p><p>Use a global variable to control execution.</p><h3 id="applications-related-to-ios-development"><span class="me-2">Applications Related to iOS Development</span><a href="#applications-related-to-ios-development" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Can be used to connect CI/CD, using GUI to package the original ugly command operations, such as using Slack Bitrise APP, combining Slack Workflow form to trigger Build commands:</p><p><a href="/assets/d61062833c1a/1*A6Yc9RKCHLEnCLEe591sTw.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*A6Yc9RKCHLEnCLEe591sTw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/d61062833c1a/1*cPJ4JR5wVTZOSmuz635Nyg.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*cPJ4JR5wVTZOSmuz635Nyg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>After submission, it will send a command to the private channel with the Bitrise APP, EX:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bitrise workflow:app_store|branch:develop|ENV[version]:4.32.0
</pre></table></code></div></div><p><a href="/assets/d61062833c1a/1*hxyMW4y03udmyW0QXEuAFQ.png" class="popup img-link "><img data-src="/assets/d61062833c1a/1*hxyMW4y03udmyW0QXEuAFQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>This will trigger Bitrise to execute the CI/CD Flow.</p><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="../70a1409b149a/">Using Python + Google Cloud Platform + Line Bot to Automate Routine Tasks</a><li><a href="../d414bdbdb8c9/">Using Google Apps Script to Forward Gmail to Slack</a><li><a href="../e77b80cc6f89/">Building a More Real-time and Convenient Crash Tracking Tool with Crashlytics + Big Query</a><li><a href="../793cb8f89b72/">Automatically Querying App Crash-Free Users Rate with Crashlytics + Google Analytics</a></ul><p>If you have any questions or feedback, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><p>If you have any automation-related optimization needs, you are also welcome to <a href="https://www.zhgchg.li/contact" target="_blank">commission me</a>. Thank you.</p><p>===</p><p><a href="https://zhgchg.li/posts/d61062833c1a/" target="_blank">本文中文版本</a></p><p>===</p><p>This article was first published in Traditional Chinese on Medium ➡️ <a href="https://medium.com/p/d61062833c1a" target="_blank"><strong>View Here</strong></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script></div><hr/> <a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer!&emoji=🍺&slug=zhgchgli&button_colour=FFDD00&font_colour=000000&font_family=Bree&outline_colour=000000&coffee_colour=ffffff" class="lazyload" data-proofer-ignore></a> <br/> <a href="https://medium.com/@zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="/assets/images/followmymedium.png" class="lazyload" data-proofer-ignore></a> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3184248473087645" data-ad-slot="7555148040"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/zrealm/'>ZRealm</a>, <a href='/categories/dev/'>Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a> <a href="/tags/google-sheets/" class="post-tag no-text-decoration" >google-sheets</a> <a href="/tags/app-script/" class="post-tag no-text-decoration" >app-script</a> <a href="/tags/slack/" class="post-tag no-text-decoration" >slack</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Building%20a%20Fully%20Automated%20WFH%20Employee%20Health%20Reporting%20System%20with%20Slack%20-%20ZhgChgLi&url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fd61062833c1a%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Building%20a%20Fully%20Automated%20WFH%20Employee%20Health%20Reporting%20System%20with%20Slack%20-%20ZhgChgLi&u=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fd61062833c1a%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fd61062833c1a%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/d9a95d4224ea/">Medium Custom Domain Feature Returns</a><li class="text-truncate lh-lg"> <a href="/posts/483af5d93297/">Custom Domain Tutorial for Github Pages</a><li class="text-truncate lh-lg"> <a href="/posts/9e43897d99fc/">Behavior Change in Merging NSAttributedString Attributes Range in iOS ≥ 18</a><li class="text-truncate lh-lg"> <a href="/posts/b08ef940c196/">iOS Deferred Deep Link Implementation (Swift)</a><li class="text-truncate lh-lg"> <a href="/posts/12c5026da33d/">What's New with Universal Links</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/309d0302877b/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1724083008" data-df="ll" > Aug 19, 2024 </em><h4 class="pt-0 my-2" data-toc-skip>iOS Shortcut Automation Scenarios - Automatically Forwarding Text Messages and Creating Reminder Tasks</h4><div class="text-muted small"><p> iOS Shortcut Automation Scenarios - Automatically Forwarding Text Messages and Creating Reminder Tasks iOS uses Shortcuts to easily automate forwarding specific text messages to Line and automatic...</p></div></div></a></div><div class="col"> <a href="/posts/33f6aabb744f/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1620222679" data-df="ll" > May 5, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>ZReviewsBot — Slack App Review Notification Bot</h4><div class="text-muted small"><p> ZReviewsBot — Slack App Review Notification Bot Free and open-source iOS &amp;amp; Android APP latest review tracking Slack Bot TL;DR [2022/08/10] Update: Now redesigned using the new App Store Conn...</p></div></div></a></div><div class="col"> <a href="/posts/d414bdbdb8c9/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1628338789" data-df="ll" > Aug 7, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>Using Google Apps Script to Forward Gmail Emails to Slack</h4><div class="text-muted small"><p> Using Google Apps Script to Forward Gmail Emails to Slack Use Gmail Filter + Google Apps Script to automatically forward customized content to Slack Channel when receiving emails Photo by Lukas...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/33f6aabb744f/" class="btn btn-outline-primary" prompt="Older" ><p>ZReviewsBot — Slack App Review Notification Bot</p></a> <a href="/posts/ba5773a7bfea/" class="btn btn-outline-primary" prompt="Newer" ><p>Visitor Pattern in iOS (Swift)</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> <br/> <a href="https://zhgchg.li" target="_blank">中文版網站</a><br/> Powered by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</p><p>© 2024 <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-JSGN97L56L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-JSGN97L56L'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
