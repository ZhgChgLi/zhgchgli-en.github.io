<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your Fingertips" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Demonstrating the use of Raspberry Pi as a HomeBridge host to connect all Mi Home appliances to HomeKit" /><meta property="og:description" content="Demonstrating the use of Raspberry Pi as a HomeBridge host to connect all Mi Home appliances to HomeKit" /><link rel="canonical" href="https://en.zhgchg.li/posts/99db2a1fbfe5/" /><meta property="og:url" content="https://en.zhgchg.li/posts/99db2a1fbfe5/" /><meta property="og:site_name" content="ZhgChgLi" /><meta property="og:image" content="https://en.zhgchg.li/assets/99db2a1fbfe5/1*qZeTn0r2u_MKJXubV17XvQ.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-04-20T22:37:49+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://en.zhgchg.li/assets/99db2a1fbfe5/1*qZeTn0r2u_MKJXubV17XvQ.jpeg" /><meta property="twitter:title" content="Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your Fingertips" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@ZhgChgLi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi"},"dateModified":"2024-04-13T16:16:28+08:00","datePublished":"2020-04-20T22:37:49+08:00","description":"Demonstrating the use of Raspberry Pi as a HomeBridge host to connect all Mi Home appliances to HomeKit","headline":"Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your Fingertips","image":"https://en.zhgchg.li/assets/99db2a1fbfe5/1*qZeTn0r2u_MKJXubV17XvQ.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://en.zhgchg.li/posts/99db2a1fbfe5/"},"url":"https://en.zhgchg.li/posts/99db2a1fbfe5/"}</script><title>Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your Fingertips | ZhgChgLi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi"><meta name="application-name" content="ZhgChgLi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">ZhgChgLi</a></div><div class="site-subtitle fst-italic">Live a life you will remember.</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/real/" class="nav-link"> <i class="fa-fw fa fa-camera-retro"></i> <span>REAL LIFE</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your Fingertips</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your Fingertips</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1587393469" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 20, 2020 </em> </span> <span> Updated <em class="" data-ts="1712996188" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </em> </span><div class="mt-3 mb-3"> <a href="/assets/99db2a1fbfe5/1*qZeTn0r2u_MKJXubV17XvQ.jpeg" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/99db2a1fbfe5/1*qZeTn0r2u_MKJXubV17XvQ.jpeg" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="4879 words" > <em>27 min</em> read</span></div></div></div><div class="post-content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><h3 id="creating-a-comfortable-wfh-smart-home-environment-control-appliances-at-your-fingertips"><span class="me-2">Creating a Comfortable WFH Smart Home Environment, Control Appliances at Your Fingertips</span><a href="#creating-a-comfortable-wfh-smart-home-environment-control-appliances-at-your-fingertips" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Demonstrating the use of Raspberry Pi as a HomeBridge host to connect all Mi Home appliances to HomeKit</p><p><a href="/assets/99db2a1fbfe5/1*qZeTn0r2u_MKJXubV17XvQ.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*qZeTn0r2u_MKJXubV17XvQ.jpeg" alt="photo by [picjumbo.com](https://www.pexels.com/zh-tw/@picjumbo-com-55570?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels){:target=&quot;_blank&quot;}" class="lazyload" data-proofer-ignore></a></p><p>photo by <a href="https://www.pexels.com/zh-tw/@picjumbo-com-55570?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" target="_blank">picjumbo.com</a></p><h3 id="about"><span class="me-2">About</span><a href="#about" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Due to the pandemic, the time spent at home has increased; especially when working from home, it’s best if all home appliances can be smartly controlled via an app. This way, you don’t have to keep getting up to turn on the lights or the rice cooker, which wastes a lot of time.</p><p>Previously, I wrote an article titled “<a href="../c3150cdc85dd/"><strong>First Experience with Smart Home — Apple HomeKit &amp; Xiaomi Mi Home</strong></a>”, where I initially tried using HomeBridge to connect Xiaomi appliances to HomeKit. Theoretically, it was feasible, but there wasn’t much practical application mentioned. Today’s article is a comprehensive advanced version of the previous one, including how to set up a Raspberry Pi as the host, with a step-by-step tutorial.</p><p>The motivation came from recently switching to an iPhone 11 Pro, which supports iOS ≥ 13 shortcuts with NFC automation. This means the phone can execute corresponding shortcuts when it detects an NFC tag. Although <strong>you can directly use an old EasyCard as an NFC tag</strong>, it takes up too much space and there aren’t that many cards. I asked around Guanghua Digital Plaza but couldn’t find any NFC tag stickers, so I finally found them on Shopee for $50 each and bought 5 to play with. The seller was kind enough to help me differentiate them by color.</p><p><a href="/assets/99db2a1fbfe5/1*6ftbgAxlvmdv-35of98ohA.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*6ftbgAxlvmdv-35of98ohA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p><em>*NFC automation is model-specific, only iPhone XS/XS max/XR/11/11pro/11pro max support this feature. Previously, with an iPhone 8, there was no NFC option.</em></p><p>After playing around a bit, I found a problem: when executing shortcuts for the Mi Home app, you must enable the “Show When Run” option (otherwise it won’t actually execute). <strong>When detecting the tag, you need to unlock the iPhone and the shortcut will open, making it impossible to execute directly in the background</strong>. Additionally, if the shortcut is for native Apple services (e.g., HomeKit appliances), it can execute directly in the background without unlocking. Moreover, HomeKit’s response speed and stability are much better than Mi Home’s.</p><p>This makes a big difference in user experience, so I delved deeper into connecting all Mi Home smart home products to HomeKit. For those that support HomeKit, just bind them directly; for those that don’t, follow this tutorial to bind them as well!</p><h3 id="my-mi-home-smart-home-items"><span class="me-2">My Mi Home Smart Home Items</span><a href="#my-mi-home-smart-home-items" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Mi Home Smart Camera Pan-Tilt Version 1080P<li>Mi Home DC Inverter Fan<li>Mi Home LED Smart Desk Lamp<li>Xiaomi Air Purifier 3<li>Mi Home Desk Lamp Pro (supports HomeKit natively)<li>Mi Home LED Smart Bulb Color Version * 2 (supports HomeKit natively)</ol><h3 id="operating-principle"><span class="me-2">Operating Principle</span><a href="#operating-principle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/99db2a1fbfe5/1*7p0ehajJqdqb4-_w9uHt7g.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*7p0ehajJqdqb4-_w9uHt7g.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>I made a simple reference diagram. If the smart appliance supports HomeKit, connect it directly. <strong>For those that don’t support HomeKit, set up a “HomeBridge” service host (which needs to be always on) to bridge and connect them</strong>. In the same network environment (e.g., the same WiFi), the iPhone can freely control all HomeKit appliances. However, if you’re on an external network, such as <strong>4G mobile network, you need an Apple TV/HomePod or iPad as the home hub, always on standby at home</strong> to control HomeKit from outside. Without a home hub, the Home app will show “ <strong>No Response</strong> “ when opened from outside.</p><blockquote><p>*If it’s a Xiaomi device, it will be controlled via the Xiaomi server, which means <strong>there could be security issues as the data has to go through mainland China</strong>.</p></blockquote><h3 id="requirements"><span class="me-2">Requirements</span><a href="#requirements" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>So, there are two devices that need to be on standby all the time: one is an Apple TV/HomePod or iPad as the home hub; this part currently has no workaround, you have to obtain these devices somehow, if not, you can only use HomeKit at home <strong>.</strong></p><p>The other device can be any computer that can be on standby 24 hours (like your iMac/MacBook), an idle host (old iMac, Mac Mini), or a Raspberry Pi.</p><blockquote><p>*Windows series has not been tried, but it should work too!</p></blockquote><p>Alternatively, if you just want to play around, you can use your current computer (can be used together with <a href="../c3150cdc85dd/">the previous article</a>).</p><p>This article will demonstrate using a Raspberry Pi (Raspberry Pi 3B) and a MacBook Pro (MacOS 10.15.4), starting from setting up the Raspberry Pi environment from scratch; if you are not using a Raspberry Pi, you can skip directly to the HomeBridge integration with HomeKit part (this part is the same).</p><p><a href="/assets/99db2a1fbfe5/1*go-wGMdV1VVbJ3c00rh0_w.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*go-wGMdV1VVbJ3c00rh0_w.jpeg" alt="Raspberry Pi 3B (special thanks to [Lu Xun Huang](https://medium.com/u/b32ce1b681f8){:target=&quot;_blank&quot;} )" class="lazyload" data-proofer-ignore></a></p><p>Raspberry Pi 3B (special thanks to <a href="https://medium.com/u/b32ce1b681f8" target="_blank">Lu Xun Huang</a> )</p><p><strong>If you are using a Raspberry Pi, you will also need a micro SD card (not too big, I use 8G), a card reader, a network cable (for setup, can connect to WiFi later); and the software needed for the Raspberry Pi:</strong></p><ol><li><a href="https://downloads.raspberrypi.org/raspbian_latest" target="_blank">Raspberry Pi Desktop OS (for beginners, using the GUI version)</a><li><a href="https://www.balena.io/etcher/" target="_blank">Etcher burning software</a></ol><h3 id="raspberry-pi-environment-setup"><span class="me-2">Raspberry Pi Environment Setup</span><a href="#raspberry-pi-environment-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="burning-the-operating-system"><span class="me-2">Burning the Operating System</span><a href="#burning-the-operating-system" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>After downloading the two required software, first insert the memory card into the card reader and plug it into the computer; open the Etcher program (balenaEtcher).</p><p><a href="/assets/99db2a1fbfe5/1*3YcqdSf9z5RNqD6KJkd4Nw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*3YcqdSf9z5RNqD6KJkd4Nw.png" alt="First, select the Raspberry Pi OS you just downloaded &quot;xxxx.img&quot;, second, select your memory card device, then click &quot;Flash!&quot; to start burning!" class="lazyload" data-proofer-ignore></a></p><p>First, select the Raspberry Pi OS you just downloaded “xxxx.img”, second, select your memory card device, then click “Flash!” to start burning!</p><p><a href="/assets/99db2a1fbfe5/1*o9XE1WYrBpeKSE31Ob9gcQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*o9XE1WYrBpeKSE31Ob9gcQ.png" alt="At this point, it will prompt you to enter the **MacOS password**, enter it and click &quot;Ok&quot; to continue." class="lazyload" data-proofer-ignore></a></p><p>At this point, it will prompt you to enter the <strong>MacOS password</strong>, enter it and click “Ok” to continue.</p><p><a href="/assets/99db2a1fbfe5/1*Z9oOKg9KPMpj3TZfvOvYeA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*Z9oOKg9KPMpj3TZfvOvYeA.png" alt="Burning... please wait..." class="lazyload" data-proofer-ignore></a></p><p>Burning… please wait…</p><p><a href="/assets/99db2a1fbfe5/1*2G930lN4q4MVs4LCeE5y1w.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*2G930lN4q4MVs4LCeE5y1w.png" alt="Verifying... please wait..." class="lazyload" data-proofer-ignore></a></p><p>Verifying… please wait…</p><p><a href="/assets/99db2a1fbfe5/1*CEB4bAMTQshY3u7MEC3q5w.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*CEB4bAMTQshY3u7MEC3q5w.png" alt="Burn successful!" class="lazyload" data-proofer-ignore></a></p><p>Burn successful!</p><blockquote><p>*If a red Error appears, try formatting the memory card and burning it again.</p></blockquote><p>Reconnect the card reader to the computer, and create an empty “ssh” file in the memory card directory ( <a href="https://drive.google.com/file/d/1vSiMkRB1-5tO1hD4YnXxUcULTnCJBIFX/view?usp=sharing" target="_blank">or click here to download</a> ) with no content and no extension, just a “ssh” file; this allows us to connect to the Raspberry Pi using <strong>Terminal</strong>.</p><p><a href="/assets/99db2a1fbfe5/1*aGJHebPl5MMf4iy0Um9bjg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*aGJHebPl5MMf4iy0Um9bjg.png" alt="ssh" class="lazyload" data-proofer-ignore></a></p><p>ssh</p><h3 id="setting-up-the-raspberry-pi"><span class="me-2">Setting up the Raspberry Pi</span><a href="#setting-up-the-raspberry-pi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Eject the memory card, insert it into the Raspberry Pi, connect the network cable, and power it on; make sure the MacBook and Raspberry Pi are on the same network.</p><h4 id="check-the-ip-address-assigned-to-the-raspberry-pi"><span class="me-2"><strong>Check the IP address assigned to the Raspberry Pi</strong></span><a href="#check-the-ip-address-assigned-to-the-raspberry-pi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/99db2a1fbfe5/1*6HZ0Fqp6cgpn1F3_4UwM0Q.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*6HZ0Fqp6cgpn1F3_4UwM0Q.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>The IP address assigned to the Raspberry Pi is: <strong>192.168.0.110 (Please replace all IP addresses in this document with the one you found)</strong></p><blockquote><p><strong><em>It is recommended to set the Raspberry Pi to a static/reserved IP, otherwise the IP address may change after rebooting and reconnecting, requiring you to check it again.</em></strong></p></blockquote><h4 id="use-ssh-to-connect-to-the-raspberry-pi-for-operations"><span class="me-2">Use SSH to connect to the Raspberry Pi for operations</span><a href="#use-ssh-to-connect-to-the-raspberry-pi-for-operations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Open Terminal and enter:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh pi@your_raspberry_pi_IP_address
</pre></table></code></div></div><p>When prompted, enter <code class="language-plaintext highlighter-rouge">yes</code>, and for the password, enter the default password: <code class="language-plaintext highlighter-rouge">raspberry</code></p><p><a href="/assets/99db2a1fbfe5/1*okEJeW9xZN8XFfRYJyp4Xg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*okEJeW9xZN8XFfRYJyp4Xg.png" alt="**Connection successful!**" class="lazyload" data-proofer-ignore></a></p><p><strong>Connection successful!</strong></p><blockquote><p>*If you encounter an error message like WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED, open /Users/xxxx/.ssh/known_hosts with a text editor and clear its contents.</p></blockquote><h4 id="basic-tools-installation-and-setup-on-raspberry-pi"><span class="me-2">Basic tools installation and setup on Raspberry Pi</span><a href="#basic-tools-installation-and-setup-on-raspberry-pi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li><strong>Enter the following command to install the Vim editor:</strong></ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>vim
</pre></table></code></div></div><p><a href="/assets/99db2a1fbfe5/1*QfhJwWvicEGfk_8PFLy7pA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*QfhJwWvicEGfk_8PFLy7pA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>2. Resolve the following locale warnings:</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
    LANGUAGE = (unset),
    LC_ALL = (unset),
    LC_LANG = "zh_TW.UTF-8",
    LANG = "zh_TW.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
</pre></table></code></div></div><p><strong>Enter</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vi .bashrc
</pre></table></code></div></div><p>Press “Enter” to proceed</p><p>Press “<code class="language-plaintext highlighter-rouge">i</code>” to enter edit mode</p><p>Move to the bottom of the document and add a line “<code class="language-plaintext highlighter-rouge">export LC_ALL=C</code>”</p><p>Press “Esc” and enter “<code class="language-plaintext highlighter-rouge">:wq!</code>” to save and exit.</p><p>Then enter “<code class="language-plaintext highlighter-rouge">source .bashrc</code>” to update.</p><p><a href="/assets/99db2a1fbfe5/1*Z3E5QTXErDmmNVRd5QYo8g.gif" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*Z3E5QTXErDmmNVRd5QYo8g.gif" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>3. Install nvm to manage nodejs/npm:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-o-</span> https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh | bash
</pre></table></code></div></div><p><strong>4. Use nvm to install the latest version of <a href="https://nodejs.org/en/" target="_blank">nodejs</a>:</strong></p><p><code class="language-plaintext highlighter-rouge">nvm install 12.16.2</code></p><blockquote><p>*Here, we choose to install version “12.16.2”</p></blockquote><p><strong>5. Confirm the environment installation is complete:</strong></p><p><strong>Enter the following commands</strong></p><p><code class="language-plaintext highlighter-rouge">npm -v</code></p><p><strong>and</strong></p><p><code class="language-plaintext highlighter-rouge">node -v</code></p><p><strong>to confirm</strong></p><p><a href="/assets/99db2a1fbfe5/1*u3xgdplBB-7DyvSpAJU4dA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*u3xgdplBB-7DyvSpAJU4dA.png" alt="No error messages! " class="lazyload" data-proofer-ignore></a></p><p>No error messages!</p><p><strong>6. Create a nodejs link</strong></p><p><strong>Enter the following command</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>which node
</pre></table></code></div></div><p>Get the path information where nodejs is located</p><p><strong>Then enter</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo ln</span> <span class="nt">-fs</span> paste_the_path_you_found_with_which_node_here /usr/local/bin/node
</pre></table></code></div></div><p><strong>Create the link</strong></p><p><a href="/assets/99db2a1fbfe5/1*L5C-2SCUV-Cf4yCDwYy8eg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*L5C-2SCUV-Cf4yCDwYy8eg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Setup complete!</strong></p><h4 id="enable-raspberry-pi-vnc-remote-desktop-feature"><span class="me-2"><strong>Enable Raspberry Pi VNC remote desktop feature</strong></span><a href="#enable-raspberry-pi-vnc-remote-desktop-feature" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Although we have installed the GUI version, you can directly connect the Raspberry Pi to a keyboard and HDMI to use it as a regular computer. However, for convenience, we will use the remote desktop method to control the Raspberry Pi.</p><p><strong>Enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>raspi-config
</pre></table></code></div></div><p><a href="/assets/99db2a1fbfe5/1*_Hwvt6tkKhsNE9TDkOaYAA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*_Hwvt6tkKhsNE9TDkOaYAA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Enter the settings:</strong></p><p><a href="/assets/99db2a1fbfe5/1*_EMj-6phsY5PjrPjqeavDg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*_EMj-6phsY5PjrPjqeavDg.png" alt="Select the fifth option &quot; **Interfacing Options** &quot;" class="lazyload" data-proofer-ignore></a></p><p>Select the fifth option “ <strong>Interfacing Options</strong> “</p><p><a href="/assets/99db2a1fbfe5/1*CAHN3qczUpajbGGU9gaD9g.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*CAHN3qczUpajbGGU9gaD9g.png" alt="Select the third option &quot; **P3 VNC** &quot;" class="lazyload" data-proofer-ignore></a></p><p>Select the third option “ <strong>P3 VNC</strong> “</p><p><a href="/assets/99db2a1fbfe5/1*wq4S5b33MpAJUiqt9z1EMg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*wq4S5b33MpAJUiqt9z1EMg.png" alt="Use &quot; **←** &quot; to select &quot; **Yes** &quot; to enable" class="lazyload" data-proofer-ignore></a></p><p>Use “ <strong>←</strong> “ to select “ <strong>Yes</strong> “ to enable</p><p><a href="/assets/99db2a1fbfe5/1*sTZ8x9M-_5FRwdqy4mKvPw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*sTZ8x9M-_5FRwdqy4mKvPw.png" alt="**VNC remote desktop feature enabled successfully!**" class="lazyload" data-proofer-ignore></a></p><p><strong>VNC remote desktop feature enabled successfully!</strong></p><p><a href="/assets/99db2a1fbfe5/1*81Y7wZjbSS8Tf5Z_OHi3Rw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*81Y7wZjbSS8Tf5Z_OHi3Rw.png" alt="Use &quot; **→** &quot; to directly switch to &quot; **Finish** &quot; to exit the setup interface." class="lazyload" data-proofer-ignore></a></p><p>Use “ <strong>→</strong> “ to directly switch to “ <strong>Finish</strong> “ to exit the setup interface.</p><h4 id="add-vnc-remote-desktop-service-to-startup"><span class="me-2"><strong>Add VNC remote desktop service to startup</strong></span><a href="#add-vnc-remote-desktop-service-to-startup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We want the VNC remote desktop service to be automatically enabled when the Raspberry Pi boots up.</p><p><strong>Enter</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>vim /etc/init.d/vncserver
</pre></table></code></div></div><p>Press “Enter” to proceed</p><p>Press “ <code class="language-plaintext highlighter-rouge">i</code> “ to enter edit mode</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>
<span class="c">### BEGIN INIT INFO</span>
<span class="c"># Provides:          vncserver</span>
<span class="c"># Required-Start:    $local_fs</span>
<span class="c"># Required-Stop:     $local_fs</span>
<span class="c"># Default-Start:     2 3 4 5</span>
<span class="c"># Default-Stop:      0 1 6</span>
<span class="c"># Short-Description: Start/stop vncserver</span>
<span class="c">### END INIT INFO</span>

<span class="c"># More details see:</span>
<span class="c"># http://www.penguintutor.com/linux/vnc</span>

<span class="c">### Customize this entry</span>
<span class="c"># Set the USER variable to the name of the user to start vncserver under</span>
<span class="nb">export </span><span class="nv">USER</span><span class="o">=</span><span class="s1">'pi'</span>
<span class="c">### End customization required</span>

<span class="nb">eval cd</span> ~<span class="nv">$USER</span>

<span class="k">case</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="k">in
  </span>start<span class="p">)</span>
    su <span class="nv">$USER</span> <span class="nt">-c</span> <span class="s1">'/usr/bin/vncserver -depth 16 -geometry 1024x768 :1'</span>
    <span class="nb">echo</span> <span class="s2">"Starting VNC server for </span><span class="nv">$USER</span><span class="s2"> "</span>
    <span class="p">;;</span>
  stop<span class="p">)</span>
    su <span class="nv">$USER</span> <span class="nt">-c</span> <span class="s1">'/usr/bin/vncserver -kill :1'</span>
    <span class="nb">echo</span> <span class="s2">"vncserver stopped"</span>
    <span class="p">;;</span>
  <span class="k">*</span><span class="p">)</span>
    <span class="nb">echo</span> <span class="s2">"Usage: /etc/init.d/vncserver {start|stop}"</span>
    <span class="nb">exit </span>1
    <span class="p">;;</span>
<span class="k">esac</span>
<span class="nb">exit </span>0
</pre></table></code></div></div><p>“Command” + “C”, “Command” + “V” to copy and paste the above content, press “Esc” and enter “:wq!” to save and exit.</p><p><strong>Then enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo chmod </span>755 /etc/init.d/vncserver
</pre></table></code></div></div><p>Change the file permissions.</p><p><strong>Then enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>update-rc.d vncserver defaults
</pre></table></code></div></div><p>Add to startup items.</p><p><strong>Finally enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>reboot
</pre></table></code></div></div><p><strong>Restart the Raspberry Pi.</strong></p><blockquote><p>*After the restart is complete, reconnect using ssh as before.</p></blockquote><h4 id="connect-using-vnc-client"><span class="me-2"><strong>Connect using VNC Client:</strong></span><a href="#connect-using-vnc-client" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here we use the Chrome app “ <a href="https://chrome.google.com/webstore/detail/vnc%C2%AE-viewer-for-google-ch/iabmpiboiopbgfabjmgeedhcmjenhbla" target="_blank">VNC® Viewer for Google Chrome™</a> “. After installation and launch, enter <strong>Raspberry Pi IP address:1</strong>. Please note to add <strong>Port:1</strong> at the end!</p><blockquote><p>*I was unable to connect using Mac’s built-in VNC://, the reason is unknown.</p></blockquote><p><a href="/assets/99db2a1fbfe5/1*83cR8b2ajhPc1IwariNVBw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*83cR8b2ajhPc1IwariNVBw.png" alt="Click &quot; **Connect** &quot;." class="lazyload" data-proofer-ignore></a></p><p>Click “ <strong>Connect</strong> “.</p><p><a href="/assets/99db2a1fbfe5/1*B0esYM-GvrYUVXIwpq4vvQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*B0esYM-GvrYUVXIwpq4vvQ.png" alt="Click &quot; **OK** &quot;." class="lazyload" data-proofer-ignore></a></p><p>Click “ <strong>OK</strong> “.</p><p><a href="/assets/99db2a1fbfe5/1*jJ8cdRrc4bGHDxPvF7xXhw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*jJ8cdRrc4bGHDxPvF7xXhw.png" alt="**Enter login username and password** , same as SSH connection, username `pi` default password `raspberry`. " class="lazyload" data-proofer-ignore></a></p><p><strong>Enter login username and password</strong> , same as SSH connection, username <code class="language-plaintext highlighter-rouge">pi</code> default password <code class="language-plaintext highlighter-rouge">raspberry</code>.</p><p><a href="/assets/99db2a1fbfe5/1*vIUEmBrO-t_-6xy_kPNLNQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*vIUEmBrO-t_-6xy_kPNLNQ.png" alt="**Successfully connected!**" class="lazyload" data-proofer-ignore></a></p><p><strong>Successfully connected!</strong></p><h4 id="complete-raspberry-pi-initialization-settings"><span class="me-2"><strong>Complete Raspberry Pi initialization settings:</strong></span><a href="#complete-raspberry-pi-initialization-settings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The rest is graphical interface! Very easy!</p><p><a href="/assets/99db2a1fbfe5/1*w9qXfybKr4REKN8hrJJUBw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*w9qXfybKr4REKN8hrJJUBw.png" alt="Set language, region, time zone." class="lazyload" data-proofer-ignore></a></p><p>Set language, region, time zone.</p><p><a href="/assets/99db2a1fbfe5/1*xeb6Pr5FUwQGYHhzmid-6w.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*xeb6Pr5FUwQGYHhzmid-6w.png" alt="Change the default Raspberry Pi password, enter the password you want to set." class="lazyload" data-proofer-ignore></a></p><p>Change the default Raspberry Pi password, enter the password you want to set.</p><p><a href="/assets/99db2a1fbfe5/1*o-LCjlYXdW7hmxYjIE6Axw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*o-LCjlYXdW7hmxYjIE6Axw.png" alt="Directly click &quot; **Next** &quot;." class="lazyload" data-proofer-ignore></a></p><p>Directly click “ <strong>Next</strong> “.</p><p><a href="/assets/99db2a1fbfe5/1*NPZqliJZslnmvzzkW-Zj6g.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*NPZqliJZslnmvzzkW-Zj6g.png" alt="Set up WiFi connection, so you don't need to plug in the cable anymore." class="lazyload" data-proofer-ignore></a></p><p>Set up WiFi connection, so you don’t need to plug in the cable anymore.</p><blockquote><p>*But please note that the Raspberry Pi IP address may change, you need to check it again in the router</p></blockquote><p><a href="/assets/99db2a1fbfe5/1*lsnk0BDb_z1VKkXYxUi7fg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*lsnk0BDb_z1VKkXYxUi7fg.png" alt="Whether to update the current operating system, if not in a hurry, select &quot; **Next** &quot; to update!" class="lazyload" data-proofer-ignore></a></p><p>Whether to update the current operating system, if not in a hurry, select “ <strong>Next</strong> “ to update!</p><blockquote><p>*The update takes about 20~30 minutes (depending on your internet speed)</p></blockquote><p><a href="/assets/99db2a1fbfe5/1*Xgm6NMQNoom_Zee3QHWXZg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*Xgm6NMQNoom_Zee3QHWXZg.png" alt="After the update is complete, click &quot; **Restart** &quot; to restart." class="lazyload" data-proofer-ignore></a></p><p>After the update is complete, click “ <strong>Restart</strong> “ to restart.</p><p><strong>Raspberry Pi environment setup complete!</strong></p><h3 id="homebridge-installation"><span class="me-2">HomeBridge Installation</span><a href="#homebridge-installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now for the main event, installing and using HomeBridge.</p><p>Use Terminal to ssh into the Raspberry Pi or directly use the Terminal in the VNC remote desktop.</p><p><strong>Enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nt">-g</span> <span class="nb">install </span>homebridge <span class="nt">--unsafe-perm</span>
</pre></table></code></div></div><p>^( <strong>Do not add sudo</strong> )</p><p>Install <strong>HomeBridge</strong></p><p><a href="/assets/99db2a1fbfe5/1*feOCt_Gyy8DEW7qHA2bpQw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*feOCt_Gyy8DEW7qHA2bpQw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Installation complete!</strong></p><h4 id="createmodify-configuration-file-configjson"><span class="me-2">Create/Modify configuration file (config.json):</span><a href="#createmodify-configuration-file-configjson" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>For easier editing, use VNC remote desktop to connect to the Raspberry Pi</strong> (you can also use commands directly) <strong>:</strong></p><p>Click the top left to open “ <strong>File Manager</strong> “ -&gt; go to “ <strong>/home/pi/.homebridge</strong> “</p><p>If you don’t see the “config.json” file, right-click on the blank area “ <strong>New File</strong> “ -&gt; enter the file name “ <strong>config.json</strong> “</p><p>Right-click on “ <strong>config.json</strong> “ and open with “ <strong>Text Editor</strong> “</p><p><a href="/assets/99db2a1fbfe5/1*Zk_cWdHZ4Um5zCX4dr5IdQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*Zk_cWdHZ4Um5zCX4dr5IdQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Paste the following basic configuration content:</strong></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
   </span><span class="nl">"bridge"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Homebridge"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CC:22:3D:E3:CE:30"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">51826</span><span class="p">,</span><span class="w">
  </span><span class="nl">"pin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123-45-568"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><strong>No need to make special changes to the content, just copy it directly!</strong></p><blockquote><p><strong><em>Remember to save!</em></strong></p></blockquote><p><a href="/assets/99db2a1fbfe5/1*Jm3Ykku3Yll1aiuKWbR-EQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*Jm3Ykku3Yll1aiuKWbR-EQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Done!</strong></p><h4 id="bind-homebridge-to-homekit"><span class="me-2">Bind HomeBridge to Homekit</span><a href="#bind-homebridge-to-homekit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>Enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>homebridge start
</pre></table></code></div></div><p>^( <strong>Do not add sudo</strong> )</p><p><strong>Enable</strong></p><p><a href="/assets/99db2a1fbfe5/1*uMEuC33I-R6KlLxS-L6Grw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*uMEuC33I-R6KlLxS-L6Grw.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>If you encounter an Error: Service name is already in use on the network / port is occupied error, try deleting the service, using <code class="language-plaintext highlighter-rouge">homebridge restart</code> to restart, or rebooting.</em></p></blockquote><blockquote><p><em>If you encounter an error like was not registered by any plugin, it means you haven’t installed the corresponding homebridge plugin.</em></p></blockquote><blockquote><p><strong><em>If you change the configuration file (config.json) while starting, you need to modify it:</em></strong></p></blockquote><blockquote><p><code class="language-plaintext highlighter-rouge">sudo homebridge restart</code></p></blockquote><blockquote><p><strong><em>Restart HomeBridge</em></strong></p></blockquote><blockquote><p><em>Press “Control” + “C” to close and exit the HomeBridge service in Terminal.</em></p></blockquote><p>Take out your iPhone and open the “Home” app. In the upper right corner of “Home,” click “+”, select “Add Accessory,” and <strong>scan the QRCode that appears</strong>.</p><p><a href="/assets/99db2a1fbfe5/1*IFt2yQBfKfooraaAgCxGkA.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*IFt2yQBfKfooraaAgCxGkA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>At this point, you should see “ <strong>Accessory Not Found</strong> “. Don’t worry! Because we haven’t added any accessories to the HomeBridge bridge yet, it’s okay, let’s continue.</p><p><strong>You must have at least one accessory to scan and add!!!</strong> (Here, we use a camera as an example) <strong>:</strong> <strong>You must have at least one accessory to scan and add!!!</strong> (Here, we use a camera as an example) <strong>:</strong> <strong>You must have at least one accessory to scan and add!!!</strong> (Here, we use a camera as an example) <strong>:</strong></p><p><a href="/assets/99db2a1fbfe5/1*HC1CSkt1RpBXYEZ3aa8Eyw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*HC1CSkt1RpBXYEZ3aa8Eyw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/99db2a1fbfe5/1*Wi1np5MvjBkwJkInD49aRA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*Wi1np5MvjBkwJkInD49aRA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>The first time you scan and add, a warning window will appear. Just click “Force Add”!</p><blockquote><p><strong><em>After adding once, you don’t need to scan again for any new accessories; they will update automatically!</em></strong></p></blockquote><h4 id="add-homebridge-service-to-raspberry-pi-startup-items"><span class="me-2">Add HomeBridge service to Raspberry Pi startup items</span><a href="#add-homebridge-service-to-raspberry-pi-startup-items" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Like the VNC remote desktop service, we also want the HomeBridge service to be automatically enabled when the Raspberry Pi starts, otherwise, we have to manually log in and enable it every time it reboots.</p><p><strong>Enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>which homebridge
</pre></table></code></div></div><p><strong>Get homebridge path information</strong></p><p><a href="/assets/99db2a1fbfe5/1*L8-E7jZqv6TjO4zKaayAuA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*L8-E7jZqv6TjO4zKaayAuA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Note down this path.</strong></p><p><strong>Then enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>vim /etc/init.d/homebridge
</pre></table></code></div></div><p>Press “Enter” to enter</p><p>Press “<code class="language-plaintext highlighter-rouge">i</code>” to enter edit mode</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>
<span class="c">### BEGIN INIT INFO</span>
<span class="c"># Provides:</span>
<span class="c"># Required-Start:    $remote_fs $syslog</span>
<span class="c"># Required-Stop:     $remote_fs $syslog</span>
<span class="c"># Default-Start:     2 3 4 5</span>
<span class="c"># Default-Stop:      0 1 6</span>
<span class="c"># Short-Description: Start daemon at boot time</span>
<span class="c"># Description:       Enable service provided by daemon.</span>
<span class="c">### END INIT INFO</span>

<span class="nb">dir</span><span class="o">=</span><span class="s2">"/home/pi"</span>
<span class="nv">cmd</span><span class="o">=</span><span class="s2">"DEBUG=* paste the path you got from which homebridge here"</span>
<span class="nv">user</span><span class="o">=</span><span class="s2">"pi"</span>

<span class="nv">name</span><span class="o">=</span><span class="sb">`</span><span class="nb">basename</span> <span class="nv">$0</span><span class="sb">`</span>
<span class="nv">pid_file</span><span class="o">=</span><span class="s2">"/var/run/</span><span class="nv">$name</span><span class="s2">.pid"</span>
<span class="nv">stdout_log</span><span class="o">=</span><span class="s2">"/var/log/</span><span class="nv">$name</span><span class="s2">.log"</span>
<span class="nv">stderr_log</span><span class="o">=</span><span class="s2">"/var/log/</span><span class="nv">$name</span><span class="s2">.err"</span>

get_pid<span class="o">()</span> <span class="o">{</span>
<span class="nb">cat</span> <span class="s2">"</span><span class="nv">$pid_file</span><span class="s2">"</span>
<span class="o">}</span>

is_running<span class="o">()</span> <span class="o">{</span>
<span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$pid_file</span><span class="s2">"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> ps <span class="nt">-p</span> <span class="sb">`</span>get_pid<span class="sb">`</span> <span class="o">&gt;</span> /dev/null 2&gt;&amp;1
<span class="o">}</span>

<span class="k">case</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="k">in
</span>start<span class="p">)</span>
<span class="k">if </span>is_running<span class="p">;</span> <span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Already started"</span>
<span class="k">else
</span><span class="nb">echo</span> <span class="s2">"Starting </span><span class="nv">$name</span><span class="s2">"</span>
<span class="nb">cd</span> <span class="s2">"</span><span class="nv">$dir</span><span class="s2">"</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$user</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
</span><span class="nb">sudo</span> <span class="nv">$cmd</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$stdout_log</span><span class="s2">"</span> 2&gt;&gt; <span class="s2">"</span><span class="nv">$stderr_log</span><span class="s2">"</span> &amp;
<span class="k">else
</span><span class="nb">sudo</span> <span class="nt">-u</span> <span class="s2">"</span><span class="nv">$user</span><span class="s2">"</span> <span class="nv">$cmd</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$stdout_log</span><span class="s2">"</span> 2&gt;&gt; <span class="s2">"</span><span class="nv">$stderr_log</span><span class="s2">"</span> &amp;
<span class="k">fi
</span><span class="nb">echo</span> <span class="nv">$!</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$pid_file</span><span class="s2">"</span>
<span class="k">if</span> <span class="o">!</span> is_running<span class="p">;</span> <span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Unable to start, see </span><span class="nv">$stdout_log</span><span class="s2"> and </span><span class="nv">$stderr_log</span><span class="s2">"</span>
<span class="nb">exit </span>1
<span class="k">fi
fi</span>
<span class="p">;;</span>
stop<span class="p">)</span>
<span class="k">if </span>is_running<span class="p">;</span> <span class="k">then
</span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Stopping </span><span class="nv">$name</span><span class="s2">.."</span>
<span class="nb">kill</span> <span class="sb">`</span>get_pid<span class="sb">`</span>
<span class="k">for </span>i <span class="k">in </span>1 2 3 4 5 6 7 8 9 10
<span class="c"># for i in `seq 10`</span>
<span class="k">do
if</span> <span class="o">!</span> is_running<span class="p">;</span> <span class="k">then
</span><span class="nb">break
</span><span class="k">fi

</span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"."</span>
<span class="nb">sleep </span>1
<span class="k">done
</span><span class="nb">echo

</span><span class="k">if </span>is_running<span class="p">;</span> <span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Not stopped; may still be shutting down or shutdown may have failed"</span>
<span class="nb">exit </span>1
<span class="k">else
</span><span class="nb">echo</span> <span class="s2">"Stopped"</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$pid_file</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
</span><span class="nb">rm</span> <span class="s2">"</span><span class="nv">$pid_file</span><span class="s2">"</span>
<span class="k">fi
fi
else
</span><span class="nb">echo</span> <span class="s2">"Not running"</span>
<span class="k">fi</span>
<span class="p">;;</span>
restart<span class="p">)</span>
<span class="nv">$0</span> stop
<span class="k">if </span>is_running<span class="p">;</span> <span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Unable to stop, will not attempt to start"</span>
<span class="nb">exit </span>1
<span class="k">fi</span>
<span class="nv">$0</span> start
<span class="p">;;</span>
status<span class="p">)</span>
<span class="k">if </span>is_running<span class="p">;</span> <span class="k">then
</span><span class="nb">echo</span> <span class="s2">"Running"</span>
<span class="k">else
</span><span class="nb">echo</span> <span class="s2">"Stopped"</span>
<span class="nb">exit </span>1
<span class="k">fi</span>
<span class="p">;;</span>
<span class="k">*</span><span class="p">)</span>
<span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> {start|stop|restart|status}"</span>
<span class="nb">exit </span>1
<span class="p">;;</span>
<span class="k">esac</span>
<span class="nb">exit </span>0
</pre></table></code></div></div><p><strong>Replace:</strong></p><p><code class="language-plaintext highlighter-rouge">cmd=”DEBUG=* Paste which homebridge path”</code></p><p><strong>with the path information you found (without double quotes)</strong></p><p>Press “Command” + “C”, “Command” + “V” to copy and paste the above content, press “Esc” and enter “:wq!” to save and exit.</p><p><strong>Then enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo chmod </span>755 /etc/init.d/homebridge
</pre></table></code></div></div><p>Modify file permissions.</p><p><strong>Finally enter:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>update-rc.d homebridge defaults
</pre></table></code></div></div><p>Add to startup items.</p><p><strong>Done!</strong></p><blockquote><p>You can directly use <code class="language-plaintext highlighter-rouge">sudo /etc/init.d/homebridge start</code> to start the <code class="language-plaintext highlighter-rouge">homebridge</code> service.</p></blockquote><blockquote><p>You can also use: <code class="language-plaintext highlighter-rouge">tail -f /var/log/homebridge.err</code> to view startup error messages, <code class="language-plaintext highlighter-rouge">tail -f /var/log/homebridge.log</code> to view logs.</p></blockquote><p><a href="/assets/99db2a1fbfe5/1*P_3Zg1GDuUVKJyO-kknCLA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*P_3Zg1GDuUVKJyO-kknCLA.png" alt="" class="lazyload" data-proofer-ignore></a></p><h3 id="preparation-before-connecting-mi-home-smart-appliances"><span class="me-2">Preparation before connecting Mi Home smart appliances</span><a href="#preparation-before-connecting-mi-home-smart-appliances" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Once Homebridge is up and running, we can start adding all Mi Home appliances to Homebridge and connect them to HomeKit!</p><p><strong>First, we need to add all Mi Home smart appliances to the <a href="https://apps.apple.com/tw/app/%E7%B1%B3%E5%AE%B6-%E6%99%BA%E6%85%A7%E7%94%9F%E6%B4%BB%E6%96%B0%E9%AB%94%E9%A9%97/id957323480" target="_blank">Mi Home APP</a></strong> to obtain the information needed to connect to HomeBridge.</p><p><strong>After adding the smart appliances to the Mi Home APP:</strong></p><p>Connect your iPhone to your Mac, open Finder/iTunes, and select the connected phone.</p><p>Select “Back up to this computer”, “Do not check! Encrypt local backup”, and click “Back Up Now”.</p><p><a href="/assets/99db2a1fbfe5/1*nS68ECAURNSVbuJRYdhCvw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*nS68ECAURNSVbuJRYdhCvw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>After the backup is complete, <a href="http://www.imactools.com/iphonebackupviewer/download/mac" target="_blank">download</a> and install the backup viewer software: <a href="http://www.imactools.com/iphonebackupviewer/download/mac"><strong>iBackupViewer</strong></a></p><p>Open “iBackupViewer”.</p><blockquote><p>The first time you start it, you will need to go to Mac “System Preferences” - “Security &amp; Privacy” - “Privacy” - “+” - add “iBackupViewer”.</p></blockquote><blockquote><p><strong><em>*If you have privacy concerns, you can disable the network while using this software and remove it after use.</em></strong></p></blockquote><p><a href="/assets/99db2a1fbfe5/0*VMTW7WxQEl_ZFU7E.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/0*VMTW7WxQEl_ZFU7E.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Open “iBackupViewer” again, and after successfully reading the backup file, click on the “just backed up phone”.</p><p><a href="/assets/99db2a1fbfe5/1*Qqyp11Gc-dnK1Me08KKwbw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*Qqyp11Gc-dnK1Me08KKwbw.png" alt="Select the &quot;App Store&quot; Icon" class="lazyload" data-proofer-ignore></a></p><p>Select the “App Store” Icon.</p><p><a href="/assets/99db2a1fbfe5/1*VlGVYTHKG88GIiH4C745Vg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*VlGVYTHKG88GIiH4C745Vg.png" alt="On the left, find &quot;Mi Home APP (MiHome.app)&quot; -&gt; On the right, find &quot;numbers_mihome.sqlite&quot; file and &quot;select&quot; -&gt; Top right &quot;Export&quot; -&gt; &quot;Selected Files&quot;" class="lazyload" data-proofer-ignore></a></p><p>On the left, find “Mi Home APP (MiHome.app)” -&gt; On the right, find “numbers_mihome.sqlite” file and “select” -&gt; Top right “Export” -&gt; “Selected Files”.</p><blockquote><p>*If there are two “numbers_mihome.sqlite” files, choose the one with the latest Created time.</p></blockquote><p>Drag the exported <strong>numbers_mihome.sqlite</strong> file into this website to view the content:</p><p><a href="https://inloop.github.io/sqlite-viewer/" target="_blank" class="img-link shimmer" ><img data-src="https://inloop.github.io/sqlite-viewer/img/icon.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>You can change the query syntax to:</strong></p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="nv">`ZDID`</span><span class="p">,</span><span class="nv">`ZNAME`</span><span class="p">,</span><span class="nv">`ZTOKEN`</span> <span class="k">FROM</span> <span class="s1">'ZDEVICE'</span> <span class="k">LIMIT</span> <span class="mi">0</span><span class="p">,</span><span class="mi">30</span>
</pre></table></code></div></div><p>Only display the field information we need (if there are specific appliance kits that require other field information, you can also add them for filtering).</p><p><a href="/assets/99db2a1fbfe5/1*VWdrF905GGB_yXrCD5CpPg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*VWdrF905GGB_yXrCD5CpPg.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>ZDID: Device ID<li>ZNAME: Device Name<li>ZTOKEN: Device ZToken</ol><blockquote><p><strong><em>ZTOKEN cannot be used directly, it needs to be converted to “Token” to be usable.</em></strong></p></blockquote><p>Here, we take the conversion of the camera’s ZToken to Token as an example:</p><p>First, we obtain the ZToken field content of the camera from the above list:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>7f1a3541f0433b3ccda94beb856c2f5ba2b15f293ce0cc398ea08b549f9c74050143db63ee66b0cdff9f69917680151e
</pre></table></code></div></div><p>But the TOKEN obtained here cannot be used yet, we still need to convert it.</p><p><strong>Open <a href="http://aes.online-domain-tools.com/" target="_blank">http://aes.online-domain-tools.com/</a> this website:</strong></p><ol><li>Paste the ZTOKEN you just copied into “Input Text” and select “Hex”.<li>Enter “00000000000000000000000000000000” (32 zeros) in the Key field, and also select “Hex”.<li>Then click “Decrypt!” to convert.<li>Select and copy the output content of the bottom two lines on the right and remove the spaces to get the result <strong>Token</strong>.</ol><p><a href="/assets/99db2a1fbfe5/1*aQ7RfRx9ATjflYgMysnn3A.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*aQ7RfRx9ATjflYgMysnn3A.png" alt="「 **6d304e6867384b704b4f714d45314a34** 」is the Token result we need!" class="lazyload" data-proofer-ignore></a></p><p>「 <strong>6d304e6867384b704b4f714d45314a34</strong> 」is the Token result we need!</p><blockquote><p>*The method of obtaining the Token has been tried using “miio” to sniff directly, but it seems that the Mijia firmware has been updated, and this method can no longer be used to quickly and conveniently obtain the Token!</p></blockquote><p>Finally, we also need to know the <strong>IP address of the device</strong> (here we take the camera as an example):</p><p><a href="/assets/99db2a1fbfe5/0*OvqmDU7ARvoG96J0.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/0*OvqmDU7ARvoG96J0.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Open the Mi Home APP → Camera → Top right corner “…” → Settings → Network Information, to get the <strong>IP address</strong>!</p><blockquote><p><strong><em>Record the ZDID/Token/IP information for later use.</em></strong></p></blockquote><h3 id="integrate-mijia-smart-appliances-into-homebridge-one-by-one"><span class="me-2">Integrate Mijia Smart Appliances into HomeBridge One by One</span><a href="#integrate-mijia-smart-appliances-into-homebridge-one-by-one" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Install and configure each device individually according to the required plugins and connection information, and add them to HomeBridge.</p><blockquote><p><strong><em>Next, open Terminal, ssh into the Raspberry Pi, or use VNC remote desktop’s Terminal to continue the subsequent operations…</em></strong></p></blockquote><h4 id="1-mijia-camera-pan-tilt-version"><span class="me-2"><strong>1. Mijia Camera Pan-Tilt Version:</strong></span><a href="#1-mijia-camera-pan-tilt-version" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In Terminal, run the command to install the <a href="https://github.com/josepramon/homebridge-mijia-camera" target="_blank">MijiaCamera</a> homebridge plugin (<strong>without sudo</strong>):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nb">install</span> <span class="nt">-g</span> homebridge-mijia-camera
</pre></table></code></div></div><p><a href="/assets/99db2a1fbfe5/1*V7hZyogacXS9m_XN4qVtFw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*V7hZyogacXS9m_XN4qVtFw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the previous tutorial on modifying the configuration file (config.json), and add the <strong>accessories</strong> section in the file:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
   </span><span class="nl">"bridge"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Homebridge"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="s2">"CC:22:3D:E3:CE:30"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"port"</span><span class="p">:</span><span class="mi">51826</span><span class="p">,</span><span class="w">
      </span><span class="nl">"pin"</span><span class="p">:</span><span class="s2">"123-45-568"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"accessories"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"accessory"</span><span class="p">:</span><span class="s2">"MijiaCamera"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Mi Camera"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nl">"token"</span><span class="p">:</span><span class="s2">""</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">accessories:</code> Add the configuration information of the Mijia camera, with the ip field filled with the camera’s IP and the token field filled with the token taught in the previous tutorial.</p><blockquote><p><strong><em>Remember to save the file!</em></strong></p></blockquote><p>Then, follow the Homebridge section tutorial to start/restart/scan and add to Homebridge; you will be able to see the camera control items in the “Home” APP.</p><p><a href="/assets/99db2a1fbfe5/0*fHtbNC-8IL9KQUyu.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/0*fHtbNC-8IL9KQUyu.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Controllable items: Camera on/off</p><h4 id="2-mi-home-dc-variable-frequency-fan"><span class="me-2">2. Mi Home DC Variable Frequency Fan</span><a href="#2-mi-home-dc-variable-frequency-fan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In Terminal, install the <a href="https://github.com/YinHangCode/homebridge-mi-fan" target="_blank">homebridge-mi-fan</a> homebridge plugin <strong>(without sudo)</strong>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nb">install</span> <span class="nt">-g</span> homebridge-mi-fan
</pre></table></code></div></div><p><a href="/assets/99db2a1fbfe5/1*vwe7fapof2mA4me_3_HyfA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*vwe7fapof2mA4me_3_HyfA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the previous tutorial on modifying the configuration file (config.json), and add the <strong>platforms</strong> block in the file (if it already exists, add a sub-block within the block using a comma) <strong>:</strong></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
   </span><span class="nl">"bridge"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Homebridge"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="s2">"CC:22:3D:E3:CE:30"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"port"</span><span class="p">:</span><span class="mi">51826</span><span class="p">,</span><span class="w">
      </span><span class="nl">"pin"</span><span class="p">:</span><span class="s2">"123-45-568"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"platforms"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"platform"</span><span class="p">:</span><span class="s2">"MiFanPlatform"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"deviceCfgs"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
               </span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"MiDCVariableFrequencyFan"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
               </span><span class="nl">"token"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
               </span><span class="nl">"fanName"</span><span class="p">:</span><span class="s2">"room fan"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"fanDisable"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
               </span><span class="nl">"temperatureName"</span><span class="p">:</span><span class="s2">"room temperature"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"temperatureDisable"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
               </span><span class="nl">"humidityName"</span><span class="p">:</span><span class="s2">"room humidity"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"humidityDisable"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
               </span><span class="nl">"buzzerSwitchName"</span><span class="p">:</span><span class="s2">"fan buzzer switch"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"buzzerSwitchDisable"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
               </span><span class="nl">"ledBulbName"</span><span class="p">:</span><span class="s2">"fan led switch"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"ledBulbDisable"</span><span class="p">:</span><span class="kc">true</span><span class="w">
            </span><span class="p">}</span><span class="w">
         </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">platforms:</code> Add Mi Home fan configuration information, input the camera’s IP in the ip field, input the token from the previous tutorial in the token field, and control whether to display temperature and humidity information with humidity/temperature. <strong>The type must be the corresponding model text</strong>, supporting four different fan models:</p><ol><li>ZhiMi DC Variable Frequency Floor Fan: ZhiMiDCVariableFrequencyFan<li>ZhiMi Natural Wind Fan: ZhiMiNaturalWindFan<li>Mi Home DC Variable Frequency: MiDCVariableFrequencyFan (sold in Taiwan)<li>Mi Home Fan: DmakerFan</ol><p>Please input your own fan model.</p><blockquote><p><strong><em>Remember to save the file!</em></strong></p></blockquote><p>Then, as taught in the Homebridge section, start/restart/scan to add to Homebridge; you will be able to see the camera control items in the “Home” APP.</p><p><a href="/assets/99db2a1fbfe5/1*N_N5_WCnHNsepVv7HvAjmQ.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*N_N5_WCnHNsepVv7HvAjmQ.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Controllable items: Fan on/off, wind speed adjustment</p><h4 id="3-xiaomi-air-purifier-3"><span class="me-2">3. Xiaomi Air Purifier 3</span><a href="#3-xiaomi-air-purifier-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In Terminal, install the <a href="https://github.com/rgavril/homebridge-xiaomi-air-purifier3" target="_blank">homebridge-xiaomi-air-purifier3</a> homebridge plugin <strong>(without sudo)</strong>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nb">install</span> <span class="nt">-g</span> homebridge-xiaomi-air-purifier3
</pre></table></code></div></div><p><a href="/assets/99db2a1fbfe5/1*VxEYnHaBwQVLxxXOLb1Jkg.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*VxEYnHaBwQVLxxXOLb1Jkg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the previous tutorial on modifying the configuration file (config.json), and add the <strong>accessories</strong> block in the file (if it already exists, add a sub-block within the block using a comma) <strong>:</strong></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
   </span><span class="nl">"bridge"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Homebridge"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="s2">"CC:22:3D:E3:CE:30"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"port"</span><span class="p">:</span><span class="mi">51826</span><span class="p">,</span><span class="w">
      </span><span class="nl">"pin"</span><span class="p">:</span><span class="s2">"123-45-568"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"accessories"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"accessory"</span><span class="p">:</span><span class="s2">"XiaomiAirPurifier3"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Xiaomi Air Purifier"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"did"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nl">"token"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nl">"pm25_breakpoints"</span><span class="p">:[</span><span class="w">
            </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="mi">12</span><span class="p">,</span><span class="w">
            </span><span class="mi">35</span><span class="p">,</span><span class="w">
            </span><span class="mi">55</span><span class="w">
         </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">accessories:</code> Add Mi Home fan configuration information, ip should be the camera ip, token should be the token taught in the previous tutorial, did should be zdid</p><blockquote><p><strong><em>Remember to save!</em></strong></p></blockquote><p>Then follow the Homebridge section instructions to start/restart/scan and add to Homebridge; you will be able to see the camera control items in the “Home” APP.</p><p><a href="/assets/99db2a1fbfe5/1*R1bxhdiGuY3SyFnrhCO6iw.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*R1bxhdiGuY3SyFnrhCO6iw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/99db2a1fbfe5/1*05s08YdF6vQUWAG7nmTnfA.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*05s08YdF6vQUWAG7nmTnfA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Controllable items: Air purifier switch, wind speed adjustment Viewable items: Current temperature and humidity</p><h4 id="4-mi-home-led-smart-desk-lamp"><span class="me-2">4. Mi Home LED Smart Desk Lamp</span><a href="#4-mi-home-led-smart-desk-lamp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In Terminal, install the <a href="https://github.com/vieira/homebridge-yeelight-wifi" target="_blank">homebridge-yeelight-wifi</a> homebridge plugin <strong>(without sudo)</strong>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm <span class="nb">install</span> <span class="nt">-g</span> homebridge-yeelight-wifi
</pre></table></code></div></div><p><a href="/assets/99db2a1fbfe5/1*1fQJ9UTCJRghUk00iT2WcQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*1fQJ9UTCJRghUk00iT2WcQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the previous tutorial on modifying the configuration file (config.json), and add the <strong>platforms</strong> block in the file (if it already exists, add a sub-block with a comma inside the block) <strong>:</strong></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
   </span><span class="nl">"bridge"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Homebridge"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="s2">"CC:22:3D:E3:CE:30"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"port"</span><span class="p">:</span><span class="mi">51826</span><span class="p">,</span><span class="w">
      </span><span class="nl">"pin"</span><span class="p">:</span><span class="s2">"123-45-568"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"platforms"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"platform"</span><span class="p">:</span><span class="s2">"yeelight"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Yeelight"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>No need to pass any special parameters! For more detailed settings, refer to the <a href="https://github.com/vieira/homebridge-yeelight-wifi" target="_blank">official documentation</a> (such as brightness/color temperature…)</p><blockquote><p><strong><em>Remember to save!</em></strong></p></blockquote><p>The smart desk lamp also needs to be re-bound to the <a href="https://apps.apple.com/tw/app/yeelight/id977125608" target="_blank">Yeelight</a> APP, and then turn on “Local Network Control” to allow Homebridge to control it.</p><ol><li>Download and install the <a href="https://apps.apple.com/tw/app/yeelight/id977125608" target="_blank">Yeelight</a> APP on your iPhone</ol><p><a href="/assets/99db2a1fbfe5/1*3m-UOoI7uam4a_N5dxU5VQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*3m-UOoI7uam4a_N5dxU5VQ.png" alt="Search &quot;Yeelight&quot; in the App Store and install" class="lazyload" data-proofer-ignore></a></p><p>Search “Yeelight” in the App Store and install</p><p><a href="/assets/99db2a1fbfe5/1*G9-12giq1DVIw5zTKOaF4A.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*G9-12giq1DVIw5zTKOaF4A.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/99db2a1fbfe5/1*usLJKkehTDKeeFG95KDe4g.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*usLJKkehTDKeeFG95KDe4g.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/99db2a1fbfe5/1*cWBMAqa_xkL01SoURNSO8g.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*cWBMAqa_xkL01SoURNSO8g.png" alt="After installation, open the Yeelight APP -&gt; &quot;Add Device&quot; -&gt; Find &quot;Mi Home Desk Lamp&quot; -&gt; Re-pair and bind" class="lazyload" data-proofer-ignore></a></p><p>After installation, open the Yeelight APP -&gt; “Add Device” -&gt; Find “Mi Home Desk Lamp” -&gt; Re-pair and bind</p><p><a href="/assets/99db2a1fbfe5/1*8un0THsUf3ZesFPGSj_p-g.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*8un0THsUf3ZesFPGSj_p-g.jpeg" alt="Remember to turn on &quot; **Local Network Control** &quot; in the last step" class="lazyload" data-proofer-ignore></a></p><p>Remember to turn on “ <strong>Local Network Control</strong> “</p><blockquote><p>*If you accidentally didn’t turn it on, you can go to the “Device” page -&gt; Select the desk lamp device -&gt; Click the bottom right “△” Tab -&gt; Click “Local Network Control” to enter settings -&gt; Turn on Local Network Control</p></blockquote><blockquote><p><strong><em>A little complaint, this is really bad, the Mi Home APP itself does not have this switch function, you must bind it to the Yeelight APP, and you cannot unbind or rebind it back to Mi Home… otherwise it will fail.</em></strong></p></blockquote><p>Then follow the Homebridge section instructions to start/restart/scan and add to Homebridge; you will be able to see the camera control items in the “Home” APP.</p><p><a href="/assets/99db2a1fbfe5/1*vyAiFirZgDB6_OSsHIdEPw.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*vyAiFirZgDB6_OSsHIdEPw.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Controllable items: Light switch, color temperature adjustment, brightness adjustment</p><h4 id="other-mijia-smart-home-appliances-homebridge-plugins"><span class="me-2">Other Mijia smart home appliances homebridge plugins:</span><a href="#other-mijia-smart-home-appliances-homebridge-plugins" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><strong>My final config.json looks like this:</strong></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
   </span><span class="nl">"bridge"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Homebridge"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"username"</span><span class="p">:</span><span class="s2">"CC:22:3D:E3:CE:30"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"port"</span><span class="p">:</span><span class="mi">51826</span><span class="p">,</span><span class="w">
      </span><span class="nl">"pin"</span><span class="p">:</span><span class="s2">"123-45-568"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"accessories"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"accessory"</span><span class="p">:</span><span class="s2">"MijiaCamera"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Mi Camera"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">"192.168.0.105"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"token"</span><span class="p">:</span><span class="s2">"6d304e6867384b704b4f714d45314a34"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"accessory"</span><span class="p">:</span><span class="s2">"XiaomiAirPurifier3"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Xiaomi Air Purifier"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"did"</span><span class="p">:</span><span class="s2">"270033668"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">"192.168.0.108"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"token"</span><span class="p">:</span><span class="s2">"5c3eeb03065fd8fc6ad10cae1f7cce7c"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"pm25_breakpoints"</span><span class="p">:[</span><span class="w">
            </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="mi">12</span><span class="p">,</span><span class="w">
            </span><span class="mi">35</span><span class="p">,</span><span class="w">
            </span><span class="mi">55</span><span class="w">
         </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">],</span><span class="w">
   </span><span class="nl">"platforms"</span><span class="p">:[</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"platform"</span><span class="p">:</span><span class="s2">"MiFanPlatform"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"deviceCfgs"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
               </span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"MiDCVariableFrequencyFan"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">"192.168.0.106"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"token"</span><span class="p">:</span><span class="s2">"dd1b6f582ba6ce34f959bbbc1c1ca59f"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"fanName"</span><span class="p">:</span><span class="s2">"room fan"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"fanDisable"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
               </span><span class="nl">"temperatureName"</span><span class="p">:</span><span class="s2">"room temperature"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"temperatureDisable"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
               </span><span class="nl">"humidityName"</span><span class="p">:</span><span class="s2">"room humidity"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"humidityDisable"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
               </span><span class="nl">"buzzerSwitchName"</span><span class="p">:</span><span class="s2">"fan buzzer switch"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"buzzerSwitchDisable"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
               </span><span class="nl">"ledBulbName"</span><span class="p">:</span><span class="s2">"fan led switch"</span><span class="p">,</span><span class="w">
               </span><span class="nl">"ledBulbDisable"</span><span class="p">:</span><span class="kc">true</span><span class="w">
            </span><span class="p">}</span><span class="w">
         </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
         </span><span class="nl">"platform"</span><span class="p">:</span><span class="s2">"yeelight"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"Yeelight"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><strong>For your reference!</strong></p><p>The Mijia appliances I used are as taught above. I didn’t try the ones I don’t have. You can <a href="https://www.npmjs.com/search?q=keywords%3Ahomebridge-plugin%20mi%20camera" target="_blank"><strong>search on npm (homebridge-plugin XXX English name)</strong></a> and follow the similar logic to install and configure them!</p><p>Here are some homebridge plugins I found but haven’t tried (no guarantee they work):</p><ol><li>Xiaomi Air Purifier 1st Gen: <a href="https://github.com/seikan/homebridge-mi-air-purifier" target="_blank">homebridge-mi-air-purifier</a><li>Mijia Smart Plug Series: <a href="https://github.com/YinHangCode/homebridge-mi-outlet" target="_blank">homebridge-mi-outlet</a><li>Xiaomi Robot Vacuum: <a href="https://github.com/YinHangCode/homebridge-mi-robot_vacuum" target="_blank">homebridge-mi-robot_vacuum</a><li>Mijia Smart Gateway: <a href="https://github.com/YinHangCode/homebridge-mi-aqara" target="_blank">homebridge-mi-aqara</a></ol><h3 id="tips"><span class="me-2">Tips</span><a href="#tips" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>It is recommended to set all Mi Home appliances to a specified/reserved IP on the router, otherwise the IP address may change, and you will need to reconfigure the config.json settings.<li>If you find that all steps are correct but errors still occur or it keeps showing “No Response” on HomeKit, you can try again; if the issue persists, it may indicate that the plugin is no longer valid, and you need to find another plugin to connect. (You can check the GitHub issue)<li>Function failure, slow response; this is also unsolvable, you can post an issue to inform the author and wait for an update. Since it is an open-source project, you cannot demand too much!<li><strong>After binding each appliance, you can start Homebridge once and then check on your iPhone to see if it works. If it does, you can terminate it with “Control” + “C”; after binding all appliances, you can restart the Raspberry Pi to let it automatically start the Homebridge service in the background after rebooting; this is what we want.</strong></ol><h3 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/99db2a1fbfe5/1*w7WnAn3XHNW2f5fJbRd_Zw.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*w7WnAn3XHNW2f5fJbRd_Zw.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/99db2a1fbfe5/1*ph8BfcF0ivvlZyKNF9mubQ.png" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*ph8BfcF0ivvlZyKNF9mubQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/99db2a1fbfe5/1*e1FAJuyCLOWEkA6MAeENkA.jpeg" class="popup img-link "><img data-src="/assets/99db2a1fbfe5/1*e1FAJuyCLOWEkA6MAeENkA.jpeg" alt="Additionally, you can go to &quot;Settings&quot; -&gt; &quot;Control Center&quot; -&gt; &quot;Customize&quot; to add the &quot;Home&quot; app, allowing you to quickly operate HomeKit from the drop-down control center!" class="lazyload" data-proofer-ignore></a></p><p>Additionally, you can go to “Settings” -&gt; “Control Center” -&gt; “Customize” to add the “Home” app, allowing you to quickly operate HomeKit from the drop-down control center!</p><p>After connecting everything to HomeKit, the only word is “Awesome”! The response to switching is faster, the only downside is that I don’t have a home hub, so I can’t control it remotely. This concludes the advanced Homebridge tutorial, thank you for reading.</p><p>Back to the beginning of the article, after adding everything to HomeKit, we can seamlessly use the iOS ≥ 13 Shortcuts automation feature.</p><p>Do you want to study how the Homebridge plugin is made? It seems very interesting! So if there is a HomeBridge plugin that doesn’t meet your operational needs or a plugin is broken and you can’t find a replacement, just wait for me to study it!</p><h4 id="home-assistant"><span class="me-2">Home assistant</span><a href="#home-assistant" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>There is another smart home platform <a href="https://www.home-assistant.io/" target="_blank">Homeassistant</a> that can be flashed into the Raspberry Pi for use (<strong>Note: A 2A power supply is required to start</strong>); I also installed <a href="https://www.home-assistant.io/" target="_blank">Homeassistant</a> to play with. It has a full GUI interface, and you can connect appliances with just a few clicks; I will study it in-depth later. It feels like another Mi Home platform, but if you have many different manufacturers’ IoT components, it is more suitable to use this.</p><h4 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li><a href="https://www.domoticz.cn/forum/viewtopic.php?t=52" target="_blank">https://www.domoticz.cn/forum/viewtopic.php?t=52</a><li><a href="https://or2.in/2017/07/02/Homekit-and-MiJia-with-pi/#3-%E5%8F%B7%E5%A4%96-%E5%BC%80%E5%90%AF%E5%8F%AF%E8%A7%86%E5%8C%96VNC" target="_blank">https://or2.in/2017/07/02/Homekit-and-MiJia-with-pi/#3-%E5%8F%B7%E5%A4%96-%E5%BC%80%E5%90%AF%E5%8F%AF%E8%A7%86%E5%8C%96VNC</a></ol><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><a href="../bcff7c157941/">New Additions to Xiaomi Smart Home (AI Speaker, Temperature and Humidity Sensor, Scale 2, DC Inverter Fan)</a><li><a href="../21119db777dd/">Using “Shortcuts” Automation Feature with Mi Home Smart Home on iOS ≥ 13.1 (Directly using the built-in Shortcuts app on iOS ≥ 13.1 for automation)</a><li><a href="../94a4020edb82/">Mi Home App / Xiao Ai Speaker Region Issues</a><li><a href="../c3150cdc85dd/">First Experience with Smart Home — Apple HomeKit &amp; Xiaomi Mi Home (Mi Home Smart Camera and Mi Home Smart Desk Lamp, HomeKit Setup Tutorial)</a></ol><p>If you have any questions or comments, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><p>===</p><p><a href="https://zhgchg.li/posts/99db2a1fbfe5/" target="_blank">本文中文版本</a></p><p>===</p><p>This article was first published in Traditional Chinese on Medium ➡️ <a href="https://medium.com/p/99db2a1fbfe5" target="_blank"><strong>View Here</strong></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script></div><hr/> <a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer!&emoji=🍺&slug=zhgchgli&button_colour=FFDD00&font_colour=000000&font_family=Bree&outline_colour=000000&coffee_colour=ffffff" class="lazyload" data-proofer-ignore></a> <br/> <a href="https://medium.com/@zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="/assets/images/followmymedium.png" class="lazyload" data-proofer-ignore></a> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3184248473087645" data-ad-slot="7555148040"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/zrealm/'>ZRealm</a>, <a href='/categories/life/'>Life.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/homekit/" class="post-tag no-text-decoration" >homekit</a> <a href="/tags/iphone/" class="post-tag no-text-decoration" >iphone</a> <a href="/tags/homebridge/" class="post-tag no-text-decoration" >homebridge</a> <a href="/tags/mi-home/" class="post-tag no-text-decoration" >Mi Home</a> <a href="/tags/life/" class="post-tag no-text-decoration" >life</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Creating%20a%20Comfortable%20WFH%20Smart%20Home%20Environment,%20Control%20Appliances%20at%20Your%20Fingertips%20-%20ZhgChgLi&url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2F99db2a1fbfe5%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Creating%20a%20Comfortable%20WFH%20Smart%20Home%20Environment,%20Control%20Appliances%20at%20Your%20Fingertips%20-%20ZhgChgLi&u=https%3A%2F%2Fen.zhgchg.li%2Fposts%2F99db2a1fbfe5%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2F99db2a1fbfe5%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/d9a95d4224ea/">Medium Custom Domain Feature Returns</a><li class="text-truncate lh-lg"> <a href="/posts/483af5d93297/">Custom Domain Tutorial for Github Pages</a><li class="text-truncate lh-lg"> <a href="/posts/9e43897d99fc/">Behavior Change in Merging NSAttributedString Attributes Range in iOS ≥ 18</a><li class="text-truncate lh-lg"> <a href="/posts/b08ef940c196/">iOS Deferred Deep Link Implementation (Swift)</a><li class="text-truncate lh-lg"> <a href="/posts/12c5026da33d/">What's New with Universal Links</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/c3150cdc85dd/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1562346827" data-df="ll" > Jul 6, 2019 </em><h4 class="pt-0 my-2" data-toc-skip>First Experience with Smart Home - Apple HomeKit & Xiaomi Mijia</h4><div class="text-muted small"><p> First Experience with Smart Home - Apple HomeKit &amp;amp; Xiaomi Mijia Mijia Smart Camera and Mijia Smart Desk Lamp, Homekit Setup Tutorial [2020/04/20] Advanced Tutorial Released ： Experienced use...</p></div></div></a></div><div class="col"> <a href="/posts/bcff7c157941/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1569503802" data-df="ll" > Sep 26, 2019 </em><h4 class="pt-0 my-2" data-toc-skip>New Xiaomi Smart Home Purchases</h4><div class="text-muted small"><p> New Xiaomi Smart Home Purchases AI Speaker, Temperature and Humidity Sensor, Scale 2, DC Inverter Fan Usage Experience Getting Started Following the previous post “Smart Home First Experience — ...</p></div></div></a></div><div class="col"> <a href="/posts/21119db777dd/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1569507816" data-df="ll" > Sep 26, 2019 </em><h4 class="pt-0 my-2" data-toc-skip>Using 'Shortcuts' Automation with Mi Home Smart Home on iOS ≥ 13.1</h4><div class="text-muted small"><p> Using ‘Shortcuts’ Automation with Mi Home Smart Home on iOS ≥ 13.1 Automate operations directly using the built-in Shortcuts app on iOS ≥ 13.1 Introduction In early July this year, I bought two ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/d796bf8e661e/" class="btn btn-outline-primary" prompt="Older" ><p>Exploring Methods for Implementing iOS HLS Cache</p></a> <a href="/posts/2e4429f410d6/" class="btn btn-outline-primary" prompt="Newer" ><p>Easily Create a 'Fake' Transparent Perspective Wallpaper Using iPhone</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> <br/> <a href="https://zhgchg.li" target="_blank">中文版網站</a><br/> Powered by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</p><p>© 2024 <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-JSGN97L56L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-JSGN97L56L'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
