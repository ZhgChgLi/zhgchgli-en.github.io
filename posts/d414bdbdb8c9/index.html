<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Using Google Apps Script to Forward Gmail Emails to Slack" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Use Gmail Filter + Google Apps Script to automatically forward customized content to Slack Channel when receiving emails" /><meta property="og:description" content="Use Gmail Filter + Google Apps Script to automatically forward customized content to Slack Channel when receiving emails" /><link rel="canonical" href="https://en.zhgchg.li/posts/d414bdbdb8c9/" /><meta property="og:url" content="https://en.zhgchg.li/posts/d414bdbdb8c9/" /><meta property="og:site_name" content="ZhgChgLi" /><meta property="og:image" content="https://en.zhgchg.li/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-07T20:19:49+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://en.zhgchg.li/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.jpeg" /><meta property="twitter:title" content="Using Google Apps Script to Forward Gmail Emails to Slack" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@ZhgChgLi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi"},"dateModified":"2024-04-14T09:54:47+08:00","datePublished":"2021-08-07T20:19:49+08:00","description":"Use Gmail Filter + Google Apps Script to automatically forward customized content to Slack Channel when receiving emails","headline":"Using Google Apps Script to Forward Gmail Emails to Slack","image":"https://en.zhgchg.li/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://en.zhgchg.li/posts/d414bdbdb8c9/"},"url":"https://en.zhgchg.li/posts/d414bdbdb8c9/"}</script><title>Using Google Apps Script to Forward Gmail Emails to Slack | ZhgChgLi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi"><meta name="application-name" content="ZhgChgLi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">ZhgChgLi</a></div><div class="site-subtitle fst-italic">Live a life you will remember.</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/real/" class="nav-link"> <i class="fa-fw fa fa-camera-retro"></i> <span>REAL LIFE</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Using Google Apps Script to Forward Gmail Emails to Slack</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Using Google Apps Script to Forward Gmail Emails to Slack</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1628338789" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 7, 2021 </em> </span> <span> Updated <em class="" data-ts="1713059687" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 14, 2024 </em> </span><div class="mt-3 mb-3"> <a href="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.jpeg" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.jpeg" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1498 words" > <em>8 min</em> read</span></div></div></div><div class="post-content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><h3 id="using-google-apps-script-to-forward-gmail-emails-to-slack"><span class="me-2">Using Google Apps Script to Forward Gmail Emails to Slack</span><a href="#using-google-apps-script-to-forward-gmail-emails-to-slack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Use Gmail Filter + Google Apps Script to automatically forward customized content to Slack Channel when receiving emails</p><p><a href="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*U6CDgIAMt2l2vDoFqhwv6A.jpeg" alt="Photo by [Lukas Blazek](https://unsplash.com/@goumbik?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" class="lazyload" data-proofer-ignore></a></p><p>Photo by <a href="https://unsplash.com/@goumbik?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Lukas Blazek</a></p><h3 id="origin"><span class="me-2">Origin</span><a href="#origin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Recently, I have been optimizing the CI/CD process for an iOS App, using Fastlane as an automation tool. After packaging and uploading, if you want to continue with the automatic submission step ( <code class="language-plaintext highlighter-rouge">skip_submission=false</code> ), you need to wait for Apple to complete the process, which takes about 30-40 mins of CI Server time. Because Apple’s App Store Connect API is not perfect, Fastlane can only check once per minute if the uploaded build is processed, which is very resource-wasting.</p><p><a href="/assets/d414bdbdb8c9/1*JXuVoKM-gGJwfvF7tXY1nQ.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*JXuVoKM-gGJwfvF7tXY1nQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li><strong>Bitrise CI Server:</strong> Limits the number of simultaneous builds and the maximum execution time to 90 mins. 90 mins is enough, but it will block one build, hindering others from executing.<li><strong>Travis CI Server:</strong> Charges based on build time, so waiting is not an option, as money would be wasted.</ul><h4 id="a-different-approach"><span class="me-2">A Different Approach</span><a href="#a-different-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>No more waiting. End it right after uploading! Use the email notification of completion to trigger subsequent actions.</p><p><a href="/assets/d414bdbdb8c9/1*57FOYivs5toW2aipgRVCeg.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*57FOYivs5toW2aipgRVCeg.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><strong><em>However, I haven’t received this email recently. I don’t know if it’s a setting issue or if Apple no longer sends this type of notification.</em></strong></p></blockquote><p>This article will use the email notification that Testflight is ready for testing as an example.</p><p><a href="/assets/d414bdbdb8c9/1*2fmqWCAMiM2UeuGss7VzzA.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*2fmqWCAMiM2UeuGss7VzzA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/d414bdbdb8c9/1*sndRqvnELhCshb6yyPFhqg.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*sndRqvnELhCshb6yyPFhqg.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>The complete process is shown in the image above. The principle is feasible; however, this is not the focus of this article. This article will focus on receiving emails and using Apps Script to forward them to a Slack Channel.</em></p></blockquote><h3 id="how-to-forward-received-emails-to-slack-channel"><span class="me-2">How to Forward Received Emails to Slack Channel</span><a href="#how-to-forward-received-emails-to-slack-channel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Whether it’s a paid or free Slack project, different methods can be used to achieve the function of forwarding emails to a Slack Channel or DM.</p><p>You can refer to the official documentation for setup: <a href="https://slack.com/intl/zh-tw/help/articles/206819278-%E5%82%B3%E9%80%81%E9%9B%BB%E5%AD%90%E9%83%B5%E4%BB%B6%E8%87%B3-Slack" target="_blank">Send Emails to Slack</a></p><p><strong>The effect is the same regardless of the method used:</strong></p><p><a href="/assets/d414bdbdb8c9/1*qdoLTotLTaeZPsEHaJ8C7Q.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*qdoLTotLTaeZPsEHaJ8C7Q.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>Default collapsed email content, click to expand and view all content.</em></p></blockquote><p><strong>Advantages:</strong></p><ol><li>Simple and fast<li>Zero technical threshold<li>Instant forwarding</ol><p><strong>Disadvantages:</strong></p><ol><li>Cannot customize content<li>Display style cannot be changed</ol><h3 id="custom-forwarding-content"><span class="me-2">Custom Forwarding Content</span><a href="#custom-forwarding-content" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is the main focus of this article.</p><p><a href="/assets/d414bdbdb8c9/1*w4E7wf-Kf8XVFxowmDopIw.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*w4E7wf-Kf8XVFxowmDopIw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Translate the email content data into the style you want to present, as shown in the example above.</p><h4 id="first-a-complete-workflow-diagram"><span class="me-2">First, a complete workflow diagram:</span><a href="#first-a-complete-workflow-diagram" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/d414bdbdb8c9/1*yB5s_5rBr4l6hid21huJMQ.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*yB5s_5rBr4l6hid21huJMQ.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Use Gmail Filter to add a recognition label to the email to be forwarded<li>Apps Script regularly fetches emails marked with that label<li>Read the email content<li>Render into the desired display style<li>Send messages to Slack via Slack Bot API or directly using Incoming Message<li>Remove the email label (indicating it has been forwarded)<li>Done</ul><h4 id="first-create-a-filter-in-gmail"><span class="me-2">First, create a filter in Gmail</span><a href="#first-create-a-filter-in-gmail" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Filters can automate some actions when receiving emails that meet certain conditions, such as automatically marking as read, automatically tagging, automatically moving to spam, automatically categorizing, etc.</p><p><a href="/assets/d414bdbdb8c9/1*qNXxtTLzEnlArl4UTTWQMw.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*qNXxtTLzEnlArl4UTTWQMw.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>In Gmail, click the advanced search icon button in the upper right corner, enter the forwarding email rule conditions, such as from: <code class="language-plaintext highlighter-rouge">no_reply@email.apple.com</code> + subject is <code class="language-plaintext highlighter-rouge">is now available to test.</code>, click “Search” to see if the filter results are as expected; if correct, click the “Create filter” button next to Search.</p><p><a href="/assets/d414bdbdb8c9/1*i7grToZwE_ixwJTEjI9qtw.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*i7grToZwE_ixwJTEjI9qtw.jpeg" alt="Or directly click Filter message like these at the top of the email to quickly create filter conditions" class="lazyload" data-proofer-ignore></a></p><p>Or directly click Filter message like these at the top of the email to quickly create filter conditions</p><p><a href="/assets/d414bdbdb8c9/1*n_nbqgIlE-E1eaW5QfqkWg.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*n_nbqgIlE-E1eaW5QfqkWg.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p>This button design is very counterintuitive, it took me a while to find it the first time.</p></blockquote><p><a href="/assets/d414bdbdb8c9/1*6zlooS-cMr5LEVX2TW5I_w.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*6zlooS-cMr5LEVX2TW5I_w.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Next, set the actions for emails that meet this filter condition. Here we select “Apply the label” to create a separate new recognition label “forward-to-slack”, click “Create filter” to complete.</p><p>From then on, all emails marked with this label will be forwarded to Slack.</p><h3 id="get-incoming-webhooks-app-url"><span class="me-2">Get Incoming WebHooks App URL</span><a href="#get-incoming-webhooks-app-url" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, we need to add the Incoming WebHooks App to the Slack Channel, which we will use to send messages.</p><p><a href="/assets/d414bdbdb8c9/1*AgGLiLsyvenK-LRWI9rlKg.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*AgGLiLsyvenK-LRWI9rlKg.png" alt="" class="lazyload" data-proofer-ignore></a></p><ol><li>Slack lower left corner “Apps” -&gt; “Add apps”<li>Search “incoming” in the search box on the right<li>Click “Incoming WebHooks” -&gt; “Add”</ol><p><a href="/assets/d414bdbdb8c9/1*DUcwdLTKt33Fa-jNlW8MkA.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*DUcwdLTKt33Fa-jNlW8MkA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/d414bdbdb8c9/1*v8Z-5vEM043F82TMiZk2lw.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*v8Z-5vEM043F82TMiZk2lw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Select the channel where you want to send the message.</p><p><a href="/assets/d414bdbdb8c9/1*SRciom_ygU0JDKK9ATY1FQ.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*SRciom_ygU0JDKK9ATY1FQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Note down the “Webhook URL” at the top</p><p><a href="/assets/d414bdbdb8c9/1*kp1QDIEwzQtmfzUwZIDTSg.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*kp1QDIEwzQtmfzUwZIDTSg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Scroll down to set the name and avatar of the bot that sends the message; remember to click “Save Settings” after making changes.</p><blockquote><p><strong><em>Note</em></strong></p></blockquote><blockquote><p><em>Please note that the official recommendation is to use the new Slack APP Bot API’s <a href="https://api.slack.com/methods/chat.postMessage" target="_blank">chat.postMessage</a> to send messages. The simple method of Incoming Webhook will be deprecated in the future. This article uses the simpler method, but it can be adjusted to the new method along with the next chapter “Import Employee List” which requires the Slack App API.</em></p></blockquote><p><a href="/assets/d414bdbdb8c9/1*QfgJL_Xb9JhgQnPGjU2CXg.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*QfgJL_Xb9JhgQnPGjU2CXg.png" alt="" class="lazyload" data-proofer-ignore></a></p><h3 id="writing-apps-script-programs"><span class="me-2">Writing Apps Script Programs</span><a href="#writing-apps-script-programs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="https://script.google.com/home/my" target="_blank">Click here to go to my Apps Script project</a><li>Click on “New Project” in the top left<li>After creating, you can click on the project name to rename it, e.g., ForwardEmailsToSlack</ul><p>Paste the following basic script and modify it to your desired version:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">sendMessageToSlack</span><span class="p">(</span><span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">*You have received an email*</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">attachments</span><span class="dl">"</span><span class="p">:</span> <span class="p">[{</span>
          <span class="dl">"</span><span class="s2">pretext</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">The email content is as follows:</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="nx">content</span><span class="p">,</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">};</span>
    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">Paste your Slack incoming Webhook URL here</span><span class="dl">'</span><span class="p">,{</span>
      <span class="na">method</span>             <span class="p">:</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">contentType</span>        <span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">payload</span>            <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">forwardEmailsToSlack</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Referenced from: https://gist.github.com/andrewmwilson/5cab8367dc63d87d9aa5</span>

    <span class="kd">var</span> <span class="nx">label</span> <span class="o">=</span> <span class="nx">GmailApp</span><span class="p">.</span><span class="nx">getUserLabelByName</span><span class="p">(</span><span class="dl">'</span><span class="s1">forward-to-slack</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">messages</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">threads</span> <span class="o">=</span> <span class="nx">label</span><span class="p">.</span><span class="nx">getThreads</span><span class="p">();</span>
  
    <span class="k">if</span> <span class="p">(</span><span class="nx">threads</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">threads</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">messages</span> <span class="o">=</span> <span class="nx">messages</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">threads</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getMessages</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">messages</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">messages</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">*New Email*</span><span class="dl">'</span><span class="p">;</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*from:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getFrom</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*to:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getTo</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*cc:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getCc</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*date:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getDate</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*subject:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getSubject</span><span class="p">();</span>
        <span class="nx">output</span> <span class="o">+=</span> <span class="dl">'</span><span class="se">\n</span><span class="s1">*body:* </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getPlainBody</span><span class="p">();</span>

        <span class="nx">sendMessageToSlack</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>
   <span class="p">}</span>

   <span class="nx">label</span><span class="p">.</span><span class="nx">removeFromThreads</span><span class="p">(</span><span class="nx">threads</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>Advanced:</strong></p><ul><li><a href="https://api.slack.com/messaging/composing/layouts" target="_blank">For Slack message styles, refer to this official structure document</a>.<li>You can use JavaScript’s Regex Match Function to match and extract content from the email.</ul><p><strong>Example: Extracting version number information from a Testflight approval email:</strong></p><p>Email subject: Your app XXX has been approved for beta testing.</p><p>Email content:</p><p><a href="/assets/d414bdbdb8c9/1*aZkQGA3N1cquMLt1wyDGFg.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*aZkQGA3N1cquMLt1wyDGFg.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>We want to get the <strong>Bundle Version Short String and the value after Build Number</strong>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>var results = subject.match(/(Bundle Version Short String: ){1}(\S+){1}[\S\s]*(Build Number: ){1}(\S+){1}/);
if (results == null || results.length != 5) {
  // not valid
} else {
  var version = results[2];
  var build = results[4];
}
</pre></table></code></div></div><ul><li><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank">For Regex usage, refer here</a><li>To test if your Regex is correct online, you can use <a href="http://www.rubular.com/" target="_blank">this website</a></ul><h4 id="run-and-see"><span class="me-2">Run and See</span><a href="#run-and-see" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Go back to Gmail, find any email, and manually add the label — “forward-to-slack”<li>In the Apps Script code editor, select “forwardEmailsToSlack” and click the “Run” button</ul><p><a href="/assets/d414bdbdb8c9/1*JHHTQCWNUI-aNPBB6y4iAA.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*JHHTQCWNUI-aNPBB6y4iAA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/d414bdbdb8c9/1*ltXGtEVxkdde1qHGxy3wMw.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*ltXGtEVxkdde1qHGxy3wMw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>If “Authorization Required” appears, click “Continue” to complete the verification</p><p><a href="/assets/d414bdbdb8c9/1*hIgRtqKEFs0tsXDxfNTaOg.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*hIgRtqKEFs0tsXDxfNTaOg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>During the authentication process, “Google hasn’t verified this app” will appear. This is normal because our App Script has not been verified by Google. However, it is fine since this is for personal use.</p><p>Click the bottom left “Advanced” -&gt; “Go to ForwardEmailsToSlack (unsafe)”</p><p><a href="/assets/d414bdbdb8c9/1*QUkmTD1WlEzw7cqW97ll6Q.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*QUkmTD1WlEzw7cqW97ll6Q.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click “Allow”</p><p><a href="/assets/d414bdbdb8c9/1*TInHsY7Fwb9jHuKJkMJIsw.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*TInHsY7Fwb9jHuKJkMJIsw.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Forwarding successful!!!</p><h3 id="set-up-triggers-scheduling-for-automatic-checking--forwarding"><span class="me-2">Set Up Triggers (Scheduling) for Automatic Checking &amp; Forwarding</span><a href="#set-up-triggers-scheduling-for-automatic-checking--forwarding" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/d414bdbdb8c9/1*2Ok6gD5E7F1uqyzgVpoJ8A.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*2Ok6gD5E7F1uqyzgVpoJ8A.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>In the left menu of Apps Script, select “Triggers”.</p><p><a href="/assets/d414bdbdb8c9/1*1xb9xGGkgx6PkhWlWc7HiQ.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*1xb9xGGkgx6PkhWlWc7HiQ.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><p>Bottom left “+ Add Trigger”.</p><p><a href="/assets/d414bdbdb8c9/1*ujCxCH3f8HTvSOP5o4xvmA.jpeg" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*ujCxCH3f8HTvSOP5o4xvmA.jpeg" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Error notification settings: You can set how to notify you when the script encounters an error<li>Choose the function you want to execute: Select Main Function <code class="language-plaintext highlighter-rouge">sendMessageToSlack</code><li>Select event source: You can choose from Calendar or Time-driven (timed or specified)<li>Select time-based trigger type: You can choose to execute on a specific date or every minute/hour/day/week/month<li>Select minute/hour/day/week/month interval: EX: Every minute, every 15 minutes…</ul><blockquote><p><em>For demonstration purposes, set it to execute every minute. I think checking emails every hour is sufficient for real-time needs.</em></p></blockquote><p><a href="/assets/d414bdbdb8c9/1*LBAlTvz46NJCYgVv1DrfYQ.png" class="popup img-link "><img data-src="/assets/d414bdbdb8c9/1*LBAlTvz46NJCYgVv1DrfYQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Go back to Gmail, find any email, and manually add the label — “forward-to-slack”<li>Wait for the schedule to trigger</ul><p>Automatic checking &amp; forwarding successful!</p><h3 id="completion"><span class="me-2">Completion</span><a href="#completion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With this feature, you can achieve customized email forwarding processing and even use it as a trigger. For example, automatically execute a script when receiving an XXX email.</p><p>Returning to the origin in the first chapter, we can use this mechanism to perfect the CI/CD process; no need to wait idly for Apple to complete processing, and it can be linked to the automation process!</p><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="../e77b80cc6f89/">Crashlytics + Big Query to Create a More Real-time and Convenient Crash Tracking Tool</a><li><a href="../793cb8f89b72/">Crashlytics + Google Analytics Automatically Query App Crash-Free Users Rate</a><li><a href="../70a1409b149a/">Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks</a><li><a href="../d61062833c1a/">Slack to Create a Fully Automated WFH Employee Health Status Reporting System</a><li><a href="../46410aaada00/">The APP Uses HTTPS Transmission, but the Data Was Still Stolen.</a></ul><p>If you have any questions or comments, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><p>===</p><p><a href="https://zhgchg.li/posts/d414bdbdb8c9/" target="_blank">本文中文版本</a></p><p>===</p><p>This article was first published in Traditional Chinese on Medium ➡️ <a href="https://medium.com/p/d414bdbdb8c9" target="_blank"><strong>View Here</strong></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script></div><hr/> <a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer!&emoji=🍺&slug=zhgchgli&button_colour=FFDD00&font_colour=000000&font_family=Bree&outline_colour=000000&coffee_colour=ffffff" class="lazyload" data-proofer-ignore></a> <br/> <a href="https://medium.com/@zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="/assets/images/followmymedium.png" class="lazyload" data-proofer-ignore></a> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3184248473087645" data-ad-slot="7555148040"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/zrealm/'>ZRealm</a>, <a href='/categories/dev/'>Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/google-apps-script/" class="post-tag no-text-decoration" >google-apps-script</a> <a href="/tags/cicd/" class="post-tag no-text-decoration" >cicd</a> <a href="/tags/slack/" class="post-tag no-text-decoration" >slack</a> <a href="/tags/workflow-automation/" class="post-tag no-text-decoration" >workflow-automation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Using%20Google%20Apps%20Script%20to%20Forward%20Gmail%20Emails%20to%20Slack%20-%20ZhgChgLi&url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fd414bdbdb8c9%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Using%20Google%20Apps%20Script%20to%20Forward%20Gmail%20Emails%20to%20Slack%20-%20ZhgChgLi&u=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fd414bdbdb8c9%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fd414bdbdb8c9%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/d9a95d4224ea/">Medium Custom Domain Feature Returns</a><li class="text-truncate lh-lg"> <a href="/posts/483af5d93297/">Custom Domain Tutorial for Github Pages</a><li class="text-truncate lh-lg"> <a href="/posts/9e43897d99fc/">Behavior Change in Merging NSAttributedString Attributes Range in iOS ≥ 18</a><li class="text-truncate lh-lg"> <a href="/posts/b08ef940c196/">iOS Deferred Deep Link Implementation (Swift)</a><li class="text-truncate lh-lg"> <a href="/posts/12c5026da33d/">What's New with Universal Links</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/33f6aabb744f/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1620222679" data-df="ll" > May 5, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>ZReviewsBot — Slack App Review Notification Bot</h4><div class="text-muted small"><p> ZReviewsBot — Slack App Review Notification Bot Free and open-source iOS &amp;amp; Android APP latest review tracking Slack Bot TL;DR [2022/08/10] Update: Now redesigned using the new App Store Conn...</p></div></div></a></div><div class="col"> <a href="/posts/d61062833c1a/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1623603501" data-df="ll" > Jun 14, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>Building a Fully Automated WFH Employee Health Reporting System with Slack</h4><div class="text-muted small"><p> Building a Fully Automated WFH Employee Health Reporting System with Slack Enhancing work efficiency by playing with Slack Workflow combined with Google Sheet with App Script Photo by Stephen P...</p></div></div></a></div><div class="col"> <a href="/posts/e77b80cc6f89/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1634654010" data-df="ll" > Oct 19, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>Crashlytics + Big Query: Creating a More Immediate and Convenient Crash Tracking Tool</h4><div class="text-muted small"><p> Crashlytics + Big Query: Creating a More Immediate and Convenient Crash Tracking Tool Integrating Crashlytics and Big Query to automatically forward crash records to a Slack Channel Results ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/118e924a1477/" class="btn btn-outline-primary" prompt="Older" ><p>Productivity Tools: Abandon Chrome and Embrace Sidekick Browser</p></a> <a href="/posts/11f6c8568154/" class="btn btn-outline-primary" prompt="Newer" ><p>2021 Pinkoi Tech Career Talk - Decoding the High-Efficiency Engineering Team</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> <br/> <a href="https://zhgchg.li" target="_blank">中文版網站</a><br/> Powered by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</p><p>© 2024 <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-JSGN97L56L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-JSGN97L56L'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
