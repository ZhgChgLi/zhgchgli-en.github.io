<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Creating a daily automatic check-in script using a check-in reward app as an example" /><meta property="og:description" content="Creating a daily automatic check-in script using a check-in reward app as an example" /><link rel="canonical" href="https://en.zhgchg.li/posts/70a1409b149a/" /><meta property="og:url" content="https://en.zhgchg.li/posts/70a1409b149a/" /><meta property="og:site_name" content="ZhgChgLi" /><meta property="og:image" content="https://en.zhgchg.li/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-20T19:55:51+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://en.zhgchg.li/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.jpeg" /><meta property="twitter:title" content="Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@ZhgChgLi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi"},"dateModified":"2024-04-13T16:57:38+08:00","datePublished":"2021-02-20T19:55:51+08:00","description":"Creating a daily automatic check-in script using a check-in reward app as an example","headline":"Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks","image":"https://en.zhgchg.li/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://en.zhgchg.li/posts/70a1409b149a/"},"url":"https://en.zhgchg.li/posts/70a1409b149a/"}</script><title>Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks | ZhgChgLi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi"><meta name="application-name" content="ZhgChgLi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">ZhgChgLi</a></div><div class="site-subtitle fst-italic">Live a life you will remember.</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/real/" class="nav-link"> <i class="fa-fw fa fa-camera-retro"></i> <span>REAL LIFE</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1613822151" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 20, 2021 </em> </span> <span> Updated <em class="" data-ts="1712998658" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 13, 2024 </em> </span><div class="mt-3 mb-3"> <a href="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.jpeg" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.jpeg" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3133 words" > <em>17 min</em> read</span></div></div></div><div class="post-content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><h3 id="using-pythongoogle-cloud-platformline-bot-to-automate-routine-tasks"><span class="me-2">Using Python+Google Cloud Platform+Line Bot to Automate Routine Tasks</span><a href="#using-pythongoogle-cloud-platformline-bot-to-automate-routine-tasks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Creating a daily automatic check-in script using a check-in reward app as an example</p><p><a href="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.jpeg" class="popup img-link "><img data-src="/assets/70a1409b149a/1*dFvxm6SynzYOmMEUALKJaA.jpeg" alt="Photo by [Paweł Czerwiński](https://unsplash.com/@pawel_czerwinski?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" class="lazyload" data-proofer-ignore></a></p><p>Photo by <a href="https://unsplash.com/@pawel_czerwinski?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Paweł Czerwiński</a></p><h3 id="origin"><span class="me-2">Origin</span><a href="#origin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I have always had the habit of using Python to create small tools; some are serious, like automatically crawling data and generating reports for work, and some are less serious, like scheduling automatic checks for desired information or delegating tasks that would otherwise be done manually to scripts.</p><p>When it comes to automation, I have always been quite straightforward, setting up a computer to run Python scripts continuously; the advantage is simplicity and convenience, but the downside is the need for a device connected to the internet and power. Even a Raspberry Pi consumes a small amount of electricity and internet costs, and it cannot be remotely controlled to start or stop (it actually can, but it’s cumbersome). This time, I took advantage of a work break to explore a free &amp; cloud-based method.</p><h3 id="goal"><span class="me-2">Goal</span><a href="#goal" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>Move the Python script to the cloud for execution, schedule it to run automatically, and enable it to be started/stopped via the internet.</p></blockquote><blockquote><p><em>This article uses a script I wrote for a check-in reward app as an example. The script automatically checks in daily, so I don’t have to open the app manually; it also sends me a notification upon completion.</em></p></blockquote><p><a href="/assets/70a1409b149a/1*14yKaOt2YNSMILOD_EoXLg.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*14yKaOt2YNSMILOD_EoXLg.png" alt="Completion Notification!" class="lazyload" data-proofer-ignore></a></p><p>Completion Notification!</p><h4 id="sections-in-this-article"><span class="me-2">Sections in this Article</span><a href="#sections-in-this-article" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ol><li>Using Proxyman for Man in the Middle Attack API Sniffing<li>Writing a Python script to fake app API requests (simulate check-in actions)<li>Moving the Python script to Google Cloud<li>Setting up automatic scheduling on Google Cloud</ol><ul><li>Due to the sensitive nature of this topic, this article will not disclose which check-in reward app is used. You can extend this method to your own use.<li><strong>If you are only interested in how to automate Python execution, you can skip the first part about Man in the Middle Attack API Sniffing and start from Chapter 3.</strong></ul><h4 id="tools-used"><span class="me-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><strong>Proxyman</strong>: Man in the Middle Attack API Sniffing<li><strong>Python</strong>: Writing the script<li><strong>Linebot</strong>: Sending notifications of script execution results to myself<li><strong>Google Cloud Function</strong>: Hosting the Python script<li><strong>Google Cloud Scheduler</strong>: Automatic scheduling service</ul><h3 id="1-using-proxyman-for-man-in-the-middle-attack-api-sniffing"><span class="me-2">1. Using Proxyman for Man in the Middle Attack API Sniffing</span><a href="#1-using-proxyman-for-man-in-the-middle-attack-api-sniffing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I previously wrote an article titled “<a href="../46410aaada00/">The app uses HTTPS for transmission, but the data was still stolen.</a>” The principle is similar, but this time I used Proxyman instead of mitmproxy; it’s also free but more user-friendly.</p><ul><li>Go to the official website <a href="https://proxyman.io/" target="_blank">https://proxyman.io/</a> to download the Proxyman tool<li>After downloading, start Proxyman and install the Root certificate (to perform Man in the Middle Attack and unpack HTTPS traffic content)</ul><p><a href="/assets/70a1409b149a/1*jb-FAN5h1oFVFFvu1bpYgw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*jb-FAN5h1oFVFFvu1bpYgw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>“Certificate” -&gt; “Install Certificate On this Mac” -&gt; “Installed &amp; Trusted”</p><p><strong>After installing the Root certificate on the computer, switch to the mobile:</strong></p><p>“Certificate” -&gt; “Install Certificate On iOS” -&gt; “Physical Devices…”</p><p><a href="/assets/70a1409b149a/1*DBi9YVmfoaPH9WSCoPXycA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*DBi9YVmfoaPH9WSCoPXycA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Follow the instructions to set up the Proxy on your mobile and complete the certificate installation and activation.</p><ul><li>Open the app on your mobile that you want to sniff the API transmission content for.</ul><p><a href="/assets/70a1409b149a/1*q2wbmQ3MJ6nYfjFSBHL9fw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*q2wbmQ3MJ6nYfjFSBHL9fw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>At this point, Proxyman on the Mac will show the sniffed traffic. Click on the app API domain under the device IP that you want to view; the first time you view it, you need to click “Enable only this domain” for the subsequent traffic to be unpacked.</p><p><strong>After “Enable only this domain,” you will see the newly intercepted traffic showing the original Request and Response information:</strong></p><p><a href="/assets/70a1409b149a/1*dIp1k-0u-BhJ7iTs0wEIuA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*dIp1k-0u-BhJ7iTs0wEIuA.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>We use this method to sniff which API EndPoint is called and what data is sent when performing a check-in operation on the app. Record this information and use Python to simulate the request later.</em></p></blockquote><blockquote><p><em>⚠️ Note that some app token information may change, causing the Python simulated request to fail in the future. You need to understand more about the app token exchange method.</em></p></blockquote><blockquote><p><em>⚠️ If Proxyman is confirmed to be working properly, but the app cannot make requests when Proxyman is enabled, it means the app may have SSL Pinning; currently, there is no solution, and you have to give up.</em></p></blockquote><blockquote><p><em>⚠️ App developers who want to know how to prevent sniffing can refer to <a href="../46410aaada00/">the previous article</a>.</em></p></blockquote><h4 id="assuming-we-obtained-the-following-information"><span class="me-2"><strong>Assuming we obtained the following information:</strong></span><a href="#assuming-we-obtained-the-following-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>POST /usercenter HTTP/1.1
Host: zhgchg.li
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=dafd27784f94904dd586d4ca19d8ae62
Connection: keep-alive
Accept: */*
User-Agent: (iPhone12,3;iOS 14.5)
Content-Length: 1076
Accept-Language: zh-tw
Accept-Encoding: gzip, deflate, br
AuthToken: 12345
</pre></table></code></div></div><h3 id="2-write-a-python-script-to-forge-the-app-api-request-simulate-the-check-in-action"><span class="me-2">2. Write a Python script to forge the app API request (simulate the check-in action)</span><a href="#2-write-a-python-script-to-forge-the-app-api-request-simulate-the-check-in-action" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p><em>Before writing the Python script, we can first use <a href="https://www.postman.com/" target="_blank">Postman</a> to debug the parameters and see which parameters are necessary or change over time; but you can also directly copy them.</em></p></blockquote><p><a href="/assets/70a1409b149a/1*eVF56j1oOgXeZYbkD1m22g.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*eVF56j1oOgXeZYbkD1m22g.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>checkIn.py:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"action"</span> <span class="p">:</span> <span class="s">"checkIn"</span> <span class="p">}</span>
      <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"Cookie"</span> <span class="p">:</span> <span class="s">"PHPSESSID=dafd27784f94904dd586d4ca19d8ae62"</span><span class="p">,</span> 
      <span class="s">"AuthToken"</span> <span class="p">:</span> <span class="s">"12345"</span><span class="p">,</span>
      <span class="s">"User-Agent"</span> <span class="p">:</span> <span class="s">"(iPhone12,3;iOS 14.5)"</span>
      <span class="p">}</span>
      
      <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://zhgchg.li/usercenter'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s">'status_code'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"CheckIn Success!"</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s">'message'</span><span class="p">]</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></table></code></div></div><blockquote><p><em>⚠️ <code class="language-plaintext highlighter-rouge">main(args)</code> The purpose of args will be explained later. If you want to test locally, just use <code class="language-plaintext highlighter-rouge">main(True)</code>.</em></p></blockquote><p>Using the Requests library to execute HTTP Requests, if you encounter:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ImportError: No module named requests
</pre></table></code></div></div><p>Please install the library using <code class="language-plaintext highlighter-rouge">pip install requests</code>.</p><h4 id="adding-linebot-notification-for-execution-results"><span class="me-2">Adding Linebot notification for execution results:</span><a href="#adding-linebot-notification-for-execution-results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>I made this part very simple, just for reference, and only to notify myself.</p><ul><li>Go to &amp; enable <a href="https://developers.line.biz/console/" target="_blank"><strong>Line Developers Console</strong></a><li>Create a Provider</ul><p><a href="/assets/70a1409b149a/1*XVYHKZXoHT-2qkbwRcK5Qw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*XVYHKZXoHT-2qkbwRcK5Qw.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Select “Create a Messaging API channel”</ul><p><a href="/assets/70a1409b149a/1*8l_awW31J7FlYh5EvacSmA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*8l_awW31J7FlYh5EvacSmA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Fill in the basic information in the next step and click “Create” to submit.</p><ul><li>After creation, find the “Your user ID” section under the first “Basic settings” Tab. This is your User ID.</ul><p><a href="/assets/70a1409b149a/1*JCmFicC5gXVJ6j3Vgi7CPQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*JCmFicC5gXVJ6j3Vgi7CPQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>After creation, select the “Messaging API” Tab, scan the QRCode to add the bot as a friend.</ul><p><a href="/assets/70a1409b149a/1*dOF0mHXz6z7be13zjIubTA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*dOF0mHXz6z7be13zjIubTA.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Scroll down to find the “Channel access token” section, click “Issue” to generate a token.</ul><p><a href="/assets/70a1409b149a/1*eNiyLol6nokoOKsrGp21kw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*eNiyLol6nokoOKsrGp21kw.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Copy the generated Token. With this Token, we can send messages to users.</ul><p><a href="/assets/70a1409b149a/1*LDr_vT4urUL73Z_p--yiKA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*LDr_vT4urUL73Z_p--yiKA.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>With the User ID and Token, we can send messages to ourselves.</em></p></blockquote><blockquote><p><em>Since we don’t need other functionalities, we don’t even need to install the python line sdk, just send HTTP requests directly.</em></p></blockquote><p><strong>After integrating with the previous Python script…</strong></p><p>checkIn.py:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">data</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"action"</span> <span class="p">:</span> <span class="s">"checkIn"</span> <span class="p">}</span>
      <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"Cookie"</span> <span class="p">:</span> <span class="s">"PHPSESSID=dafd27784f94904dd586d4ca19d8ae62"</span><span class="p">,</span> 
      <span class="s">"AuthToken"</span> <span class="p">:</span> <span class="s">"12345"</span><span class="p">,</span>
      <span class="s">"User-Agent"</span> <span class="p">:</span> <span class="s">"(iPhone12,3;iOS 14.5)"</span>
      <span class="p">}</span>
      
      <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://zhgchg.li/usercenter'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s">'status_code'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">sendLineNotification</span><span class="p">(</span><span class="s">"CheckIn Success!"</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">"CheckIn Success!"</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">sendLineNotification</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">'message'</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="s">'message'</span><span class="p">]</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">sendLineNotification</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
      <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
      
<span class="k">def</span> <span class="nf">sendLineNotification</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"to"</span> <span class="p">:</span> <span class="s">"Your User ID here"</span><span class="p">,</span>
        <span class="s">"messages"</span> <span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s">"type"</span> <span class="p">:</span> <span class="s">"text"</span><span class="p">,</span>
                <span class="s">"text"</span> <span class="p">:</span> <span class="n">message</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"Content-Type"</span> <span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
        <span class="s">"Authorization"</span> <span class="p">:</span> <span class="s">"Your channel access token here"</span>
    <span class="p">}</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://api.line.me/v2/bot/message/push'</span><span class="p">,</span><span class="n">json</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>Test if the notification was sent successfully:</strong></p><p><a href="/assets/70a1409b149a/1*7I7FMpQ-Gv5MKD0SWkIE0A.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*7I7FMpQ-Gv5MKD0SWkIE0A.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Success!</strong></p><blockquote><p><em>A small note, I originally wanted to use Gmail SMTP to send emails for notifications, but after uploading to Google Cloud, I found it couldn’t be used…</em></p></blockquote><h3 id="3-move-the-python-script-to-google-cloud"><span class="me-2">3. Move the Python script to Google Cloud</span><a href="#3-move-the-python-script-to-google-cloud" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After covering the basics, let’s get to the main event of this article: moving the Python script to the cloud.</p><p>Initially, I aimed for Google Cloud Run but found it too complicated and didn’t want to spend time researching it because my needs are minimal and don’t require so many features. So, <strong>I used Google Cloud Function</strong>, a serverless solution; it’s more commonly used to build serverless web services.</p><ul><li>If you haven’t used Google Cloud before, please go to the <a href="https://console.cloud.google.com/" target="_blank"><strong>Console</strong></a> to create a new project and set up billing information.<li>On the project console homepage, click “Cloud Functions” in the resources section.</ul><p><a href="/assets/70a1409b149a/1*pWDK9AQKpbDpgDltFfS9-g.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*pWDK9AQKpbDpgDltFfS9-g.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Select “Create Function” at the top.</ul><p><a href="/assets/70a1409b149a/1*ED2WPgfaSHEth3zWUJn05w.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*ED2WPgfaSHEth3zWUJn05w.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Enter basic information.</ul><p><a href="/assets/70a1409b149a/1*oetW_iIU9XywDbLZIa8tJQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*oetW_iIU9XywDbLZIa8tJQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>⚠️ Note down the “ <strong>Trigger URL</strong>“</em></p></blockquote><p><strong>Region options:</strong></p><ul><li><code class="language-plaintext highlighter-rouge">US-WEST1</code>, <code class="language-plaintext highlighter-rouge">US-CENTRAL1</code>, <code class="language-plaintext highlighter-rouge">US-EAST1</code> can enjoy free Cloud Storage service quotas.<li><code class="language-plaintext highlighter-rouge">asia-east2</code> (Hong Kong) is closer to us but requires a small Cloud Storage fee.</ul><blockquote><p><em>⚠️ Creating Cloud Functions requires Cloud Storage to store the code.</em></p></blockquote><blockquote><p><em>⚠️ For detailed pricing, please refer to the end of the article.</em></p></blockquote><p><strong>Trigger type:</strong> HTTP</p><p><strong>Authentication:</strong> Depending on your needs, I want to be able to execute the script from an external link, so I choose “Allow unauthenticated invocations”; if you choose to require authentication, the Scheduler service will also need corresponding settings.</p><p><strong>Variables, network, and advanced settings can be set in the variables section for Python to use (this way, if parameters change, you don’t need to modify the Python code):</strong></p><p><a href="/assets/70a1409b149a/1*qJC7rcjOnSeKWa8NiYxbpQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*qJC7rcjOnSeKWa8NiYxbpQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>How to call in Python:</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'test'</span><span class="p">,</span> <span class="s">'DEFAULT VALUE'</span><span class="p">)</span>
</pre></table></code></div></div><p>No need to change other settings, just “Save” -&gt; “Next”.</p><ul><li>Select “Python 3.x” as the runtime and paste the written Python script, changing the entry point to “main”.</ul><p><a href="/assets/70a1409b149a/1*zCK21j82QwsHD1nARuZkBw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*zCK21j82QwsHD1nARuZkBw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Supplement main(args)</strong>, as mentioned earlier, this service is more used for serverless web; so args are actually Request objects, from which you can get http get query and http post body data, as follows:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Get GET Query information:
request_args = args.args
</pre></table></code></div></div><p>example: ?name=zhgchgli =&gt; request_args = [“name”:”zhgchgli”]</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Get POST Body data:
request_json = request.get_json(silent=True)
</pre></table></code></div></div><p>example: name=zhgchgli =&gt; request_json = [“name”:”zhgchgli”]</p><p><strong>If testing POST with Postman, remember to use “Raw+JSON” POST data, otherwise, nothing will be received:</strong></p><p><a href="/assets/70a1409b149a/1*jl5joofEWPMLR3JuP988BQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*jl5joofEWPMLR3JuP988BQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>After the code part is OK, switch to “requirements.txt” and enter the dependencies used:</ul><p><a href="/assets/70a1409b149a/1*2MTOKWDWlXbfjYP1qgp7Sw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*2MTOKWDWlXbfjYP1qgp7Sw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>We use the “requests” package to help us make API calls, which is not in the native Python library; so we need to add it here:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>requests&gt;=2.25.1
</pre></table></code></div></div><p>Here is the translated Markdown content:</p><hr /><p>Specify version ≥ 2.25.1 here, or just enter <code class="language-plaintext highlighter-rouge">requests</code> to install the latest version.</p><ul><li>Once everything is OK, click “Deploy” to start the deployment.</ul><p><a href="/assets/70a1409b149a/1*eQvtozhghRLQhxUgE9fMhw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*eQvtozhghRLQhxUgE9fMhw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>It takes about 1-3 minutes to complete the deployment.</p><ul><li>After the deployment is complete, you can go to the “ <strong>Trigger URL</strong> “ noted earlier to check if it is running correctly, or use “Actions” -&gt; “Test Function” to test it.</ul><p><a href="/assets/70a1409b149a/1*yv1wMHELWSrXiEvE44c9Sw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*yv1wMHELWSrXiEvE44c9Sw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>If <code class="language-plaintext highlighter-rouge">500 Internal Server Error</code> appears, it means there is an error in the program. You can click the name to view the “Logs” and find the reason:</p><p><a href="/assets/70a1409b149a/1*DeiRZT3wC1Z7Jv4WIRaM_Q.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*DeiRZT3wC1Z7Jv4WIRaM_Q.png" alt="" class="lazyload" data-proofer-ignore></a></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>UnboundLocalError: local variable 'db' referenced before assignment
</pre></table></code></div></div><ul><li>After clicking the name, you can also click “Edit” to modify the script content.</ul><p><a href="/assets/70a1409b149a/1*KqwYbY826bdVaSIlHUnpbA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*KqwYbY826bdVaSIlHUnpbA.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><strong><em>If the test is fine, it’s done! We have successfully moved the Python script to the cloud.</em></strong></p></blockquote><h4 id="additional-information-about-variables"><span class="me-2">Additional Information about Variables</span><a href="#additional-information-about-variables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>According to our needs, we need a place to store and read the token of the check-in APP; because the token may expire, it needs to be re-requested and written for use in the next execution.</p><p>To dynamically pass variables from the outside to the script, the following methods are available:</p><ul><li>[Read Only] As mentioned earlier, runtime environment variables<li>[Temp] Cloud Functions provides a /tmp directory for writing and reading files during execution, but it will be deleted after completion. For details, please refer to the <a href="https://cloud.google.com/functions/docs/concepts/exec#file_system" target="_blank">official documentation</a>.<li>[Read Only] GET/POST data transmission<li>[Read Only] Include additional files</ul><p><a href="/assets/70a1409b149a/1*AAXUcDRZNnRAqIFj02RnyA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*AAXUcDRZNnRAqIFj02RnyA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>In the program, using the relative path <code class="language-plaintext highlighter-rouge">./</code> can read it, <strong>only read, cannot dynamically modify</strong>; to modify, you can only do it in the console and redeploy.</p><blockquote><p><em>To read and dynamically modify, you need to connect to other GCP services, such as: Cloud SQL, Google Storage, Firebase Cloud Firestore…</em></p></blockquote><ul><li>[Read &amp; Write] Here I choose Firebase Cloud <em>Firestore</em> because it currently has a free quota for use.</ul><p><strong>According to the <a href="https://firebase.google.com/docs/firestore/quickstart#read_data" target="_blank">Getting Started Guide</a>, after creating the Firebase project, enter the Firebase console:</strong></p><p><a href="/assets/70a1409b149a/1*0DO31noJ4a3xweb1annbSQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*0DO31noJ4a3xweb1annbSQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Find “ <strong>Cloud Firestore</strong> “ in the left menu -&gt; “ <strong>Add Collection</strong> “</p><p><a href="/assets/70a1409b149a/1*7c9sA8ZbxE6uGh6f-nfiVA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*7c9sA8ZbxE6uGh6f-nfiVA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Enter the collection ID.</p><p><a href="/assets/70a1409b149a/1*wcp94_25maNL9EoFJTOndA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*wcp94_25maNL9EoFJTOndA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Enter the data content.</p><p>A collection can have multiple documents, and each document can have its own field content; it is very flexible to use.</p><p><strong>In Python:</strong></p><p>First, go to <a href="https://console.cloud.google.com/iam-admin/serviceaccounts" target="_blank">GCP Console -&gt; IAM &amp; Admin -&gt; Service Accounts</a>, and follow the steps below to download the authentication private key file:</p><p>First, select the account:</p><p><a href="/assets/70a1409b149a/1*JeB9m4BWzfRCZSofHq2tLg.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*JeB9m4BWzfRCZSofHq2tLg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Below, “Add Key” -&gt; “Create New Key”</p><p><a href="/assets/70a1409b149a/1*xi9nQUy48-QlFI4BEdIMew.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*xi9nQUy48-QlFI4BEdIMew.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Select “JSON” to download the file.</p><p><a href="/assets/70a1409b149a/1*bsphvdEHgg0XDnHAHMXJvg.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*bsphvdEHgg0XDnHAHMXJvg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Place this JSON file in the same directory as the Python project.</p><p><strong>In the local development environment:</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip <span class="nb">install</span> <span class="nt">--upgrade</span> firebase-admin
</pre></table></code></div></div><p>Install the firebase-admin package.</p><p>In Cloud Functions, add <code class="language-plaintext highlighter-rouge">firebase-admin</code> to <code class="language-plaintext highlighter-rouge">requirements.txt</code>.</p><p><a href="/assets/70a1409b149a/1*d67oTblFFKaBHkGC77Mapw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*d67oTblFFKaBHkGC77Mapw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Once the environment is set up, we can read the data we just added:</p><p>firebase_admin.py:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">firebase_admin</span>
<span class="kn">from</span> <span class="nn">firebase_admin</span> <span class="kn">import</span> <span class="n">credentials</span>
<span class="kn">from</span> <span class="nn">firebase_admin</span> <span class="kn">import</span> <span class="n">firestore</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">firebase_admin</span><span class="p">.</span><span class="n">_apps</span><span class="p">:</span>
  <span class="n">cred</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">.</span><span class="n">Certificate</span><span class="p">(</span><span class="s">'./authentication.json'</span><span class="p">)</span>
  <span class="n">firebase_admin</span><span class="p">.</span><span class="n">initialize_app</span><span class="p">(</span><span class="n">cred</span><span class="p">)</span>
<span class="c1"># Because initializing the app multiple times will cause the following error
# providing an app name as the second argument. In most cases you only need to call initialize_app() once. But if you do want to initialize multiple apps, pass a second argument to initialize_app() to give each app a unique name.
# So to be safe, check if it is already initialized before calling initialize_app
</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">firestore</span><span class="p">.</span><span class="n">client</span><span class="p">()</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">collection</span><span class="p">(</span><span class="sa">u</span><span class="s">'example'</span><span class="p">)</span> <span class="o">//</span> <span class="n">Collection</span> <span class="n">name</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">ref</span><span class="p">.</span><span class="n">stream</span><span class="p">()</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"id:"</span><span class="o">+</span><span class="n">data</span><span class="p">.</span><span class="nb">id</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">data</span><span class="p">.</span><span class="n">to_dict</span><span class="p">())</span>
</pre></table></code></div></div><blockquote><p><em>If you are on Cloud Functions, you can either upload the authentication JSON file together or change the connection syntax as follows:</em></p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">cred</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">.</span><span class="n">ApplicationDefault</span><span class="p">()</span>
<span class="n">firebase_admin</span><span class="p">.</span><span class="n">initialize_app</span><span class="p">(</span><span class="n">cred</span><span class="p">,</span> <span class="p">{</span>
  <span class="s">'projectId'</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">firestore</span><span class="p">.</span><span class="n">client</span><span class="p">()</span>
</pre></table></code></div></div><blockquote><p><em>If you encounter <code class="language-plaintext highlighter-rouge">Failed to initialize a certificate credential.</code>, please check if the authentication JSON is correct.</em></p></blockquote><p>For more operations like adding or deleting, please refer to the <a href="https://firebase.google.com/docs/firestore/manage-data/add-data" target="_blank">official documentation</a>.</p><h3 id="4-set-up-automatic-scheduling-in-google-cloud"><span class="me-2">4. Set up automatic scheduling in Google Cloud</span><a href="#4-set-up-automatic-scheduling-in-google-cloud" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After having the script, the next step is to make it run automatically to achieve our final goal.</p><ul><li>Go to the <a href="https://console.cloud.google.com/cloudscheduler/" target="_blank"><strong>Google Cloud Scheduler</strong></a> console homepage<li>Click “Create Job” at the top</ul><p><a href="/assets/70a1409b149a/1*5tNybi2HssmWoyJDQyPSJQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*5tNybi2HssmWoyJDQyPSJQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Enter the basic job information</ul><p><a href="/assets/70a1409b149a/1*yqkJnt9PVYEllOpDtK1RmQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*yqkJnt9PVYEllOpDtK1RmQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Execution frequency:</strong> Same as crontab input method. If you are not familiar with crontab syntax, you can directly use <a href="https://crontab.guru/#15_1_*_*_*" target="_blank"><strong>crontab.guru this amazing website</strong></a>:</p><p><a href="/assets/70a1409b149a/1*xnZBlcsMrQVJc6ewJIfAxA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*xnZBlcsMrQVJc6ewJIfAxA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>It can clearly translate the actual meaning of the syntax you set. (Click <strong>next</strong> to see the next execution time)</p><blockquote><p><em>Here I set <code class="language-plaintext highlighter-rouge">15 1 * * *</code>, because the check-in only needs to be executed once a day, set to execute at 1:15 AM every day.</em></p></blockquote><p><strong>URL part:</strong> Enter the “ <strong>trigger URL</strong> “ noted earlier</p><p><strong>Time zone:</strong> Enter “Taiwan”, select Taipei Standard Time</p><p><strong>HTTP method:</strong> According to the previous Python code, we use Get</p><p><strong>If you set “authentication” earlier</strong> remember to expand “SHOW MORE” to set up authentication.</p><p><strong>After filling everything out</strong>, press “ <strong>Create</strong> “.</p><ul><li>After successful creation, you can choose “Run Now” to test if it works properly.</ul><p><a href="/assets/70a1409b149a/1*H_nsZNQ16iIKwThQpGJDmA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*H_nsZNQ16iIKwThQpGJDmA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/70a1409b149a/1*X6pL0J4hGL_KodhsppvsJg.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*X6pL0J4hGL_KodhsppvsJg.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>You can view the execution results and the last execution date</ul><p><a href="/assets/70a1409b149a/1*pUqTo-NM1z-srXbq1BM4rA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*pUqTo-NM1z-srXbq1BM4rA.png" alt="" class="lazyload" data-proofer-ignore></a></p><blockquote><p><em>⚠️ <strong>Please note that the execution result “failure” only refers to web status codes 400~500 or errors in the Python program.</strong></em></p></blockquote><h3 id="all-done"><span class="me-2">All Done!</span><a href="#all-done" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We have achieved the goal of uploading the routine task Python script to the cloud and setting it to run automatically.</p><h3 id="pricing"><span class="me-2">Pricing</span><a href="#pricing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Another very important part is the pricing; Google Cloud and Linebot are not completely free services, so understanding the pricing is crucial. Otherwise, for a small script, paying too much money might not be worth it compared to just running it on a computer.</p><h4 id="linebot"><span class="me-2">Linebot</span><a href="#linebot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*cfuKJxNoW4tvCEhqdC7oIQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*cfuKJxNoW4tvCEhqdC7oIQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the <a href="https://tw.linebiz.com/service/account-solutions/line-official-account/" target="_blank">official pricing</a> information, which is free for up to 500 messages per month.</p><h4 id="google-cloud-functions"><span class="me-2">Google Cloud Functions</span><a href="#google-cloud-functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*2431d2F1BNtEJUg845uDQg.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*2431d2F1BNtEJUg845uDQg.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the <a href="https://cloud.google.com/functions/pricing?hl=zh-tw" target="_blank">official pricing</a> information, which includes 2 million invocations, 400,000 GB-seconds, 200,000 GHz-seconds of compute time, and 5 GB of internet egress per month.</p><h4 id="google-firebase-cloud-firestore"><span class="me-2">Google Firebase Cloud Firestore</span><a href="#google-firebase-cloud-firestore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*2t1boe9DQX1NBgGyYTrVnA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*2t1boe9DQX1NBgGyYTrVnA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the <a href="https://firebase.google.com/docs/firestore/quotas" target="_blank">official pricing</a> information, which includes 1 GB of storage, 10 GB of data transfer per month, 50,000 reads per day, and 20,000 writes/deletes per day; sufficient for light usage!</p><h4 id="google-cloud-scheduler"><span class="me-2">Google Cloud Scheduler</span><a href="#google-cloud-scheduler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/70a1409b149a/1*b9cvGpPqjKRFHa-45Yuzdw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*b9cvGpPqjKRFHa-45Yuzdw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the <a href="https://cloud.google.com/scheduler/pricing?hl=zh-tw" target="_blank">official pricing</a> information, which allows 3 free jobs per account.</p><blockquote><p>The above free quotas are more than enough for the script!</p></blockquote><h4 id="google-cloud-storage-conditional-free-usage"><span class="me-2">Google Cloud Storage Conditional Free Usage</span><a href="#google-cloud-storage-conditional-free-usage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Despite all efforts, some services might still incur charges.</p><p>After creating Cloud Functions, two Cloud Storage instances will be automatically created:</p><p><a href="/assets/70a1409b149a/1*OvWXsZbwnM8sNfvdtDAIOA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*OvWXsZbwnM8sNfvdtDAIOA.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>If you chose US-WEST1, US-CENTRAL1, or US-EAST1 for Cloud Functions, you can enjoy free usage quotas:</p><p><a href="/assets/70a1409b149a/1*arevMQGpsIumGlw_PE-hQQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*arevMQGpsIumGlw_PE-hQQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>I chose US-CENTRAL1, and you can see that the first Cloud Storage instance is indeed in US-CENTRAL1, but the second one is labeled <strong>Multiple regions in the US</strong>; <strong>I estimate this one will incur charges</strong>.</p><p><a href="/assets/70a1409b149a/1*kuX9HlPTfMxbEg-sa3rJOQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*kuX9HlPTfMxbEg-sa3rJOQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Refer to the <a href="https://cloud.google.com/storage/pricing?hl=zh-tw" target="_blank">official pricing</a> information, which varies by region.</p><p>The code isn’t large, so I estimate the minimum charge will be around 0.0X0 per month (?)</p><blockquote><p><em>⚠️ The above information was recorded on 2021/02/21, and the actual prices may vary. This is for reference only.</em></p></blockquote><h4 id="budget-control-notifications"><span class="me-2">Budget Control Notifications</span><a href="#budget-control-notifications" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Just in case… if the usage exceeds the free quota and starts incurring charges, I want to receive notifications to avoid unexpectedly high bills due to program errors.</p><ul><li>Go to the <a href="https://console.cloud.google.com/" target="_blank"><strong>Console</strong></a><li>Find the “ <strong>Billing</strong> “ Card:</ul><p><a href="/assets/70a1409b149a/1*r0T8gZsaWroxhWxIxKwRWQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*r0T8gZsaWroxhWxIxKwRWQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click “<strong>View Detailed Deduction Records</strong>” to enter.</p><ul><li>Expand the left menu and enter the “<strong>Budget and Alerts</strong>” feature.</ul><p><a href="/assets/70a1409b149a/1*GtT4Sj9Q19O_QxWTWgM5UA.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*GtT4Sj9Q19O_QxWTWgM5UA.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Click on the top “<strong>Set Budget</strong>”</ul><p><a href="/assets/70a1409b149a/1*ytmGKw4sy6b-U3XAeI_geQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*ytmGKw4sy6b-U3XAeI_geQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><ul><li>Enter a custom name</ul><p><a href="/assets/70a1409b149a/1*_qgQMB_WsCuoxtJ4vA6xgw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*_qgQMB_WsCuoxtJ4vA6xgw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Next step.</p><ul><li>Amount, enter “<strong>Target Amount</strong>”, you can enter $1, $10; we don’t want to spend too much on small things.</ul><p><a href="/assets/70a1409b149a/1*y6fIpzReQxZZRsVpZIk-tw.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*y6fIpzReQxZZRsVpZIk-tw.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Next step.</p><p>Here you can set the action to trigger a notification when the budget reaches a certain percentage.</p><p><a href="/assets/70a1409b149a/1*y4B62yjPWAy1pBQhZmiySQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*y4B62yjPWAy1pBQhZmiySQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><strong>Check</strong> “<strong>Send alerts to billing administrators and users via email</strong>”, so that when the condition is triggered, you will receive a notification immediately.</p><p><a href="/assets/70a1409b149a/1*PTQDG_Uffa8fvHxaeYCnrQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*PTQDG_Uffa8fvHxaeYCnrQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Click “Finish” to submit and save.</p><p><a href="/assets/70a1409b149a/1*QWH-bIlQAC7hhc4SVQOI5g.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*QWH-bIlQAC7hhc4SVQOI5g.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/70a1409b149a/1*-BAHV1lovaYgblnCCubmSQ.png" class="popup img-link "><img data-src="/assets/70a1409b149a/1*-BAHV1lovaYgblnCCubmSQ.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>When the budget is exceeded, we can know immediately to avoid incurring more costs.</p><h3 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Human energy is limited. In today’s flood of technological information, every platform and service wants to extract our limited energy. If we can use some automated scripts to share our daily lives, we can save more energy to focus on important things!</p><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="../d61062833c1a/">Slack builds a fully automated WFH employee health status reporting system</a><li><a href="../e77b80cc6f89/">Crashlytics + Big Query to create a more real-time and convenient crash tracking tool</a><li><a href="../793cb8f89b72/">Crashlytics + Google Analytics automatically query App Crash-Free Users Rate</a><li><a href="../46410aaada00/">The app uses HTTPS transmission, but the data is still stolen.</a><li><a href="../729d7b6817a4/">How to create an interesting engineering CTF competition</a><li><a href="../8a04443024e2/">iOS 14 clipboard data theft panic, the dilemma of privacy and convenience</a><li><a href="../d414bdbdb8c9/">Use Google Apps Script to forward Gmail messages to Slack</a></ul><p>If you have any questions or comments, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a>.</p><p>If you have any automation-related optimization needs, feel free to <a href="https://www.zhgchg.li/contact" target="_blank">commission me</a>. Thank you.</p><p>===</p><p><a href="https://zhgchg.li/posts/70a1409b149a/" target="_blank">本文中文版本</a></p><p>===</p><p>This article was first published in Traditional Chinese on Medium ➡️ <a href="https://medium.com/p/70a1409b149a" target="_blank"><strong>View Here</strong></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script></div><hr/> <a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer!&emoji=🍺&slug=zhgchgli&button_colour=FFDD00&font_colour=000000&font_family=Bree&outline_colour=000000&coffee_colour=ffffff" class="lazyload" data-proofer-ignore></a> <br/> <a href="https://medium.com/@zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="/assets/images/followmymedium.png" class="lazyload" data-proofer-ignore></a> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3184248473087645" data-ad-slot="7555148040"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/zrealm/'>ZRealm</a>, <a href='/categories/dev/'>Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/google-cloud-platform/" class="post-tag no-text-decoration" >google-cloud-platform</a> <a href="/tags/cloud-functions/" class="post-tag no-text-decoration" >cloud-functions</a> <a href="/tags/cloud-scheduler/" class="post-tag no-text-decoration" >cloud-scheduler</a> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Using%20Python+Google%20Cloud%20Platform+Line%20Bot%20to%20Automate%20Routine%20Tasks%20-%20ZhgChgLi&url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2F70a1409b149a%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Using%20Python+Google%20Cloud%20Platform+Line%20Bot%20to%20Automate%20Routine%20Tasks%20-%20ZhgChgLi&u=https%3A%2F%2Fen.zhgchg.li%2Fposts%2F70a1409b149a%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2F70a1409b149a%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/d9a95d4224ea/">Medium Custom Domain Feature Returns</a><li class="text-truncate lh-lg"> <a href="/posts/483af5d93297/">Custom Domain Tutorial for Github Pages</a><li class="text-truncate lh-lg"> <a href="/posts/9e43897d99fc/">Behavior Change in Merging NSAttributedString Attributes Range in iOS ≥ 18</a><li class="text-truncate lh-lg"> <a href="/posts/b08ef940c196/">iOS Deferred Deep Link Implementation (Swift)</a><li class="text-truncate lh-lg"> <a href="/posts/12c5026da33d/">What's New with Universal Links</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/bd94cc88f9c9/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1708089421" data-df="ll" > Feb 16, 2024 </em><h4 class="pt-0 my-2" data-toc-skip>Slack & ChatGPT Integration</h4><div class="text-muted small"><p> Slack &amp;amp; ChatGPT Integration Build your own ChatGPT OpenAI API for Slack App (Google Cloud Functions &amp;amp; Python) Background Recently, I have been promoting the use of Generative AI within t...</p></div></div></a></div><div class="col"> <a href="/posts/9659db1357e4/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1616519374" data-df="ll" > Mar 24, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>Quickly Build a Testable API Service Using Firebase Firestore + Functions</h4><div class="text-muted small"><p> Quickly Build a Testable API Service Using Firebase Firestore + Functions When push notification statistics meet Firebase Firestore + Functions Photo by Carlos Muza Introduction Accurate Push N...</p></div></div></a></div><div class="col"> <a href="/posts/b04f4fba3cf2/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1715703645" data-df="ll" > May 15, 2024 </em><h4 class="pt-0 my-2" data-toc-skip>What Can Be Done to Commemorate When an App Product Reaches Its End?</h4><div class="text-muted small"><p> What Can Be Done to Commemorate When an App Product Reaches Its End? Using mitmproxy + apple configurator to keep an App in its pre-removal state forever Introduction Jujutsu Kaisen After wor...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/87090f101b9a/" class="btn btn-outline-primary" prompt="Older" ><p>Reinstallation Note 1 - Laravel Homestead + phpMyAdmin Environment Setup</p></a> <a href="/posts/142244e5f07a/" class="btn btn-outline-primary" prompt="Newer" ><p>Revealing a Clever Website Vulnerability Discovered Years Ago</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> <br/> <a href="https://zhgchg.li" target="_blank">中文版網站</a><br/> Powered by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</p><p>© 2024 <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-JSGN97L56L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-JSGN97L56L'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
