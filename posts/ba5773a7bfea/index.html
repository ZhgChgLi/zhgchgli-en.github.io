<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Visitor Pattern in iOS (Swift)" /><meta name="author" content="ZhgChgLi" /><meta property="og:locale" content="en" /><meta name="description" content="Analysis of the Practical Application Scenarios of the Design Pattern Visitor in iOS Development" /><meta property="og:description" content="Analysis of the Practical Application Scenarios of the Design Pattern Visitor in iOS Development" /><link rel="canonical" href="https://en.zhgchg.li/posts/ba5773a7bfea/" /><meta property="og:url" content="https://en.zhgchg.li/posts/ba5773a7bfea/" /><meta property="og:site_name" content="ZhgChgLi" /><meta property="og:image" content="https://en.zhgchg.li/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-15T23:58:36+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://en.zhgchg.li/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.jpeg" /><meta property="twitter:title" content="Visitor Pattern in iOS (Swift)" /><meta name="twitter:site" content="@zhgchgli" /><meta name="twitter:creator" content="@ZhgChgLi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"ZhgChgLi"},"dateModified":"2024-09-06T13:58:52+08:00","datePublished":"2021-06-15T23:58:36+08:00","description":"Analysis of the Practical Application Scenarios of the Design Pattern Visitor in iOS Development","headline":"Visitor Pattern in iOS (Swift)","image":"https://en.zhgchg.li/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://en.zhgchg.li/posts/ba5773a7bfea/"},"url":"https://en.zhgchg.li/posts/ba5773a7bfea/"}</script><title>Visitor Pattern in iOS (Swift) | ZhgChgLi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ZhgChgLi"><meta name="application-name" content="ZhgChgLi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/images/zhgchgli.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">ZhgChgLi</a></div><div class="site-subtitle fst-italic">Live a life you will remember.</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/real/" class="nav-link"> <i class="fa-fw fa fa-camera-retro"></i> <span>REAL LIFE</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fa fa-envelope-open"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://link.zhgchg.li" aria-label="link" target="_blank" rel="noopener noreferrer" > <i class="fas fa-link"></i> </a> <a href="https://www.linkedin.com/in/zhgchgli" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['zhgchgli','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Visitor Pattern in iOS (Swift)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Visitor Pattern in iOS (Swift)</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1623772716" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 15, 2021 </em> </span> <span> Updated <em class="" data-ts="1725602332" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 6, 2024 </em> </span><div class="mt-3 mb-3"> <a href="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.jpeg" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.jpeg" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1747 words" > <em>9 min</em> read</span></div></div></div><div class="post-content"> <widgetic id="64ce7263ecb2a197598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script><h3 id="visitor-pattern-in-swift-share-object-to-xxx-example"><span class="me-2">Visitor Pattern in Swift (Share Object to XXX Example)</span><a href="#visitor-pattern-in-swift-share-object-to-xxx-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Analysis of the practical application scenarios of the Visitor Pattern (sharing items like products, songs, articles… to Facebook, Line, Linkedin, etc.)</p><p><a href="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.jpeg" class="popup img-link "><img data-src="/assets/ba5773a7bfea/1*Q1BLU8QHVBLEMx6KlMSHWQ.jpeg" alt="Photo by [Daniel McCullough](https://unsplash.com/@d_mccullough?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText){:target=&quot;_blank&quot;}" class="lazyload" data-proofer-ignore></a></p><p>Photo by <a href="https://unsplash.com/@d_mccullough?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank">Daniel McCullough</a></p><h4 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>From knowing about the existence of “Design Patterns” to now, it has been over 10 years, and I still can’t confidently say that I have mastered them completely. I have always been somewhat confused, and I have gone through all the patterns several times from start to finish, but if I don’t internalize them and apply them in practice, I quickly forget.</p><blockquote><p><em>I am truly useless.</em></p></blockquote><h4 id="internal-strength-and-techniques"><span class="me-2">Internal Strength and Techniques</span><a href="#internal-strength-and-techniques" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>I once saw a very good analogy: the techniques part, such as PHP, Laravel, iOS, Swift, SwiftUI, etc., are relatively easy to switch between for learning, but the internal strength part, such as algorithms, data structures, design patterns, etc., are considered internal strength. There is a complementary effect between internal strength and techniques. Techniques are easy to learn, but internal strength is difficult to cultivate. Someone with excellent techniques may not have excellent internal strength, while someone with excellent internal strength can quickly learn techniques. Therefore, rather than saying they complement each other, it is better to say that internal strength is the foundation, and techniques complement it to achieve great success.</p><h4 id="find-your-suitable-learning-method"><span class="me-2">Find Your Suitable Learning Method</span><a href="#find-your-suitable-learning-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Based on my previous learning experiences, I believe that the learning method of Design Patterns that suits me best is to focus on mastering a few patterns first, internalize and flexibly apply them, develop a sense of judgment to determine which scenarios are suitable and which are not, and then gradually accumulate new patterns until mastering all of them. I think the best way is to find practical scenarios to learn from applications.</p><h4 id="learning-resources"><span class="me-2">Learning Resources</span><a href="#learning-resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>I recommend two free learning resources:</p><ul><li><a href="https://refactoringguru.cn/" target="_blank">https://refactoringguru.cn/</a>: Provides a complete introduction to all pattern structures, scenarios, and relationships.<li><a href="https://shirazian.wordpress.com/2016/04/11/design-patterns-in-swift/" target="_blank">https://shirazian.wordpress.com/2016/04/11/design-patterns-in-swift/</a>: The author introduces the application of various patterns in iOS development based on practical scenarios, and this article will also be written in this direction.</ul><h3 id="visitor--behavioral-patterns"><span class="me-2">Visitor — Behavioral Patterns</span><a href="#visitor--behavioral-patterns" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The first chapter documents the Visitor Pattern, which is one of the gold mines I dug up during my year at StreetVoice, where Visitor was widely used to solve architectural problems in the StreetVoice App. I also grasped the essence of Visitor during this experience, so let’s start with it in the first chapter!</p><h4 id="what-is-visitor"><span class="me-2">What is Visitor</span><a href="#what-is-visitor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, please understand what Visitor is? What problems does it solve? What is its structure?</p><p><a href="/assets/ba5773a7bfea/1*rbswlsges8_oS3pNI1-WKA.png" class="popup img-link "><img data-src="/assets/ba5773a7bfea/1*rbswlsges8_oS3pNI1-WKA.png" alt="Image from [refactoringguru](https://refactoringguru.cn/design-patterns/visitor){:target=&quot;_blank&quot;}" class="lazyload" data-proofer-ignore></a></p><p>The image is from <a href="https://refactoringguru.cn/design-patterns/visitor" target="_blank">refactoringguru</a>.</p><p>The detailed content is not repeated here. Please refer directly to <a href="https://refactoringguru.cn/design-patterns/visitor" target="_blank">refactoringguru’s explanation of Visitor</a> first.</p><h3 id="practical-ios-scenario---sharing-feature"><span class="me-2">Practical iOS Scenario - Sharing Feature</span><a href="#practical-ios-scenario---sharing-feature" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Assuming today we have the following models: UserModel, SongModel, PlaylistModel. Now we need to implement a sharing feature that can share to: Facebook, Line, Instagram, these three platforms. The sharing message to be displayed for each model is different, and each platform requires different data:</p><p><a href="/assets/ba5773a7bfea/1*ad2ijo5Bvm9_wnM1g2LNog.png" class="popup img-link "><img data-src="/assets/ba5773a7bfea/1*ad2ijo5Bvm9_wnM1g2LNog.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>The combination scenario is as shown in the above image. The first table shows the customized content of each model, and the second table shows the data required by each sharing platform.</p><blockquote><p><strong><em>Especially when sharing a Playlist on Instagram, multiple images are required, which is different from the source required for other sharing platforms.</em></strong></p></blockquote><h4 id="define-models"><span class="me-2">Define Models</span><a href="#define-models" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First, define the properties of each model:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c1">// Model</span>
<span class="kd">struct</span> <span class="kt">UserModel</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">SongModel</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span>
    <span class="k">let</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">PlaylistModel</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span>
    <span class="k">let</span> <span class="nv">songs</span><span class="p">:</span> <span class="p">[</span><span class="kt">SongModel</span><span class="p">]</span>
    <span class="k">let</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>

<span class="c1">// Data</span>

<span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">song</span> <span class="o">=</span> <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
                     <span class="nv">name</span><span class="p">:</span> <span class="s">"Wake me up"</span><span class="p">,</span>
                     <span class="nv">user</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span>
                     <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/1.png"</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">playlist</span> <span class="o">=</span> <span class="kt">PlaylistModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span>
                            <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii Tribute Concert"</span><span class="p">,</span>
                            <span class="nv">user</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span>
                            <span class="nv">songs</span><span class="p">:</span> <span class="p">[</span>
                                <span class="n">song</span><span class="p">,</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"2"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Waiting for love"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/3.png"</span><span class="p">),</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"3"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Lonely Together"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/1.png"</span><span class="p">),</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"4"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Heaven"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/4.png"</span><span class="p">),</span>
                                <span class="kt">SongModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"5"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"S.O.S"</span><span class="p">,</span> <span class="nv">user</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Avicii"</span><span class="p">,</span> <span class="nv">profileImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/profile/1.png"</span><span class="p">),</span> <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/cover/5.png"</span><span class="p">)],</span>
                            <span class="nv">coverImageURLString</span><span class="p">:</span> <span class="s">"https://zhgchg.li/playlist/1.png"</span><span class="p">)</span>
</pre></table></code></div></div><h4 id="doing-nothing-approach"><span class="me-2">Doing Nothing Approach</span><a href="#doing-nothing-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Do not translate the content as it is already in English.</p><p>We have extracted a CanShare Protocol, any Model that follows this protocol can support sharing; the sharing part is also abstracted into ShareManagerProtocol. Implementing the protocol content for new sharing will not affect other ShareManagers.</p><p>However, getShareImageURLStrings is still strange. Additionally, assuming that the data for the Model requirements of a newly added sharing platform are vastly different, such as WeChat sharing requiring playback counts, creation dates, etc., and only it needs them, things will start to get messy.</p><h4 id="visitor"><span class="me-2">Visitor</span><a href="#visitor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Solution using the Visitor Pattern.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
</pre><td class="rouge-code"><pre><span class="c1">// Visitor Version</span>
<span class="kd">protocol</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">UserModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">SongModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">PlaylistModel</span><span class="p">:</span> <span class="kt">Shareable</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SharePolicy</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">ShareToFacebookVisitor</span><span class="p">:</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Facebook share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![Hi sharing a great artist </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">profileImageURLString</span><span class="se">)</span><span class="s">](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Facebook share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![Hi sharing a great song just heard, </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">'s </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">, played by him.](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="se">)</span><span class="s">)](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/song/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Facebook share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Facebook..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[![Hi can't stop listening to this playlist </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="se">)</span><span class="s">)](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/playlist/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">ShareToLineVisitor</span><span class="p">:</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Line share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[Hi sharing a great artist </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Line share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[Hi sharing a great song just heard, </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">'s </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">, played by him.](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/song/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Line share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Line..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"[Hi can't stop listening to this playlist </span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="se">)</span><span class="s">.](https://zhgchg.li/user/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">/playlist/</span><span class="se">\(</span><span class="n">model</span><span class="o">.</span><span class="n">id</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">ShareToInstagramVisitor</span><span class="p">:</span> <span class="kt">SharePolicy</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Instagram share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">profileImageURLString</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Instagram share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coverImageURLString</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// call Instagram share sdk...</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"Share to Instagram..."</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">songs</span><span class="o">.</span><span class="nf">map</span><span class="p">({</span> <span class="nv">$0</span><span class="o">.</span><span class="n">coverImageURLString</span> <span class="p">})</span><span class="o">.</span><span class="nf">joined</span><span class="p">(</span><span class="nv">separator</span><span class="p">:</span> <span class="s">","</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Use case</span>
<span class="k">let</span> <span class="nv">shareToInstagramVisitor</span> <span class="o">=</span> <span class="kt">ShareToInstagramVisitor</span><span class="p">()</span>
<span class="n">user</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">shareToInstagramVisitor</span><span class="p">)</span>
<span class="n">playlist</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="n">shareToInstagramVisitor</span><span class="p">)</span>
</pre></table></code></div></div><p>Let’s see what we did line by line:</p><ul><li>First, we created a Shareable Protocol, which is just for us to manage models that support sharing with a unified interface for visitors (undefined is also acceptable).<li>UserModel/SongModel/PlaylistModel implement Shareable <code class="language-plaintext highlighter-rouge">func accept(visitor: SharePolicy)</code>, so if we add a new model that supports sharing, it only needs to implement the protocol.<li>Define SharePolicy to list the supported models (must be concrete type). You might wonder why not define it as <code class="language-plaintext highlighter-rouge">visit(model: Shareable)</code>. If we do that, we will repeat the issues from the previous version.<li>Implement SharePolicy for each Share method, combining the required resources based on the source.<li>Suppose today we have a new WeChat sharing feature that requires special data (play count, creation date). It won’t affect the existing code because it can retrieve the information it needs from concrete models.</ul><p>Achieving the goal of low coupling and high cohesion in software development.</p><p>The above is the classic <a href="https://refactoringguru.com/design-patterns/visitor-double-dispatch">Visitor Double Dispatch</a> implementation. However, we rarely encounter this situation in our daily development. In general, we may only have one visitor, but I think it is also suitable to use this pattern for composition. For example, if we have a SaveToCoreData requirement today, we can directly define <code class="language-plaintext highlighter-rouge">accept(visitor: SaveToCoreDataVisitor)</code> without declaring a Policy Protocol, which is also a good architectural approach.</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kd">protocol</span> <span class="kt">Saveable</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">accept</span><span class="p">(</span><span class="nv">visitor</span><span class="p">:</span> <span class="kt">SaveToCoreDataVisitor</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">SaveToCoreDataVisitor</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">UserModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// map UserModel to coredata</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">SongModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// map SongModel to coredata</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">visit</span><span class="p">(</span><span class="nv">model</span><span class="p">:</span> <span class="kt">PlaylistModel</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// map PlaylistModel to coredata</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Other applications: Save, Like, tableview/collectionview cellforrow…</p><h3 id="principles"><span class="me-2">Principles</span><a href="#principles" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Finally, let’s talk about some common principles:</p><ul><li>Code is for humans to read, so avoid over-designing.<li>Consistency is crucial. The same context in the same codebase should use the same architectural approach.<li>If the scope is controllable or no other situations are likely to occur, continuing to break it down further can be considered over-designing.<li>Use existing solutions more and invent less. Design patterns have been around in software design for decades, and they consider scenarios more comprehensively than creating a new architecture.<li>If you can’t understand a design pattern, you can learn it. However, if it’s a self-created architecture, it’s harder to convince others to learn because it may only be applicable to that specific case and not a common practice.<li>Code duplication doesn’t always mean it’s bad. Pursuing encapsulation blindly can lead to over-designing. Again, referring back to the previous points, code readability, low coupling, and high cohesion are indicators of good code.<li>Don’t tamper with patterns. There is a reason behind their design, and random modifications may cause issues in certain scenarios.<li>Once you start taking detours, you’ll only go further astray, and the code will get messier.</ul><blockquote><p><em>inspired by <a href="https://twitter.com/saiday">＠saiday</a></em></p></blockquote><h4 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://shirazian.wordpress.com/2016/04/22/design-patterns-in-swift-visitor/">Design Patterns in Swift: Visitor</a> (Another scenario using Visitor)<li><a href="https://github.com/kingreza/Swift-Visitor">https://github.com/kingreza/Swift-Visitor</a><li><a href="https://medium.com/@albertodebo/deep-linking-at-scale-on-ios-1dd8789c389f">Deep Linking at Scale on iOS</a> (State Pattern)</ul><h3 id="further-reading"><span class="me-2">Further Reading</span><a href="#further-reading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Practical Application Records of Design Patterns — In WKWebView with Builder, Strategy &amp; Chain of Responsibility Pattern<li><a href="../78507a8de6a5/">Practical Application Records of Design Patterns</a><li><a href="../60473cb47550/">Visitor Pattern in TableView</a></ul><p>Feel free to <a href="https://www.zhgchg.li/contact" target="_blank">contact me</a> for any questions or feedback.</p><p>===</p><p><a href="https://zhgchg.li/posts/ba5773a7bfea/" target="_blank">本文中文版本</a></p><p>===</p><p>This article was first published in Traditional Chinese on Medium ➡️ <a href="https://medium.com/p/ba5773a7bfea" target="_blank"><strong>View Here</strong></a></p><widgetic id="64ce71d5ecb2a165598b4567" resize="fill" width="560" height="60" autoscale="on" adaptive="414"></widgetic><script async src="https://widgetic.com/sdk/sdk.js"></script></div><hr/> <a href="https://www.buymeacoffee.com/zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="https://img.buymeacoffee.com/button-api/?text=Buy me a beer!&emoji=🍺&slug=zhgchgli&button_colour=FFDD00&font_colour=000000&font_family=Bree&outline_colour=000000&coffee_colour=ffffff" class="lazyload" data-proofer-ignore></a> <br/> <a href="https://medium.com/@zhgchgli" target="_blank" class="img-link shimmer" ><img data-src="/assets/images/followmymedium.png" class="lazyload" data-proofer-ignore></a> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3184248473087645" crossorigin="anonymous"></script> <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-3184248473087645" data-ad-slot="7555148040"></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/zrealm/'>ZRealm</a>, <a href='/categories/dev/'>Dev.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ios-app-development/" class="post-tag no-text-decoration" >ios-app-development</a> <a href="/tags/swift/" class="post-tag no-text-decoration" >swift</a> <a href="/tags/design-patterns/" class="post-tag no-text-decoration" >design-patterns</a> <a href="/tags/visitor-pattern/" class="post-tag no-text-decoration" >visitor-pattern</a> <a href="/tags/double-dispatch/" class="post-tag no-text-decoration" >double-dispatch</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Visitor%20Pattern%20in%20iOS%20(Swift)%20-%20ZhgChgLi&url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fba5773a7bfea%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Visitor%20Pattern%20in%20iOS%20(Swift)%20-%20ZhgChgLi&u=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fba5773a7bfea%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fen.zhgchg.li%2Fposts%2Fba5773a7bfea%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/d9a95d4224ea/">Medium Custom Domain Feature Returns</a><li class="text-truncate lh-lg"> <a href="/posts/483af5d93297/">Custom Domain Tutorial for Github Pages</a><li class="text-truncate lh-lg"> <a href="/posts/9e43897d99fc/">Behavior Change in Merging NSAttributedString Attributes Range in iOS ≥ 18</a><li class="text-truncate lh-lg"> <a href="/posts/b08ef940c196/">iOS Deferred Deep Link Implementation (Swift)</a><li class="text-truncate lh-lg"> <a href="/posts/12c5026da33d/">What's New with Universal Links</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/60473cb47550/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1657267110" data-df="ll" > Jul 8, 2022 </em><h4 class="pt-0 my-2" data-toc-skip>Visitor Pattern in TableView</h4><div class="text-muted small"><p> Visitor Pattern in TableView Enhancing the readability and extensibility of TableView using the Visitor Pattern Photo by Alex wong Introduction Following the previous article on “Visitor Patt...</p></div></div></a></div><div class="col"> <a href="/posts/e37d66ea1146/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1539454069" data-df="ll" > Oct 14, 2018 </em><h4 class="pt-0 my-2" data-toc-skip>iOS UITextView Text Wrapping Editor (Swift)</h4><div class="text-muted small"><p> iOS UITextView Text Wrapping Editor (Swift) Practical Route Target Functionality: The app has a discussion area where users can post articles. The interface for posting articles needs to support...</p></div></div></a></div><div class="col"> <a href="/posts/cb6eba52a342/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1539618241" data-df="ll" > Oct 15, 2018 </em><h4 class="pt-0 my-2" data-toc-skip>iOS ≥ 10 Notification Service Extension Application (Swift)</h4><div class="text-muted small"><p> iOS ≥ 10 Notification Service Extension Application (Swift) Image push notifications, push notification display statistics, pre-processing before push notification display Regarding the basics of...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/d61062833c1a/" class="btn btn-outline-primary" prompt="Older" ><p>Building a Fully Automated WFH Employee Health Reporting System with Slack</p></a> <a href="/posts/1c9eafd4a190/" class="btn btn-outline-primary" prompt="Newer" ><p>Leading Snowflakes Reading Notes</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'ZhgChgLi/zhgchgli.github.io', 'data-repo-id': 'R_kgDOHdowLw', 'data-category': 'Q&A', 'data-category-id': 'DIC_kwDOHdowL84CU-q6', 'data-mapping': 'url', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ios-app-development/">ios-app-development</a> <a class="post-tag btn btn-outline-primary" href="/tags/ios/">ios</a> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">life</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a> <a class="post-tag btn btn-outline-primary" href="/tags/unboxing/">unboxing</a> <a class="post-tag btn btn-outline-primary" href="/tags/life/">Life</a> <a class="post-tag btn btn-outline-primary" href="/tags/japan/">japan</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/nsattributedstring/">nsattributedstring</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> <br/> <a href="https://zhgchg.li" target="_blank">中文版網站</a><br/> Powered by <a href="https://github.com/ZhgChgLi/ZMediumToMarkdown" target="_blank">ZMediumToMarkdown</a>.</p><p>© 2024 <a href="https://medium.com/@zhgchgli">ZhgChgLi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >All rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-JSGN97L56L"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-JSGN97L56L'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
